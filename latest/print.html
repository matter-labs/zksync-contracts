<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>ZKSync Contracts</title>
        <meta name="robots" content="noindex">


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="book.css">

        <!-- MathJax -->
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="toc.js"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">ZKSync Contracts</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/matter-labs/zksync-contracts" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <div align="center">
<h1>
  <picture>
    <source srcset=".github/assets/elastic_white.svg" media="(prefers-color-scheme: dark)" />
    <img src=".github/assets/elastic_black.svg" alt="ZKsync" width="28" style="vertical-align: middle;">
  </picture>
  ZKsync Contracts
</h1>
<p><em>Canonical L1 &amp; L2 contract interfaces for the ZKsync Elastic Network</em></p>
<p><a href="https://www.npmjs.com/package/@matterlabs/zksync-contracts"><img src="https://img.shields.io/npm/v/@matterlabs/zksync-contracts" alt="NPM" /></a>
<a href="LICENSE-MIT"><img src="https://img.shields.io/badge/License-MIT-green.svg" alt="License: MIT" /></a>
<a href="https://docs.zksync.io"><img src="https://img.shields.io/badge/docs-reference-blue" alt="Docs" /></a>
<a href="https://x.com/zksyncdevs"><img src="https://img.shields.io/badge/follow-@zksyncdevs-1DA1F2?logo=x" alt="X: @zksyncdevs" /></a></p>
</div>
<blockquote>
<p><strong>Snapshot notice</strong><br />
These contracts target <strong>protocol version 29</strong>, commit <a href="https://github.com/matter-labs/era-contracts/commit/65234ab0617c677d8a3d266af9e95506db351280"><code>65234ab0</code></a>.</p>
</blockquote>
<blockquote>
<p>[!NOTE]
üõ†Ô∏è This is a <strong>development repository</strong> for <em>interfaces only</em>.
If you're looking for <strong>contract implementations</strong>, see
üëâ <a href="https://github.com/matter-labs/era-contracts/tree/draft-v29">matter-labs/era-contracts</a></p>
</blockquote>
<hr />
<h2 id="-installation"><a class="header" href="#-installation">üì¶ Installation</a></h2>
<p>To install with <a href="https://github.com/matter-labs/foundry-zksync"><strong>Foundry-ZKsync</strong></a>:</p>
<pre><code class="language-bash">forge install matter-labs/zksync-contracts
</code></pre>
<p>Add the following to the <code>remappings.txt</code> file of your project:</p>
<pre><code class="language-txt">@matterlabs/zksync-contracts/=lib/v2-testnet-contracts/
</code></pre>
<p>To install with <a href="https://github.com/matter-labs/hardhat-zksync"><strong>Hardhat</strong></a>:</p>
<pre><code class="language-bash">bun install @matterlabs/zksync-contracts
</code></pre>
<h2 id="-quick-start"><a class="header" href="#-quick-start">üöÄ Quick start</a></h2>
<pre><code class="language-solidity">// SPDX-License-Identifier: MIT
pragma solidity ^0.8.20;

import {IPaymaster} from
    "@matterlabs/zksync-contracts/contracts/system-contracts/interfaces/IPaymaster.sol";

contract MyPaymaster is IPaymaster {
    // Your implementation here
}
</code></pre>
<p>See more examples in the <a href="https://docs.zksync.io">official docs</a>.</p>
<h2 id="-documentation"><a class="header" href="#-documentation">üìñ Documentation</a></h2>
<ul>
<li><strong>API reference:</strong> <a href="https://docs.zksync.io">https://docs.zksync.io</a></li>
<li><strong>Canonical source:</strong> <a href="https://github.com/matter-labs/era-contracts">matter-labs/era-contracts</a></li>
</ul>
<h2 id="-contributing"><a class="header" href="#-contributing">ü§ù Contributing</a></h2>
<p>Bug fixes, new snapshots, and added ABIs are welcome!
Open an issue before large changes and follow the standard PR workflow.</p>
<h2 id="-license"><a class="header" href="#-license">üìú License</a></h2>
<p>Dual-licensed under <strong>MIT</strong> / <strong>Apache-2.0</strong>.
See <a href="LICENSE-MIT">LICENSE-MIT</a> and <a href="LICENSE-APACHE">LICENSE-APACHE</a>.</p>
<div align="center">
<p><a href="https://zksync.io">Website</a> ‚Ä¢
<a href="https://github.com/matter-labs">GitHub</a> ‚Ä¢
<a href="https://x.com/zksync">X</a> ‚Ä¢
<a href="https://x.com/zksyncdevs">X for Devs</a> ‚Ä¢
<a href="https://join.zksync.dev">Discord</a> ‚Ä¢
<a href="https://zksync.mirror.xyz">Mirror</a></p>
</div>
<div style="break-before: page; page-break-before: always;"></div><h1 id="installation"><a class="header" href="#installation">Installation</a></h1>
<p>To install with <a href="https://github.com/matter-labs/foundry-zksync"><strong>Foundry-ZKsync</strong></a>:</p>
<pre><code class="language-bash">forge install matter-labs/zksync-contracts
</code></pre>
<p>Add the following to the <code>remappings.txt</code> file of your project:</p>
<pre><code class="language-txt">@matterlabs/zksync-contracts/=lib/v2-testnet-contracts/
</code></pre>
<p>To install with <a href="https://github.com/matter-labs/hardhat-zksync"><strong>Hardhat</strong></a>:</p>
<pre><code class="language-bash">bun install @matterlabs/zksync-contracts
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="getting-started"><a class="header" href="#getting-started">Getting Started</a></h1>
<ol>
<li>
<p><strong>Add the package</strong></p>
<pre><code class="language-bash"># Hardhat / npm / bun
npm add @matterlabs/zksync-contracts
# or Foundry
forge install matter-labs/zksync-contracts
</code></pre>
</li>
<li>
<p><strong>Implement a contract</strong></p>
<pre><code class="language-solidity">// SPDX-License-Identifier: MIT
pragma solidity ^0.8.28;

import {IPaymaster} from
    "@matterlabs/zksync-contracts/contracts/system-contracts/interfaces/IPaymaster.sol";

contract MyPaymaster is IPaymaster {
    // implement paymaster logic here
}
</code></pre>
</li>
<li>
<p><strong>Build &amp; test</strong></p>
<ul>
<li>Hardhat  <code>npx hardhat compile</code></li>
<li>Foundry   <code>forge build</code></li>
</ul>
</li>
</ol>
<div style="break-before: page; page-break-before: always;"></div><h1 id="contents"><a class="header" href="#contents">Contents</a></h1>
<ul>
<li><a href="contracts/l1-contracts//contracts/l1-contracts/bridge">bridge</a></li>
<li><a href="contracts/l1-contracts//contracts/l1-contracts/bridgehub">bridgehub</a></li>
<li><a href="contracts/l1-contracts//contracts/l1-contracts/common">common</a></li>
<li><a href="contracts/l1-contracts//contracts/l1-contracts/governance">governance</a></li>
<li><a href="contracts/l1-contracts//contracts/l1-contracts/state-transition">state-transition</a></li>
<li><a href="contracts/l1-contracts//contracts/l1-contracts/upgrades">upgrades</a></li>
<li><a href="contracts/l1-contracts//contracts/l1-contracts/vendor">vendor</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="contents-1"><a class="header" href="#contents-1">Contents</a></h1>
<ul>
<li><a href="contracts/l1-contracts/bridge//contracts/l1-contracts/bridge/asset-router">asset-router</a></li>
<li><a href="contracts/l1-contracts/bridge//contracts/l1-contracts/bridge/interfaces">interfaces</a></li>
<li><a href="contracts/l1-contracts/bridge//contracts/l1-contracts/bridge/ntv">ntv</a></li>
<li><a href="contracts/l1-contracts/bridge/L1BridgeContractErrors.sol/error.EthTransferFailed.html">EthTransferFailed</a></li>
<li><a href="contracts/l1-contracts/bridge/L1BridgeContractErrors.sol/error.NativeTokenVaultAlreadySet.html">NativeTokenVaultAlreadySet</a></li>
<li><a href="contracts/l1-contracts/bridge/L1BridgeContractErrors.sol/error.WrongMsgLength.html">WrongMsgLength</a></li>
<li><a href="contracts/l1-contracts/bridge/L1BridgeContractErrors.sol/error.ZeroAmountToTransfer.html">ZeroAmountToTransfer</a></li>
<li><a href="contracts/l1-contracts/bridge/L1BridgeContractErrors.sol/error.WrongAmountTransferred.html">WrongAmountTransferred</a></li>
<li><a href="contracts/l1-contracts/bridge/L1BridgeContractErrors.sol/error.EmptyToken.html">EmptyToken</a></li>
<li><a href="contracts/l1-contracts/bridge/L1BridgeContractErrors.sol/error.ClaimFailedDepositFailed.html">ClaimFailedDepositFailed</a></li>
<li><a href="contracts/l1-contracts/bridge/L1BridgeContractErrors.sol/error.WrongL2Sender.html">WrongL2Sender</a></li>
<li><a href="contracts/l1-contracts/bridge/L1BridgeContractErrors.sol/error.WrongCounterpart.html">WrongCounterpart</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="contents-2"><a class="header" href="#contents-2">Contents</a></h1>
<ul>
<li><a href="contracts/l1-contracts/bridge/asset-router/IAssetRouterBase.sol/interface.IAssetRouterBase.html">IAssetRouterBase</a></li>
<li><a href="contracts/l1-contracts/bridge/asset-router/IAssetRouterBase.sol/constants.IAssetRouterBase.html">IAssetRouterBase constants</a></li>
<li><a href="contracts/l1-contracts/bridge/asset-router/IL1AssetRouter.sol/interface.IL1AssetRouter.html">IL1AssetRouter</a></li>
<li><a href="contracts/l1-contracts/bridge/asset-router/IL2AssetRouter.sol/interface.IL2AssetRouter.html">IL2AssetRouter</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="iassetrouterbase"><a class="header" href="#iassetrouterbase">IAssetRouterBase</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/l1-contracts/bridge/asset-router/IAssetRouterBase.sol">Git Source</a></p>
<p><strong>Title:</strong>
L1 Bridge contract interface</p>
<p><strong>Author:</strong>
Matter Labs</p>
<p><strong>Note:</strong>
security-contact: security@matterlabs.dev</p>
<h2 id="functions"><a class="header" href="#functions">Functions</a></h2>
<h3 id="bridge_hub"><a class="header" href="#bridge_hub">BRIDGE_HUB</a></h3>
<pre><code class="language-solidity">function BRIDGE_HUB() external view returns (IBridgehub);
</code></pre>
<h3 id="setassethandleraddressthischain"><a class="header" href="#setassethandleraddressthischain">setAssetHandlerAddressThisChain</a></h3>
<p>Sets the asset handler address for a specified asset ID on the chain of the asset deployment tracker.</p>
<p>The caller of this function is encoded within the <code>assetId</code>, therefore, it should be invoked by the asset deployment tracker contract.</p>
<p>No access control on the caller, as msg.sender is encoded in the assetId.</p>
<p>Typically, for most tokens, ADT is the native token vault. However, custom tokens may have their own specific asset deployment trackers.</p>
<p><code>setAssetHandlerAddressOnCounterpart</code> should be called on L1 to set asset handlers on L2 chains for a specific asset ID.</p>
<pre><code class="language-solidity">function setAssetHandlerAddressThisChain(
  bytes32 _assetRegistrationData,
  address _assetHandlerAddress
) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_assetRegistrationData</code></td><td><code>bytes32</code></td><td>The asset data which may include the asset address and any additional required data or encodings.</td></tr>
<tr><td><code>_assetHandlerAddress</code></td><td><code>address</code></td><td>The address of the asset handler to be set for the provided asset.</td></tr>
</tbody></table>
</div>
<h3 id="assethandleraddress"><a class="header" href="#assethandleraddress">assetHandlerAddress</a></h3>
<pre><code class="language-solidity">function assetHandlerAddress(bytes32 _assetId) external view returns (address);
</code></pre>
<h3 id="finalizedeposit"><a class="header" href="#finalizedeposit">finalizeDeposit</a></h3>
<p>Finalize the withdrawal and release funds.</p>
<p>We have both the legacy finalizeWithdrawal and the new finalizeDeposit functions,
finalizeDeposit uses the new format. On the L2 we have finalizeDeposit with new and old formats both.</p>
<pre><code class="language-solidity">function finalizeDeposit(
  uint256 _chainId,
  bytes32 _assetId,
  bytes memory _transferData
) external payable;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_chainId</code></td><td><code>uint256</code></td><td>The chain ID of the transaction to check.</td></tr>
<tr><td><code>_assetId</code></td><td><code>bytes32</code></td><td>The bridged asset ID.</td></tr>
<tr><td><code>_transferData</code></td><td><code>bytes</code></td><td>The position in the L2 logs Merkle tree of the l2Log that was sent with the message.</td></tr>
</tbody></table>
</div>
<h2 id="events"><a class="header" href="#events">Events</a></h2>
<h3 id="bridgehubdepositbasetokeninitiated"><a class="header" href="#bridgehubdepositbasetokeninitiated">BridgehubDepositBaseTokenInitiated</a></h3>
<pre><code class="language-solidity">event BridgehubDepositBaseTokenInitiated(
  uint256 indexed chainId,
  address indexed from,
  bytes32 assetId,
  uint256 amount
);
</code></pre>
<h3 id="bridgehubdepositinitiated"><a class="header" href="#bridgehubdepositinitiated">BridgehubDepositInitiated</a></h3>
<pre><code class="language-solidity">event BridgehubDepositInitiated(
  uint256 indexed chainId,
  bytes32 indexed txDataHash,
  address indexed from,
  bytes32 assetId,
  bytes bridgeMintCalldata
);
</code></pre>
<h3 id="bridgehubwithdrawalinitiated"><a class="header" href="#bridgehubwithdrawalinitiated">BridgehubWithdrawalInitiated</a></h3>
<pre><code class="language-solidity">event BridgehubWithdrawalInitiated( // Todo: What's the point of emitting hash?
  uint256 chainId,
  address indexed sender,
  bytes32 indexed assetId,
  bytes32 assetDataHash
);
</code></pre>
<h3 id="assetdeploymenttrackerregistered"><a class="header" href="#assetdeploymenttrackerregistered">AssetDeploymentTrackerRegistered</a></h3>
<pre><code class="language-solidity">event AssetDeploymentTrackerRegistered(
  bytes32 indexed assetId,
  bytes32 indexed additionalData,
  address assetDeploymentTracker
);
</code></pre>
<h3 id="assethandlerregistered"><a class="header" href="#assethandlerregistered">AssetHandlerRegistered</a></h3>
<pre><code class="language-solidity">event AssetHandlerRegistered(
  bytes32 indexed assetId, address indexed _assetHandlerAddress
);
</code></pre>
<h3 id="depositfinalizedassetrouter"><a class="header" href="#depositfinalizedassetrouter">DepositFinalizedAssetRouter</a></h3>
<pre><code class="language-solidity">event DepositFinalizedAssetRouter(
  uint256 indexed chainId, bytes32 indexed assetId, bytes assetData
);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="constants"><a class="header" href="#constants">Constants</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/l1-contracts/bridge/asset-router/IAssetRouterBase.sol">Git Source</a></p>
<h3 id="legacy_encoding_version"><a class="header" href="#legacy_encoding_version">LEGACY_ENCODING_VERSION</a></h3>
<p>The encoding version used for legacy txs.</p>
<pre><code class="language-solidity">bytes1 constant LEGACY_ENCODING_VERSION = 0x00
</code></pre>
<h3 id="new_encoding_version"><a class="header" href="#new_encoding_version">NEW_ENCODING_VERSION</a></h3>
<p>The encoding version used for new txs.</p>
<pre><code class="language-solidity">bytes1 constant NEW_ENCODING_VERSION = 0x01
</code></pre>
<h3 id="set_asset_handler_counterpart_encoding_version"><a class="header" href="#set_asset_handler_counterpart_encoding_version">SET_ASSET_HANDLER_COUNTERPART_ENCODING_VERSION</a></h3>
<p>The encoding version used for txs that set the asset handler on the counterpart contract.</p>
<pre><code class="language-solidity">bytes1 constant SET_ASSET_HANDLER_COUNTERPART_ENCODING_VERSION = 0x02
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="il1assetrouter"><a class="header" href="#il1assetrouter">IL1AssetRouter</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/l1-contracts/bridge/asset-router/IL1AssetRouter.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
<a href="contracts/l1-contracts/bridge/asset-router/IL1AssetRouter.sol//contracts/l1-contracts/bridge/asset-router/IAssetRouterBase.sol/interface.IAssetRouterBase.html">IAssetRouterBase</a>, <a href="contracts/l1-contracts/bridge/asset-router/IL1AssetRouter.sol//contracts/l1-contracts/bridge/interfaces/IL1SharedBridgeLegacy.sol/interface.IL1SharedBridgeLegacy.html">IL1SharedBridgeLegacy</a></p>
<p><strong>Title:</strong>
L1 Bridge contract interface</p>
<p><strong>Author:</strong>
Matter Labs</p>
<p><strong>Note:</strong>
security-contact: security@matterlabs.dev</p>
<h2 id="functions-1"><a class="header" href="#functions-1">Functions</a></h2>
<h3 id="depositlegacyerc20bridge"><a class="header" href="#depositlegacyerc20bridge">depositLegacyErc20Bridge</a></h3>
<p>Initiates a deposit by locking funds on the contract and sending the request
of processing an L2 transaction where tokens would be minted.</p>
<p>If the token is bridged for the first time, the L2 token contract will be deployed. Note however, that the
newly-deployed token does not support any custom logic, i.e. rebase tokens' functionality is not supported.</p>
<p>If the L2 deposit finalization transaction fails, the <code>_refundRecipient</code> will receive the <code>_l2Value</code>.
Please note, the contract may change the refund recipient's address to eliminate sending funds to addresses
out of control.</p>
<ul>
<li>If <code>_refundRecipient</code> is a contract on L1, the refund will be sent to the aliased <code>_refundRecipient</code>.</li>
<li>If <code>_refundRecipient</code> is set to <code>address(0)</code> and the sender has NO deployed bytecode on L1, the refund will
be sent to the <code>msg.sender</code> address.</li>
<li>If <code>_refundRecipient</code> is set to <code>address(0)</code> and the sender has deployed bytecode on L1, the refund will be
sent to the aliased <code>msg.sender</code> address.</li>
</ul>
<p>The address aliasing of L1 contracts as refund recipient on L2 is necessary to guarantee that the funds
are controllable through the Mailbox, since the Mailbox applies address aliasing to the from address for the
L2 tx if the L1 msg.sender is a contract. Without address aliasing for L1 contracts as refund recipients they
would not be able to make proper L2 tx requests through the Mailbox to use or withdraw the funds from L2, and
the funds would be lost.</p>
<pre><code class="language-solidity">function depositLegacyErc20Bridge(
  address _originalCaller,
  address _l2Receiver,
  address _l1Token,
  uint256 _amount,
  uint256 _l2TxGasLimit,
  uint256 _l2TxGasPerPubdataByte,
  address _refundRecipient
) external payable returns (bytes32 txHash);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_originalCaller</code></td><td><code>address</code></td><td>The <code>msg.sender</code> address from the external call that initiated current one.</td></tr>
<tr><td><code>_l2Receiver</code></td><td><code>address</code></td><td>The account address that should receive funds on L2.</td></tr>
<tr><td><code>_l1Token</code></td><td><code>address</code></td><td>The L1 token address which is deposited.</td></tr>
<tr><td><code>_amount</code></td><td><code>uint256</code></td><td>The total amount of tokens to be bridged.</td></tr>
<tr><td><code>_l2TxGasLimit</code></td><td><code>uint256</code></td><td>The L2 gas limit to be used in the corresponding L2 transaction.</td></tr>
<tr><td><code>_l2TxGasPerPubdataByte</code></td><td><code>uint256</code></td><td>The gasPerPubdataByteLimit to be used in the corresponding L2 transaction.</td></tr>
<tr><td><code>_refundRecipient</code></td><td><code>address</code></td><td>The address on L2 that will receive the refund for the transaction.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>txHash</code></td><td><code>bytes32</code></td><td>The L2 transaction hash of deposit finalization.</td></tr>
</tbody></table>
</div>
<h3 id="l1_nullifier"><a class="header" href="#l1_nullifier">L1_NULLIFIER</a></h3>
<pre><code class="language-solidity">function L1_NULLIFIER() external view returns (IL1Nullifier);
</code></pre>
<h3 id="l1_weth_token"><a class="header" href="#l1_weth_token">L1_WETH_TOKEN</a></h3>
<pre><code class="language-solidity">function L1_WETH_TOKEN() external view returns (address);
</code></pre>
<h3 id="eth_token_asset_id"><a class="header" href="#eth_token_asset_id">ETH_TOKEN_ASSET_ID</a></h3>
<pre><code class="language-solidity">function ETH_TOKEN_ASSET_ID() external view returns (bytes32);
</code></pre>
<h3 id="nativetokenvault"><a class="header" href="#nativetokenvault">nativeTokenVault</a></h3>
<pre><code class="language-solidity">function nativeTokenVault() external view returns (INativeTokenVault);
</code></pre>
<h3 id="setassetdeploymenttracker"><a class="header" href="#setassetdeploymenttracker">setAssetDeploymentTracker</a></h3>
<pre><code class="language-solidity">function setAssetDeploymentTracker(
  bytes32 _assetRegistrationData,
  address _assetDeploymentTracker
) external;
</code></pre>
<h3 id="setnativetokenvault"><a class="header" href="#setnativetokenvault">setNativeTokenVault</a></h3>
<pre><code class="language-solidity">function setNativeTokenVault(INativeTokenVault _nativeTokenVault) external;
</code></pre>
<h3 id="setl1erc20bridge"><a class="header" href="#setl1erc20bridge">setL1Erc20Bridge</a></h3>
<pre><code class="language-solidity">function setL1Erc20Bridge(IL1ERC20Bridge _legacyBridge) external;
</code></pre>
<h3 id="bridgerecoverfailedtransfer"><a class="header" href="#bridgerecoverfailedtransfer">bridgeRecoverFailedTransfer</a></h3>
<p>Withdraw funds from the initiated deposit, that failed when finalizing on L2.</p>
<p>Processes claims of failed deposit, whether they originated from the legacy bridge or the current system.</p>
<pre><code class="language-solidity">function bridgeRecoverFailedTransfer(
  uint256 _chainId,
  address _depositSender,
  bytes32 _assetId,
  bytes calldata _assetData
) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_chainId</code></td><td><code>uint256</code></td><td>The ZK chain id to which the deposit was initiated.</td></tr>
<tr><td><code>_depositSender</code></td><td><code>address</code></td><td>The address of the entity that initiated the deposit.</td></tr>
<tr><td><code>_assetId</code></td><td><code>bytes32</code></td><td>The unique identifier of the deposited L1 token.</td></tr>
<tr><td><code>_assetData</code></td><td><code>bytes</code></td><td>The encoded transfer data, which includes both the deposit amount and the address of the L2 receiver. Might include extra information.</td></tr>
</tbody></table>
</div>
<h3 id="bridgerecoverfailedtransfer-1"><a class="header" href="#bridgerecoverfailedtransfer-1">bridgeRecoverFailedTransfer</a></h3>
<p>Withdraw funds from the initiated deposit, that failed when finalizing on L2.</p>
<p>Processes claims of failed deposit, whether they originated from the legacy bridge or the current system.</p>
<pre><code class="language-solidity">function bridgeRecoverFailedTransfer(
  uint256 _chainId,
  address _depositSender,
  bytes32 _assetId,
  bytes memory _assetData,
  bytes32 _l2TxHash,
  uint256 _l2BatchNumber,
  uint256 _l2MessageIndex,
  uint16 _l2TxNumberInBatch,
  bytes32[] calldata _merkleProof
) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_chainId</code></td><td><code>uint256</code></td><td>The ZK chain id to which deposit was initiated.</td></tr>
<tr><td><code>_depositSender</code></td><td><code>address</code></td><td>The address of the entity that initiated the deposit.</td></tr>
<tr><td><code>_assetId</code></td><td><code>bytes32</code></td><td>The unique identifier of the deposited L1 token.</td></tr>
<tr><td><code>_assetData</code></td><td><code>bytes</code></td><td>The encoded transfer data, which includes both the deposit amount and the address of the L2 receiver. Might include extra information.</td></tr>
<tr><td><code>_l2TxHash</code></td><td><code>bytes32</code></td><td>The L2 transaction hash of the failed deposit finalization.</td></tr>
<tr><td><code>_l2BatchNumber</code></td><td><code>uint256</code></td><td>The L2 batch number where the deposit finalization was processed.</td></tr>
<tr><td><code>_l2MessageIndex</code></td><td><code>uint256</code></td><td>The position in the L2 logs Merkle tree of the l2Log that was sent with the message.</td></tr>
<tr><td><code>_l2TxNumberInBatch</code></td><td><code>uint16</code></td><td>The L2 transaction number in a batch, in which the log was sent.</td></tr>
<tr><td><code>_merkleProof</code></td><td><code>bytes32[]</code></td><td>The Merkle proof of the processing L1 -&gt; L2 transaction with deposit finalization.</td></tr>
</tbody></table>
</div>
<h3 id="transferfundstontv"><a class="header" href="#transferfundstontv">transferFundsToNTV</a></h3>
<p>Transfers funds to Native Token Vault, if the asset is registered with it. Does nothing for ETH or non-registered tokens.</p>
<p>assetId is not the padded address, but the correct encoded id (NTV stores respective format for IDs)</p>
<pre><code class="language-solidity">function transferFundsToNTV(
  bytes32 _assetId,
  uint256 _amount,
  address _originalCaller
) external returns (bool);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_assetId</code></td><td><code>bytes32</code></td><td></td></tr>
<tr><td><code>_amount</code></td><td><code>uint256</code></td><td>The asset amount to be transferred to native token vault.</td></tr>
<tr><td><code>_originalCaller</code></td><td><code>address</code></td><td>The <code>msg.sender</code> address from the external call that initiated current one.</td></tr>
</tbody></table>
</div>
<h3 id="finalizewithdrawal"><a class="header" href="#finalizewithdrawal">finalizeWithdrawal</a></h3>
<p>Finalize the withdrawal and release funds</p>
<pre><code class="language-solidity">function finalizeWithdrawal(
  uint256 _chainId,
  uint256 _l2BatchNumber,
  uint256 _l2MessageIndex,
  uint16 _l2TxNumberInBatch,
  bytes calldata _message,
  bytes32[] calldata _merkleProof
) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_chainId</code></td><td><code>uint256</code></td><td>The chain ID of the transaction to check</td></tr>
<tr><td><code>_l2BatchNumber</code></td><td><code>uint256</code></td><td>The L2 batch number where the withdrawal was processed</td></tr>
<tr><td><code>_l2MessageIndex</code></td><td><code>uint256</code></td><td>The position in the L2 logs Merkle tree of the l2Log that was sent with the message</td></tr>
<tr><td><code>_l2TxNumberInBatch</code></td><td><code>uint16</code></td><td>The L2 transaction number in the batch, in which the log was sent</td></tr>
<tr><td><code>_message</code></td><td><code>bytes</code></td><td>The L2 withdraw data, stored in an L2 -&gt; L1 message</td></tr>
<tr><td><code>_merkleProof</code></td><td><code>bytes32[]</code></td><td>The Merkle proof of the inclusion L2 -&gt; L1 message about withdrawal initialization</td></tr>
</tbody></table>
</div>
<h3 id="bridgehubdeposit"><a class="header" href="#bridgehubdeposit">bridgehubDeposit</a></h3>
<p>Initiates a transfer transaction within Bridgehub, used by <code>requestL2TransactionTwoBridges</code>.</p>
<p>Data has the following abi encoding for legacy deposits:
address _l1Token,
uint256 _amount,
address _l2Receiver
for new deposits:
bytes32 _assetId,
bytes _transferData</p>
<pre><code class="language-solidity">function bridgehubDeposit(
  uint256 _chainId,
  address _originalCaller,
  uint256 _value,
  bytes calldata _data
)
  external
  payable
  returns (L2TransactionRequestTwoBridgesInner memory request);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_chainId</code></td><td><code>uint256</code></td><td>The chain ID of the ZK chain to which deposit.</td></tr>
<tr><td><code>_originalCaller</code></td><td><code>address</code></td><td>The <code>msg.sender</code> address from the external call that initiated current one.</td></tr>
<tr><td><code>_value</code></td><td><code>uint256</code></td><td>The <code>msg.value</code> on the target chain tx.</td></tr>
<tr><td><code>_data</code></td><td><code>bytes</code></td><td>The calldata for the second bridge deposit.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>request</code></td><td><code>L2TransactionRequestTwoBridgesInner</code></td><td>The data used by the bridgehub to create L2 transaction request to specific ZK chain.</td></tr>
</tbody></table>
</div>
<h3 id="getdepositcalldata"><a class="header" href="#getdepositcalldata">getDepositCalldata</a></h3>
<p>Generates a calldata for calling the deposit finalization on the L2 native token contract.</p>
<pre><code class="language-solidity">function getDepositCalldata(
  address _sender,
  bytes32 _assetId,
  bytes memory _assetData
) external view returns (bytes memory);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_sender</code></td><td><code>address</code></td><td>The address of the deposit initiator.</td></tr>
<tr><td><code>_assetId</code></td><td><code>bytes32</code></td><td>The deposited asset ID.</td></tr>
<tr><td><code>_assetData</code></td><td><code>bytes</code></td><td>The encoded data, which is used by the asset handler to determine L2 recipient and amount. Might include extra information.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>bytes</code></td><td>Returns calldata used on ZK chain.</td></tr>
</tbody></table>
</div>
<h3 id="bridgehubdepositbasetoken"><a class="header" href="#bridgehubdepositbasetoken">bridgehubDepositBaseToken</a></h3>
<p>Allows bridgehub to acquire mintValue for L1-&gt;L2 transactions.</p>
<p>If the corresponding L2 transaction fails, refunds are issued to a refund recipient on L2.</p>
<pre><code class="language-solidity">function bridgehubDepositBaseToken(
  uint256 _chainId,
  bytes32 _assetId,
  address _originalCaller,
  uint256 _amount
) external payable;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_chainId</code></td><td><code>uint256</code></td><td>The chain ID of the ZK chain to which deposit.</td></tr>
<tr><td><code>_assetId</code></td><td><code>bytes32</code></td><td>The deposited asset ID.</td></tr>
<tr><td><code>_originalCaller</code></td><td><code>address</code></td><td>The <code>msg.sender</code> address from the external call that initiated current one.</td></tr>
<tr><td><code>_amount</code></td><td><code>uint256</code></td><td>The total amount of tokens to be bridged.</td></tr>
</tbody></table>
</div>
<h3 id="bridgehubconfirml2transaction"><a class="header" href="#bridgehubconfirml2transaction">bridgehubConfirmL2Transaction</a></h3>
<p>Routes the confirmation to nullifier for backward compatibility.</p>
<p>Confirms the acceptance of a transaction by the Mailbox, as part of the L2 transaction process within Bridgehub.
This function is utilized by <code>requestL2TransactionTwoBridges</code> to validate the execution of a transaction.</p>
<pre><code class="language-solidity">function bridgehubConfirmL2Transaction(
  uint256 _chainId,
  bytes32 _txDataHash,
  bytes32 _txHash
) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_chainId</code></td><td><code>uint256</code></td><td>The chain ID of the ZK chain to which confirm the deposit.</td></tr>
<tr><td><code>_txDataHash</code></td><td><code>bytes32</code></td><td>The keccak256 hash of 0x01</td></tr>
<tr><td><code>_txHash</code></td><td><code>bytes32</code></td><td>The hash of the L1-&gt;L2 transaction to confirm the deposit.</td></tr>
</tbody></table>
</div>
<h3 id="iswithdrawalfinalized"><a class="header" href="#iswithdrawalfinalized">isWithdrawalFinalized</a></h3>
<pre><code class="language-solidity">function isWithdrawalFinalized(
  uint256 _chainId,
  uint256 _l2BatchNumber,
  uint256 _l2MessageIndex
) external view returns (bool);
</code></pre>
<h2 id="events-1"><a class="header" href="#events-1">Events</a></h2>
<h3 id="bridgehubmintdata"><a class="header" href="#bridgehubmintdata">BridgehubMintData</a></h3>
<pre><code class="language-solidity">event BridgehubMintData(bytes bridgeMintData);
</code></pre>
<h3 id="bridgehubdepositfinalized"><a class="header" href="#bridgehubdepositfinalized">BridgehubDepositFinalized</a></h3>
<pre><code class="language-solidity">event BridgehubDepositFinalized(
  uint256 indexed chainId,
  bytes32 indexed txDataHash,
  bytes32 indexed l2DepositTxHash
);
</code></pre>
<h3 id="claimedfaileddepositassetrouter"><a class="header" href="#claimedfaileddepositassetrouter">ClaimedFailedDepositAssetRouter</a></h3>
<pre><code class="language-solidity">event ClaimedFailedDepositAssetRouter(
  uint256 indexed chainId, bytes32 indexed assetId, bytes assetData
);
</code></pre>
<h3 id="assetdeploymenttrackerset"><a class="header" href="#assetdeploymenttrackerset">AssetDeploymentTrackerSet</a></h3>
<pre><code class="language-solidity">event AssetDeploymentTrackerSet(
  bytes32 indexed assetId,
  address indexed assetDeploymentTracker,
  bytes32 indexed additionalData
);
</code></pre>
<h3 id="legacydepositinitiated"><a class="header" href="#legacydepositinitiated">LegacyDepositInitiated</a></h3>
<pre><code class="language-solidity">event LegacyDepositInitiated(
  uint256 indexed chainId,
  bytes32 indexed l2DepositTxHash,
  address indexed from,
  address to,
  address l1Token,
  uint256 amount
);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="il2assetrouter"><a class="header" href="#il2assetrouter">IL2AssetRouter</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/l1-contracts/bridge/asset-router/IL2AssetRouter.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
<a href="contracts/l1-contracts/bridge/asset-router/IL2AssetRouter.sol//contracts/l1-contracts/bridge/asset-router/IAssetRouterBase.sol/interface.IAssetRouterBase.html">IAssetRouterBase</a></p>
<p><strong>Author:</strong>
Matter Labs</p>
<p><strong>Note:</strong>
security-contact: security@matterlabs.dev</p>
<h2 id="functions-2"><a class="header" href="#functions-2">Functions</a></h2>
<h3 id="withdraw"><a class="header" href="#withdraw">withdraw</a></h3>
<pre><code class="language-solidity">function withdraw(bytes32 _assetId, bytes calldata _transferData)
  external
  returns (bytes32);
</code></pre>
<h3 id="l1_asset_router"><a class="header" href="#l1_asset_router">L1_ASSET_ROUTER</a></h3>
<pre><code class="language-solidity">function L1_ASSET_ROUTER() external view returns (address);
</code></pre>
<h3 id="withdrawlegacybridge"><a class="header" href="#withdrawlegacybridge">withdrawLegacyBridge</a></h3>
<pre><code class="language-solidity">function withdrawLegacyBridge(
  address _l1Receiver,
  address _l2Token,
  uint256 _amount,
  address _sender
) external;
</code></pre>
<h3 id="finalizedepositlegacybridge"><a class="header" href="#finalizedepositlegacybridge">finalizeDepositLegacyBridge</a></h3>
<pre><code class="language-solidity">function finalizeDepositLegacyBridge(
  address _l1Sender,
  address _l2Receiver,
  address _l1Token,
  uint256 _amount,
  bytes calldata _data
) external;
</code></pre>
<h3 id="setassethandleraddress"><a class="header" href="#setassethandleraddress">setAssetHandlerAddress</a></h3>
<p>Used to set the assetHandlerAddress for a given assetId.</p>
<p>Will be used by ZK Gateway</p>
<pre><code class="language-solidity">function setAssetHandlerAddress(
  uint256 _originChainId,
  bytes32 _assetId,
  address _assetHandlerAddress
) external;
</code></pre>
<h3 id="setlegacytokenassethandler"><a class="header" href="#setlegacytokenassethandler">setLegacyTokenAssetHandler</a></h3>
<p>Function that allows native token vault to register itself as the asset handler for
a legacy asset.</p>
<pre><code class="language-solidity">function setLegacyTokenAssetHandler(bytes32 _assetId) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_assetId</code></td><td><code>bytes32</code></td><td>The assetId of the legacy token.</td></tr>
</tbody></table>
</div>
<h2 id="events-2"><a class="header" href="#events-2">Events</a></h2>
<h3 id="withdrawalinitiatedassetrouter"><a class="header" href="#withdrawalinitiatedassetrouter">WithdrawalInitiatedAssetRouter</a></h3>
<pre><code class="language-solidity">event WithdrawalInitiatedAssetRouter(
  uint256 chainId,
  address indexed l2Sender,
  bytes32 indexed assetId,
  bytes assetData
);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="contents-3"><a class="header" href="#contents-3">Contents</a></h1>
<ul>
<li><a href="contracts/l1-contracts/bridge/interfaces/AssetHandlerModifiers.sol/abstract.AssetHandlerModifiers.html">AssetHandlerModifiers</a></li>
<li><a href="contracts/l1-contracts/bridge/interfaces/IAssetHandler.sol/interface.IAssetHandler.html">IAssetHandler</a></li>
<li><a href="contracts/l1-contracts/bridge/interfaces/IBridgedStandardToken.sol/interface.IBridgedStandardToken.html">IBridgedStandardToken</a></li>
<li><a href="contracts/l1-contracts/bridge/interfaces/IL1AssetDeploymentTracker.sol/interface.IL1AssetDeploymentTracker.html">IL1AssetDeploymentTracker</a></li>
<li><a href="contracts/l1-contracts/bridge/interfaces/IL1AssetHandler.sol/interface.IL1AssetHandler.html">IL1AssetHandler</a></li>
<li><a href="contracts/l1-contracts/bridge/interfaces/IL1BaseTokenAssetHandler.sol/interface.IL1BaseTokenAssetHandler.html">IL1BaseTokenAssetHandler</a></li>
<li><a href="contracts/l1-contracts/bridge/interfaces/IL1ERC20Bridge.sol/interface.IL1ERC20Bridge.html">IL1ERC20Bridge</a></li>
<li><a href="contracts/l1-contracts/bridge/interfaces/IL1Nullifier.sol/struct.FinalizeL1DepositParams.html">FinalizeL1DepositParams</a></li>
<li><a href="contracts/l1-contracts/bridge/interfaces/IL1Nullifier.sol/interface.IL1Nullifier.html">IL1Nullifier</a></li>
<li><a href="contracts/l1-contracts/bridge/interfaces/IL1SharedBridgeLegacy.sol/interface.IL1SharedBridgeLegacy.html">IL1SharedBridgeLegacy</a></li>
<li><a href="contracts/l1-contracts/bridge/interfaces/IL2SharedBridgeLegacy.sol/interface.IL2SharedBridgeLegacy.html">IL2SharedBridgeLegacy</a></li>
<li><a href="contracts/l1-contracts/bridge/interfaces/IL2SharedBridgeLegacyFunctions.sol/interface.IL2SharedBridgeLegacyFunctions.html">IL2SharedBridgeLegacyFunctions</a></li>
<li><a href="contracts/l1-contracts/bridge/interfaces/IL2WrappedBaseToken.sol/interface.IL2WrappedBaseToken.html">IL2WrappedBaseToken</a></li>
<li><a href="contracts/l1-contracts/bridge/interfaces/IWETH9.sol/interface.IWETH9.html">IWETH9</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="iassethandler"><a class="header" href="#iassethandler">IAssetHandler</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/l1-contracts/bridge/interfaces/IAssetHandler.sol">Git Source</a></p>
<p><strong>Title:</strong>
Asset Handler contract interface</p>
<p><strong>Author:</strong>
Matter Labs</p>
<p>Used for any asset handler and called by the AssetRouter</p>
<p><strong>Note:</strong>
security-contact: security@matterlabs.dev</p>
<h2 id="functions-3"><a class="header" href="#functions-3">Functions</a></h2>
<h3 id="bridgemint"><a class="header" href="#bridgemint">bridgeMint</a></h3>
<p>Note, that while payable, this function will only receive base token on L2 chains,
while L1 the provided msg.value is always 0. However, this may change in the future,
so if your AssetHandler implementation relies on it, it is better to explicitly check it.</p>
<pre><code class="language-solidity">function bridgeMint(uint256 _chainId, bytes32 _assetId, bytes calldata _data)
  external
  payable;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_chainId</code></td><td><code>uint256</code></td><td>the chainId that the message is from</td></tr>
<tr><td><code>_assetId</code></td><td><code>bytes32</code></td><td>the assetId of the asset being bridged</td></tr>
<tr><td><code>_data</code></td><td><code>bytes</code></td><td>the actual data specified for the function</td></tr>
</tbody></table>
</div>
<h3 id="bridgeburn"><a class="header" href="#bridgeburn">bridgeBurn</a></h3>
<p>Burns bridged tokens and returns the calldata for L2 &lt;-&gt; L1 message.</p>
<p>In case of native token vault _data is the tuple of _depositAmount and _l2Receiver.</p>
<pre><code class="language-solidity">function bridgeBurn(
  uint256 _chainId,
  uint256 _msgValue,
  bytes32 _assetId,
  address _originalCaller,
  bytes calldata _data
) external payable returns (bytes memory _bridgeMintData);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_chainId</code></td><td><code>uint256</code></td><td>the chainId that the message will be sent to</td></tr>
<tr><td><code>_msgValue</code></td><td><code>uint256</code></td><td>the msg.value of the L2 transaction. For now it is always 0.</td></tr>
<tr><td><code>_assetId</code></td><td><code>bytes32</code></td><td>the assetId of the asset being bridged</td></tr>
<tr><td><code>_originalCaller</code></td><td><code>address</code></td><td>the original caller of the</td></tr>
<tr><td><code>_data</code></td><td><code>bytes</code></td><td>the actual data specified for the function</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_bridgeMintData</code></td><td><code>bytes</code></td><td>The calldata used by counterpart asset handler to unlock tokens for recipient.</td></tr>
</tbody></table>
</div>
<h2 id="events-3"><a class="header" href="#events-3">Events</a></h2>
<h3 id="bridgemint-1"><a class="header" href="#bridgemint-1">BridgeMint</a></h3>
<p>Emitted when a token is minted</p>
<pre><code class="language-solidity">event BridgeMint(
  uint256 indexed chainId,
  bytes32 indexed assetId,
  address receiver,
  uint256 amount
);
</code></pre>
<h3 id="bridgeburn-1"><a class="header" href="#bridgeburn-1">BridgeBurn</a></h3>
<p>Emitted when a token is burned</p>
<pre><code class="language-solidity">event BridgeBurn(
  uint256 indexed chainId,
  bytes32 indexed assetId,
  address indexed sender,
  address receiver,
  uint256 amount
);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="ibridgedstandardtoken"><a class="header" href="#ibridgedstandardtoken">IBridgedStandardToken</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/l1-contracts/bridge/interfaces/IBridgedStandardToken.sol">Git Source</a></p>
<h2 id="functions-4"><a class="header" href="#functions-4">Functions</a></h2>
<h3 id="bridgemint-2"><a class="header" href="#bridgemint-2">bridgeMint</a></h3>
<pre><code class="language-solidity">function bridgeMint(address _account, uint256 _amount) external;
</code></pre>
<h3 id="bridgeburn-2"><a class="header" href="#bridgeburn-2">bridgeBurn</a></h3>
<pre><code class="language-solidity">function bridgeBurn(address _account, uint256 _amount) external;
</code></pre>
<h3 id="l1address"><a class="header" href="#l1address">l1Address</a></h3>
<pre><code class="language-solidity">function l1Address() external view returns (address);
</code></pre>
<h3 id="origintoken"><a class="header" href="#origintoken">originToken</a></h3>
<pre><code class="language-solidity">function originToken() external view returns (address);
</code></pre>
<h3 id="l2bridge"><a class="header" href="#l2bridge">l2Bridge</a></h3>
<pre><code class="language-solidity">function l2Bridge() external view returns (address);
</code></pre>
<h3 id="assetid"><a class="header" href="#assetid">assetId</a></h3>
<pre><code class="language-solidity">function assetId() external view returns (bytes32);
</code></pre>
<h3 id="nativetokenvault-1"><a class="header" href="#nativetokenvault-1">nativeTokenVault</a></h3>
<pre><code class="language-solidity">function nativeTokenVault() external view returns (address);
</code></pre>
<h2 id="events-4"><a class="header" href="#events-4">Events</a></h2>
<h3 id="bridgeinitialize"><a class="header" href="#bridgeinitialize">BridgeInitialize</a></h3>
<pre><code class="language-solidity">event BridgeInitialize(
  address indexed l1Token, string name, string symbol, uint8 decimals
);
</code></pre>
<h3 id="bridgemint-3"><a class="header" href="#bridgemint-3">BridgeMint</a></h3>
<pre><code class="language-solidity">event BridgeMint(address indexed account, uint256 amount);
</code></pre>
<h3 id="bridgeburn-3"><a class="header" href="#bridgeburn-3">BridgeBurn</a></h3>
<pre><code class="language-solidity">event BridgeBurn(address indexed account, uint256 amount);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="il1assetdeploymenttracker"><a class="header" href="#il1assetdeploymenttracker">IL1AssetDeploymentTracker</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/l1-contracts/bridge/interfaces/IL1AssetDeploymentTracker.sol">Git Source</a></p>
<p><strong>Author:</strong>
Matter Labs</p>
<p><strong>Note:</strong>
security-contact: security@matterlabs.dev</p>
<h2 id="functions-5"><a class="header" href="#functions-5">Functions</a></h2>
<h3 id="bridgecheckcounterpartaddress"><a class="header" href="#bridgecheckcounterpartaddress">bridgeCheckCounterpartAddress</a></h3>
<pre><code class="language-solidity">function bridgeCheckCounterpartAddress(
  uint256 _chainId,
  bytes32 _assetId,
  address _originalCaller,
  address _assetHandlerAddressOnCounterpart
) external view;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="il1assethandler"><a class="header" href="#il1assethandler">IL1AssetHandler</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/l1-contracts/bridge/interfaces/IL1AssetHandler.sol">Git Source</a></p>
<p><strong>Title:</strong>
L1 Asset Handler contract interface</p>
<p><strong>Author:</strong>
Matter Labs</p>
<p>Used for any asset handler and called by the L1AssetRouter</p>
<p><strong>Note:</strong>
security-contact: security@matterlabs.dev</p>
<h2 id="functions-6"><a class="header" href="#functions-6">Functions</a></h2>
<h3 id="bridgerecoverfailedtransfer-2"><a class="header" href="#bridgerecoverfailedtransfer-2">bridgeRecoverFailedTransfer</a></h3>
<pre><code class="language-solidity">function bridgeRecoverFailedTransfer(
  uint256 _chainId,
  bytes32 _assetId,
  address _depositSender,
  bytes calldata _data
) external payable;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_chainId</code></td><td><code>uint256</code></td><td>the chainId that the message will be sent to</td></tr>
<tr><td><code>_assetId</code></td><td><code>bytes32</code></td><td>the assetId of the asset being bridged</td></tr>
<tr><td><code>_depositSender</code></td><td><code>address</code></td><td>the address of the entity that initiated the deposit.</td></tr>
<tr><td><code>_data</code></td><td><code>bytes</code></td><td>the actual data specified for the function</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="il1basetokenassethandler"><a class="header" href="#il1basetokenassethandler">IL1BaseTokenAssetHandler</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/l1-contracts/bridge/interfaces/IL1BaseTokenAssetHandler.sol">Git Source</a></p>
<p><strong>Title:</strong>
L1 Base Token Asset Handler contract interface</p>
<p><strong>Author:</strong>
Matter Labs</p>
<p>Used for any asset handler and called by the L1AssetRouter</p>
<p><strong>Note:</strong>
security-contact: security@matterlabs.dev</p>
<h2 id="functions-7"><a class="header" href="#functions-7">Functions</a></h2>
<h3 id="tokenaddress"><a class="header" href="#tokenaddress">tokenAddress</a></h3>
<p>Used to get the token address of an assetId</p>
<pre><code class="language-solidity">function tokenAddress(bytes32 _assetId) external view returns (address);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="il1erc20bridge"><a class="header" href="#il1erc20bridge">IL1ERC20Bridge</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/l1-contracts/bridge/interfaces/IL1ERC20Bridge.sol">Git Source</a></p>
<p><strong>Title:</strong>
L1 Bridge contract legacy interface</p>
<p><strong>Author:</strong>
Matter Labs</p>
<p>Legacy Bridge interface before ZK chain migration, used for backward compatibility with ZKsync Era</p>
<p><strong>Note:</strong>
security-contact: security@matterlabs.dev</p>
<h2 id="functions-8"><a class="header" href="#functions-8">Functions</a></h2>
<h3 id="iswithdrawalfinalized-1"><a class="header" href="#iswithdrawalfinalized-1">isWithdrawalFinalized</a></h3>
<pre><code class="language-solidity">function isWithdrawalFinalized(
  uint256 _l2BatchNumber,
  uint256 _l2MessageIndex
) external view returns (bool);
</code></pre>
<h3 id="deposit"><a class="header" href="#deposit">deposit</a></h3>
<pre><code class="language-solidity">function deposit(
  address _l2Receiver,
  address _l1Token,
  uint256 _amount,
  uint256 _l2TxGasLimit,
  uint256 _l2TxGasPerPubdataByte,
  address _refundRecipient
) external payable returns (bytes32 txHash);
</code></pre>
<h3 id="deposit-1"><a class="header" href="#deposit-1">deposit</a></h3>
<pre><code class="language-solidity">function deposit(
  address _l2Receiver,
  address _l1Token,
  uint256 _amount,
  uint256 _l2TxGasLimit,
  uint256 _l2TxGasPerPubdataByte
) external payable returns (bytes32 txHash);
</code></pre>
<h3 id="claimfaileddeposit"><a class="header" href="#claimfaileddeposit">claimFailedDeposit</a></h3>
<pre><code class="language-solidity">function claimFailedDeposit(
  address _depositSender,
  address _l1Token,
  bytes32 _l2TxHash,
  uint256 _l2BatchNumber,
  uint256 _l2MessageIndex,
  uint16 _l2TxNumberInBatch,
  bytes32[] calldata _merkleProof
) external;
</code></pre>
<h3 id="finalizewithdrawal-1"><a class="header" href="#finalizewithdrawal-1">finalizeWithdrawal</a></h3>
<pre><code class="language-solidity">function finalizeWithdrawal(
  uint256 _l2BatchNumber,
  uint256 _l2MessageIndex,
  uint16 _l2TxNumberInBatch,
  bytes calldata _message,
  bytes32[] calldata _merkleProof
) external;
</code></pre>
<h3 id="l2tokenaddress"><a class="header" href="#l2tokenaddress">l2TokenAddress</a></h3>
<pre><code class="language-solidity">function l2TokenAddress(address _l1Token) external view returns (address);
</code></pre>
<h3 id="l1_nullifier-1"><a class="header" href="#l1_nullifier-1">L1_NULLIFIER</a></h3>
<pre><code class="language-solidity">function L1_NULLIFIER() external view returns (IL1Nullifier);
</code></pre>
<h3 id="l1_asset_router-1"><a class="header" href="#l1_asset_router-1">L1_ASSET_ROUTER</a></h3>
<pre><code class="language-solidity">function L1_ASSET_ROUTER() external view returns (IL1AssetRouter);
</code></pre>
<h3 id="l1_native_token_vault"><a class="header" href="#l1_native_token_vault">L1_NATIVE_TOKEN_VAULT</a></h3>
<pre><code class="language-solidity">function L1_NATIVE_TOKEN_VAULT() external view returns (IL1NativeTokenVault);
</code></pre>
<h3 id="l2tokenbeacon"><a class="header" href="#l2tokenbeacon">l2TokenBeacon</a></h3>
<pre><code class="language-solidity">function l2TokenBeacon() external view returns (address);
</code></pre>
<h3 id="l2bridge-1"><a class="header" href="#l2bridge-1">l2Bridge</a></h3>
<pre><code class="language-solidity">function l2Bridge() external view returns (address);
</code></pre>
<h3 id="depositamount"><a class="header" href="#depositamount">depositAmount</a></h3>
<pre><code class="language-solidity">function depositAmount(
  address _account,
  address _l1Token,
  bytes32 _depositL2TxHash
) external view returns (uint256 amount);
</code></pre>
<h2 id="events-5"><a class="header" href="#events-5">Events</a></h2>
<h3 id="depositinitiated"><a class="header" href="#depositinitiated">DepositInitiated</a></h3>
<pre><code class="language-solidity">event DepositInitiated(
  bytes32 indexed l2DepositTxHash,
  address indexed from,
  address indexed to,
  address l1Token,
  uint256 amount
);
</code></pre>
<h3 id="withdrawalfinalized"><a class="header" href="#withdrawalfinalized">WithdrawalFinalized</a></h3>
<pre><code class="language-solidity">event WithdrawalFinalized(
  address indexed to, address indexed l1Token, uint256 amount
);
</code></pre>
<h3 id="claimedfaileddeposit"><a class="header" href="#claimedfaileddeposit">ClaimedFailedDeposit</a></h3>
<pre><code class="language-solidity">event ClaimedFailedDeposit(
  address indexed to, address indexed l1Token, uint256 amount
);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="il1nullifier"><a class="header" href="#il1nullifier">IL1Nullifier</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/l1-contracts/bridge/interfaces/IL1Nullifier.sol">Git Source</a></p>
<p><strong>Title:</strong>
L1 Bridge contract interface</p>
<p><strong>Author:</strong>
Matter Labs</p>
<p><strong>Note:</strong>
security-contact: security@matterlabs.dev</p>
<h2 id="functions-9"><a class="header" href="#functions-9">Functions</a></h2>
<h3 id="iswithdrawalfinalized-2"><a class="header" href="#iswithdrawalfinalized-2">isWithdrawalFinalized</a></h3>
<pre><code class="language-solidity">function isWithdrawalFinalized(
  uint256 _chainId,
  uint256 _l2BatchNumber,
  uint256 _l2MessageIndex
) external view returns (bool);
</code></pre>
<h3 id="claimfaileddepositlegacyerc20bridge"><a class="header" href="#claimfaileddepositlegacyerc20bridge">claimFailedDepositLegacyErc20Bridge</a></h3>
<pre><code class="language-solidity">function claimFailedDepositLegacyErc20Bridge(
  address _depositSender,
  address _l1Token,
  uint256 _amount,
  bytes32 _l2TxHash,
  uint256 _l2BatchNumber,
  uint256 _l2MessageIndex,
  uint16 _l2TxNumberInBatch,
  bytes32[] calldata _merkleProof
) external;
</code></pre>
<h3 id="claimfaileddeposit-1"><a class="header" href="#claimfaileddeposit-1">claimFailedDeposit</a></h3>
<pre><code class="language-solidity">function claimFailedDeposit(
  uint256 _chainId,
  address _depositSender,
  address _l1Token,
  uint256 _amount,
  bytes32 _l2TxHash,
  uint256 _l2BatchNumber,
  uint256 _l2MessageIndex,
  uint16 _l2TxNumberInBatch,
  bytes32[] calldata _merkleProof
) external;
</code></pre>
<h3 id="finalizedeposit-1"><a class="header" href="#finalizedeposit-1">finalizeDeposit</a></h3>
<pre><code class="language-solidity">function finalizeDeposit(FinalizeL1DepositParams calldata _finalizeWithdrawalParams)
  external;
</code></pre>
<h3 id="bridge_hub-1"><a class="header" href="#bridge_hub-1">BRIDGE_HUB</a></h3>
<pre><code class="language-solidity">function BRIDGE_HUB() external view returns (IBridgehub);
</code></pre>
<h3 id="legacybridge"><a class="header" href="#legacybridge">legacyBridge</a></h3>
<pre><code class="language-solidity">function legacyBridge() external view returns (IL1ERC20Bridge);
</code></pre>
<h3 id="deposithappened"><a class="header" href="#deposithappened">depositHappened</a></h3>
<pre><code class="language-solidity">function depositHappened(uint256 _chainId, bytes32 _l2TxHash)
  external
  view
  returns (bytes32);
</code></pre>
<h3 id="bridgehubconfirml2transactionforwarded"><a class="header" href="#bridgehubconfirml2transactionforwarded">bridgehubConfirmL2TransactionForwarded</a></h3>
<pre><code class="language-solidity">function bridgehubConfirmL2TransactionForwarded(
  uint256 _chainId,
  bytes32 _txDataHash,
  bytes32 _txHash
) external;
</code></pre>
<h3 id="l1nativetokenvault"><a class="header" href="#l1nativetokenvault">l1NativeTokenVault</a></h3>
<pre><code class="language-solidity">function l1NativeTokenVault() external view returns (IL1NativeTokenVault);
</code></pre>
<h3 id="setl1nativetokenvault"><a class="header" href="#setl1nativetokenvault">setL1NativeTokenVault</a></h3>
<pre><code class="language-solidity">function setL1NativeTokenVault(IL1NativeTokenVault _nativeTokenVault) external;
</code></pre>
<h3 id="setl1assetrouter"><a class="header" href="#setl1assetrouter">setL1AssetRouter</a></h3>
<pre><code class="language-solidity">function setL1AssetRouter(address _l1AssetRouter) external;
</code></pre>
<h3 id="chainbalance"><a class="header" href="#chainbalance">chainBalance</a></h3>
<pre><code class="language-solidity">function chainBalance(uint256 _chainId, address _token)
  external
  view
  returns (uint256);
</code></pre>
<h3 id="l2bridgeaddress"><a class="header" href="#l2bridgeaddress">l2BridgeAddress</a></h3>
<pre><code class="language-solidity">function l2BridgeAddress(uint256 _chainId) external view returns (address);
</code></pre>
<h3 id="transfertokentontv"><a class="header" href="#transfertokentontv">transferTokenToNTV</a></h3>
<pre><code class="language-solidity">function transferTokenToNTV(address _token) external;
</code></pre>
<h3 id="nullifychainbalancebyntv"><a class="header" href="#nullifychainbalancebyntv">nullifyChainBalanceByNTV</a></h3>
<pre><code class="language-solidity">function nullifyChainBalanceByNTV(uint256 _chainId, address _token) external;
</code></pre>
<h3 id="bridgerecoverfailedtransfer-3"><a class="header" href="#bridgerecoverfailedtransfer-3">bridgeRecoverFailedTransfer</a></h3>
<p>Withdraw funds from the initiated deposit, that failed when finalizing on L2.</p>
<p>Processes claims of failed deposit, whether they originated from the legacy bridge or the current system.</p>
<pre><code class="language-solidity">function bridgeRecoverFailedTransfer(
  uint256 _chainId,
  address _depositSender,
  bytes32 _assetId,
  bytes memory _assetData,
  bytes32 _l2TxHash,
  uint256 _l2BatchNumber,
  uint256 _l2MessageIndex,
  uint16 _l2TxNumberInBatch,
  bytes32[] calldata _merkleProof
) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_chainId</code></td><td><code>uint256</code></td><td>The ZK chain id to which deposit was initiated.</td></tr>
<tr><td><code>_depositSender</code></td><td><code>address</code></td><td>The address of the entity that initiated the deposit.</td></tr>
<tr><td><code>_assetId</code></td><td><code>bytes32</code></td><td>The unique identifier of the deposited L1 token.</td></tr>
<tr><td><code>_assetData</code></td><td><code>bytes</code></td><td>The encoded transfer data, which includes both the deposit amount and the address of the L2 receiver. Might include extra information.</td></tr>
<tr><td><code>_l2TxHash</code></td><td><code>bytes32</code></td><td>The L2 transaction hash of the failed deposit finalization.</td></tr>
<tr><td><code>_l2BatchNumber</code></td><td><code>uint256</code></td><td>The L2 batch number where the deposit finalization was processed.</td></tr>
<tr><td><code>_l2MessageIndex</code></td><td><code>uint256</code></td><td>The position in the L2 logs Merkle tree of the l2Log that was sent with the message.</td></tr>
<tr><td><code>_l2TxNumberInBatch</code></td><td><code>uint16</code></td><td>The L2 transaction number in a batch, in which the log was sent.</td></tr>
<tr><td><code>_merkleProof</code></td><td><code>bytes32[]</code></td><td>The Merkle proof of the processing L1 -&gt; L2 transaction with deposit finalization.</td></tr>
</tbody></table>
</div>
<h3 id="finalizewithdrawal-2"><a class="header" href="#finalizewithdrawal-2">finalizeWithdrawal</a></h3>
<p>Legacy function to finalize withdrawal via the same
interface as the old L1SharedBridge.</p>
<p>Note, that we need to keep this interface, since the <code>L2AssetRouter</code>
will continue returning the previous address as the <code>l1SharedBridge</code>. The value
returned by it is used in the SDK for finalizing withdrawals.</p>
<pre><code class="language-solidity">function finalizeWithdrawal(
  uint256 _chainId,
  uint256 _l2BatchNumber,
  uint256 _l2MessageIndex,
  uint16 _l2TxNumberInBatch,
  bytes calldata _message,
  bytes32[] calldata _merkleProof
) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_chainId</code></td><td><code>uint256</code></td><td>The chain ID of the transaction to check</td></tr>
<tr><td><code>_l2BatchNumber</code></td><td><code>uint256</code></td><td>The L2 batch number where the withdrawal was processed</td></tr>
<tr><td><code>_l2MessageIndex</code></td><td><code>uint256</code></td><td>The position in the L2 logs Merkle tree of the l2Log that was sent with the message</td></tr>
<tr><td><code>_l2TxNumberInBatch</code></td><td><code>uint16</code></td><td>The L2 transaction number in the batch, in which the log was sent</td></tr>
<tr><td><code>_message</code></td><td><code>bytes</code></td><td>The L2 withdraw data, stored in an L2 -&gt; L1 message</td></tr>
<tr><td><code>_merkleProof</code></td><td><code>bytes32[]</code></td><td>The Merkle proof of the inclusion L2 -&gt; L1 message about withdrawal initialization</td></tr>
</tbody></table>
</div>
<h2 id="events-6"><a class="header" href="#events-6">Events</a></h2>
<h3 id="bridgehubdepositfinalized-1"><a class="header" href="#bridgehubdepositfinalized-1">BridgehubDepositFinalized</a></h3>
<pre><code class="language-solidity">event BridgehubDepositFinalized(
  uint256 indexed chainId,
  bytes32 indexed txDataHash,
  bytes32 indexed l2DepositTxHash
);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="il1sharedbridgelegacy"><a class="header" href="#il1sharedbridgelegacy">IL1SharedBridgeLegacy</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/l1-contracts/bridge/interfaces/IL1SharedBridgeLegacy.sol">Git Source</a></p>
<p><strong>Title:</strong>
L1 Bridge contract interface</p>
<p><strong>Author:</strong>
Matter Labs</p>
<p><strong>Note:</strong>
security-contact: security@matterlabs.dev</p>
<h2 id="functions-10"><a class="header" href="#functions-10">Functions</a></h2>
<h3 id="l2bridgeaddress-1"><a class="header" href="#l2bridgeaddress-1">l2BridgeAddress</a></h3>
<pre><code class="language-solidity">function l2BridgeAddress(uint256 _chainId) external view returns (address);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="il2sharedbridgelegacy"><a class="header" href="#il2sharedbridgelegacy">IL2SharedBridgeLegacy</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/l1-contracts/bridge/interfaces/IL2SharedBridgeLegacy.sol">Git Source</a></p>
<p><strong>Author:</strong>
Matter Labs</p>
<p><strong>Note:</strong>
security-contact: security@matterlabs.dev</p>
<h2 id="functions-11"><a class="header" href="#functions-11">Functions</a></h2>
<h3 id="l2tokenbeacon-1"><a class="header" href="#l2tokenbeacon-1">l2TokenBeacon</a></h3>
<pre><code class="language-solidity">function l2TokenBeacon() external returns (UpgradeableBeacon);
</code></pre>
<h3 id="withdraw-1"><a class="header" href="#withdraw-1">withdraw</a></h3>
<pre><code class="language-solidity">function withdraw(address _l1Receiver, address _l2Token, uint256 _amount)
  external;
</code></pre>
<h3 id="l1tokenaddress"><a class="header" href="#l1tokenaddress">l1TokenAddress</a></h3>
<pre><code class="language-solidity">function l1TokenAddress(address _l2Token) external view returns (address);
</code></pre>
<h3 id="l2tokenaddress-1"><a class="header" href="#l2tokenaddress-1">l2TokenAddress</a></h3>
<pre><code class="language-solidity">function l2TokenAddress(address _l1Token) external view returns (address);
</code></pre>
<h3 id="l1bridge"><a class="header" href="#l1bridge">l1Bridge</a></h3>
<pre><code class="language-solidity">function l1Bridge() external view returns (address);
</code></pre>
<h3 id="l1sharedbridge"><a class="header" href="#l1sharedbridge">l1SharedBridge</a></h3>
<pre><code class="language-solidity">function l1SharedBridge() external view returns (address);
</code></pre>
<h3 id="deploybeaconproxy"><a class="header" href="#deploybeaconproxy">deployBeaconProxy</a></h3>
<pre><code class="language-solidity">function deployBeaconProxy(bytes32 _salt) external returns (address);
</code></pre>
<h3 id="sendmessagetol1"><a class="header" href="#sendmessagetol1">sendMessageToL1</a></h3>
<pre><code class="language-solidity">function sendMessageToL1(bytes calldata _message) external returns (bytes32);
</code></pre>
<h2 id="events-7"><a class="header" href="#events-7">Events</a></h2>
<h3 id="finalizedeposit-2"><a class="header" href="#finalizedeposit-2">FinalizeDeposit</a></h3>
<pre><code class="language-solidity">event FinalizeDeposit(
  address indexed l1Sender,
  address indexed l2Receiver,
  address indexed l2Token,
  uint256 amount
);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="il2sharedbridgelegacyfunctions"><a class="header" href="#il2sharedbridgelegacyfunctions">IL2SharedBridgeLegacyFunctions</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/l1-contracts/bridge/interfaces/IL2SharedBridgeLegacyFunctions.sol">Git Source</a></p>
<p><strong>Author:</strong>
Matter Labs</p>
<h2 id="functions-12"><a class="header" href="#functions-12">Functions</a></h2>
<h3 id="finalizedeposit-3"><a class="header" href="#finalizedeposit-3">finalizeDeposit</a></h3>
<pre><code class="language-solidity">function finalizeDeposit(
  address _l1Sender,
  address _l2Receiver,
  address _l1Token,
  uint256 _amount,
  bytes calldata _data
) external;
</code></pre>
<h2 id="events-8"><a class="header" href="#events-8">Events</a></h2>
<h3 id="finalizedeposit-4"><a class="header" href="#finalizedeposit-4">FinalizeDeposit</a></h3>
<pre><code class="language-solidity">event FinalizeDeposit(
  address indexed l1Sender,
  address indexed l2Receiver,
  address indexed l2Token,
  uint256 amount
);
</code></pre>
<h3 id="withdrawalinitiated"><a class="header" href="#withdrawalinitiated">WithdrawalInitiated</a></h3>
<pre><code class="language-solidity">event WithdrawalInitiated(
  address indexed l2Sender,
  address indexed l1Receiver,
  address indexed l2Token,
  uint256 amount
);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="il2wrappedbasetoken"><a class="header" href="#il2wrappedbasetoken">IL2WrappedBaseToken</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/l1-contracts/bridge/interfaces/IL2WrappedBaseToken.sol">Git Source</a></p>
<h2 id="functions-13"><a class="header" href="#functions-13">Functions</a></h2>
<h3 id="deposit-2"><a class="header" href="#deposit-2">deposit</a></h3>
<pre><code class="language-solidity">function deposit() external payable;
</code></pre>
<h3 id="withdraw-2"><a class="header" href="#withdraw-2">withdraw</a></h3>
<pre><code class="language-solidity">function withdraw(uint256 _amount) external;
</code></pre>
<h3 id="depositto"><a class="header" href="#depositto">depositTo</a></h3>
<pre><code class="language-solidity">function depositTo(address _to) external payable;
</code></pre>
<h3 id="withdrawto"><a class="header" href="#withdrawto">withdrawTo</a></h3>
<pre><code class="language-solidity">function withdrawTo(address _to, uint256 _amount) external;
</code></pre>
<h2 id="events-9"><a class="header" href="#events-9">Events</a></h2>
<h3 id="initialize"><a class="header" href="#initialize">Initialize</a></h3>
<pre><code class="language-solidity">event Initialize(string name, string symbol, uint8 decimals);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="iweth9"><a class="header" href="#iweth9">IWETH9</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/l1-contracts/bridge/interfaces/IWETH9.sol">Git Source</a></p>
<h2 id="functions-14"><a class="header" href="#functions-14">Functions</a></h2>
<h3 id="deposit-3"><a class="header" href="#deposit-3">deposit</a></h3>
<pre><code class="language-solidity">function deposit() external payable;
</code></pre>
<h3 id="withdraw-3"><a class="header" href="#withdraw-3">withdraw</a></h3>
<pre><code class="language-solidity">function withdraw(uint256 wad) external;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="contents-4"><a class="header" href="#contents-4">Contents</a></h1>
<ul>
<li><a href="contracts/l1-contracts/bridge/ntv/IL1NativeTokenVault.sol/interface.IL1NativeTokenVault.html">IL1NativeTokenVault</a></li>
<li><a href="contracts/l1-contracts/bridge/ntv/IL2NativeTokenVault.sol/interface.IL2NativeTokenVault.html">IL2NativeTokenVault</a></li>
<li><a href="contracts/l1-contracts/bridge/ntv/INativeTokenVault.sol/interface.INativeTokenVault.html">INativeTokenVault</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="il1nativetokenvault"><a class="header" href="#il1nativetokenvault">IL1NativeTokenVault</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/l1-contracts/bridge/ntv/IL1NativeTokenVault.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
<a href="contracts/l1-contracts/bridge/ntv/IL1NativeTokenVault.sol//contracts/l1-contracts/bridge/ntv/INativeTokenVault.sol/interface.INativeTokenVault.html">INativeTokenVault</a>, <a href="contracts/l1-contracts/bridge/ntv/IL1NativeTokenVault.sol//contracts/l1-contracts/bridge/interfaces/IL1AssetDeploymentTracker.sol/interface.IL1AssetDeploymentTracker.html">IL1AssetDeploymentTracker</a></p>
<p><strong>Title:</strong>
L1 Native token vault contract interface</p>
<p><strong>Author:</strong>
Matter Labs</p>
<p>The NTV is an Asset Handler for the L1AssetRouter to handle native tokens</p>
<p><strong>Note:</strong>
security-contact: security@matterlabs.dev</p>
<h2 id="functions-15"><a class="header" href="#functions-15">Functions</a></h2>
<h3 id="l1_nullifier-2"><a class="header" href="#l1_nullifier-2">L1_NULLIFIER</a></h3>
<p>The L1Nullifier contract</p>
<pre><code class="language-solidity">function L1_NULLIFIER() external view returns (IL1Nullifier);
</code></pre>
<h3 id="chainbalance-1"><a class="header" href="#chainbalance-1">chainBalance</a></h3>
<p>Returns the total number of specific tokens locked for some chain</p>
<pre><code class="language-solidity">function chainBalance(uint256 _chainId, bytes32 _assetId)
  external
  view
  returns (uint256);
</code></pre>
<h3 id="registerethtoken"><a class="header" href="#registerethtoken">registerEthToken</a></h3>
<p>Registers ETH token</p>
<pre><code class="language-solidity">function registerEthToken() external;
</code></pre>
<h2 id="events-10"><a class="header" href="#events-10">Events</a></h2>
<h3 id="tokenbeaconupdated"><a class="header" href="#tokenbeaconupdated">TokenBeaconUpdated</a></h3>
<pre><code class="language-solidity">event TokenBeaconUpdated(address indexed l2TokenBeacon);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="il2nativetokenvault"><a class="header" href="#il2nativetokenvault">IL2NativeTokenVault</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/l1-contracts/bridge/ntv/IL2NativeTokenVault.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
<a href="contracts/l1-contracts/bridge/ntv/IL2NativeTokenVault.sol//contracts/l1-contracts/bridge/ntv/INativeTokenVault.sol/interface.INativeTokenVault.html">INativeTokenVault</a></p>
<p><strong>Author:</strong>
Matter Labs</p>
<p><strong>Note:</strong>
security-contact: security@matterlabs.dev</p>
<h2 id="functions-16"><a class="header" href="#functions-16">Functions</a></h2>
<h3 id="l2tokenaddress-2"><a class="header" href="#l2tokenaddress-2">l2TokenAddress</a></h3>
<pre><code class="language-solidity">function l2TokenAddress(address _l1Token) external view returns (address);
</code></pre>
<h3 id="setlegacytokenassetid"><a class="header" href="#setlegacytokenassetid">setLegacyTokenAssetId</a></h3>
<pre><code class="language-solidity">function setLegacyTokenAssetId(address _l2TokenAddress) external;
</code></pre>
<h2 id="events-11"><a class="header" href="#events-11">Events</a></h2>
<h3 id="finalizedeposit-5"><a class="header" href="#finalizedeposit-5">FinalizeDeposit</a></h3>
<pre><code class="language-solidity">event FinalizeDeposit(
  address indexed l1Sender,
  address indexed l2Receiver,
  address indexed l2Token,
  uint256 amount
);
</code></pre>
<h3 id="withdrawalinitiated-1"><a class="header" href="#withdrawalinitiated-1">WithdrawalInitiated</a></h3>
<pre><code class="language-solidity">event WithdrawalInitiated(
  address indexed l2Sender,
  address indexed l1Receiver,
  address indexed l2Token,
  uint256 amount
);
</code></pre>
<h3 id="l2tokenbeaconupdated"><a class="header" href="#l2tokenbeaconupdated">L2TokenBeaconUpdated</a></h3>
<pre><code class="language-solidity">event L2TokenBeaconUpdated(
  address indexed l2TokenBeacon, bytes32 indexed l2TokenProxyBytecodeHash
);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="inativetokenvault"><a class="header" href="#inativetokenvault">INativeTokenVault</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/l1-contracts/bridge/ntv/INativeTokenVault.sol">Git Source</a></p>
<p><strong>Title:</strong>
Base Native token vault contract interface</p>
<p><strong>Author:</strong>
Matter Labs</p>
<p>The NTV is an Asset Handler for the L1AssetRouter to handle native tokens</p>
<p><strong>Note:</strong>
security-contact: security@matterlabs.dev</p>
<h2 id="functions-17"><a class="header" href="#functions-17">Functions</a></h2>
<h3 id="weth_token"><a class="header" href="#weth_token">WETH_TOKEN</a></h3>
<p>The Weth token address</p>
<pre><code class="language-solidity">function WETH_TOKEN() external view returns (address);
</code></pre>
<h3 id="asset_router"><a class="header" href="#asset_router">ASSET_ROUTER</a></h3>
<p>The AssetRouter contract</p>
<pre><code class="language-solidity">function ASSET_ROUTER() external view returns (IAssetRouterBase);
</code></pre>
<h3 id="l1_chain_id"><a class="header" href="#l1_chain_id">L1_CHAIN_ID</a></h3>
<p>The chain ID of the L1 chain</p>
<pre><code class="language-solidity">function L1_CHAIN_ID() external view returns (uint256);
</code></pre>
<h3 id="originchainid"><a class="header" href="#originchainid">originChainId</a></h3>
<p>Returns the chain ID of the origin chain for a given asset ID</p>
<pre><code class="language-solidity">function originChainId(bytes32 assetId) external view returns (uint256);
</code></pre>
<h3 id="registertoken"><a class="header" href="#registertoken">registerToken</a></h3>
<p>Registers tokens within the NTV.</p>
<p>Allows the bridge to register a token address for the vault.</p>
<p>No access control is ok, since the bridging of tokens should be permissionless. This requires permissionless registration.</p>
<p>The goal is to allow bridging native tokens automatically, by registering them on the fly.</p>
<pre><code class="language-solidity">function registerToken(address _l1Token) external;
</code></pre>
<h3 id="ensuretokenisregistered"><a class="header" href="#ensuretokenisregistered">ensureTokenIsRegistered</a></h3>
<p>Ensures that the native token is registered with the NTV.</p>
<p>This function is used to ensure that the token is registered with the NTV.</p>
<pre><code class="language-solidity">function ensureTokenIsRegistered(address _nativeToken)
  external
  returns (bytes32);
</code></pre>
<h3 id="geterc20getters"><a class="header" href="#geterc20getters">getERC20Getters</a></h3>
<p>Used to get the the ERC20 data for a token</p>
<pre><code class="language-solidity">function getERC20Getters(address _token, uint256 _originChainId)
  external
  view
  returns (bytes memory);
</code></pre>
<h3 id="tokenaddress-1"><a class="header" href="#tokenaddress-1">tokenAddress</a></h3>
<p>Used to get the token address of an assetId</p>
<pre><code class="language-solidity">function tokenAddress(bytes32 assetId) external view returns (address);
</code></pre>
<h3 id="assetid-1"><a class="header" href="#assetid-1">assetId</a></h3>
<p>Used to get the assetId of a token</p>
<pre><code class="language-solidity">function assetId(address token) external view returns (bytes32);
</code></pre>
<h3 id="calculatecreate2tokenaddress"><a class="header" href="#calculatecreate2tokenaddress">calculateCreate2TokenAddress</a></h3>
<p>Used to get the expected bridged token address corresponding to its native counterpart</p>
<pre><code class="language-solidity">function calculateCreate2TokenAddress(
  uint256 _originChainId,
  address _originToken
) external view returns (address);
</code></pre>
<h3 id="tryregistertokenfromburndata"><a class="header" href="#tryregistertokenfromburndata">tryRegisterTokenFromBurnData</a></h3>
<p>Tries to register a token from the provided <code>_burnData</code> and reverts if it is not possible.</p>
<pre><code class="language-solidity">function tryRegisterTokenFromBurnData(
  bytes calldata _burnData,
  bytes32 _expectedAssetId
) external;
</code></pre>
<h2 id="events-12"><a class="header" href="#events-12">Events</a></h2>
<h3 id="bridgedtokenbeaconupdated"><a class="header" href="#bridgedtokenbeaconupdated">BridgedTokenBeaconUpdated</a></h3>
<pre><code class="language-solidity">event BridgedTokenBeaconUpdated(
  address bridgedTokenBeacon, bytes32 bridgedTokenProxyBytecodeHash
);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="bridge-errors"><a class="header" href="#bridge-errors">Bridge Errors</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="ethtransferfailed"><a class="header" href="#ethtransferfailed">EthTransferFailed</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/l1-contracts/bridge/L1BridgeContractErrors.sol">Git Source</a></p>
<pre><code class="language-solidity">error EthTransferFailed();
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="nativetokenvaultalreadyset"><a class="header" href="#nativetokenvaultalreadyset">NativeTokenVaultAlreadySet</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/l1-contracts/bridge/L1BridgeContractErrors.sol">Git Source</a></p>
<pre><code class="language-solidity">error NativeTokenVaultAlreadySet();
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="wrongmsglength"><a class="header" href="#wrongmsglength">WrongMsgLength</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/l1-contracts/bridge/L1BridgeContractErrors.sol">Git Source</a></p>
<pre><code class="language-solidity">error WrongMsgLength(uint256 expected, uint256 length);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="zeroamounttotransfer"><a class="header" href="#zeroamounttotransfer">ZeroAmountToTransfer</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/l1-contracts/bridge/L1BridgeContractErrors.sol">Git Source</a></p>
<pre><code class="language-solidity">error ZeroAmountToTransfer();
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="wrongamounttransferred"><a class="header" href="#wrongamounttransferred">WrongAmountTransferred</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/l1-contracts/bridge/L1BridgeContractErrors.sol">Git Source</a></p>
<pre><code class="language-solidity">error WrongAmountTransferred(uint256 balance, uint256 nullifierChainBalance);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="emptytoken"><a class="header" href="#emptytoken">EmptyToken</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/l1-contracts/bridge/L1BridgeContractErrors.sol">Git Source</a></p>
<pre><code class="language-solidity">error EmptyToken();
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="claimfaileddepositfailed"><a class="header" href="#claimfaileddepositfailed">ClaimFailedDepositFailed</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/l1-contracts/bridge/L1BridgeContractErrors.sol">Git Source</a></p>
<pre><code class="language-solidity">error ClaimFailedDepositFailed();
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="wrongl2sender"><a class="header" href="#wrongl2sender">WrongL2Sender</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/l1-contracts/bridge/L1BridgeContractErrors.sol">Git Source</a></p>
<pre><code class="language-solidity">error WrongL2Sender(address providedL2Sender);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="wrongcounterpart"><a class="header" href="#wrongcounterpart">WrongCounterpart</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/l1-contracts/bridge/L1BridgeContractErrors.sol">Git Source</a></p>
<pre><code class="language-solidity">error WrongCounterpart();
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="contents-5"><a class="header" href="#contents-5">Contents</a></h1>
<ul>
<li><a href="contracts/l1-contracts/bridgehub/IBridgehub.sol/struct.L2TransactionRequestDirect.html">L2TransactionRequestDirect</a></li>
<li><a href="contracts/l1-contracts/bridgehub/IBridgehub.sol/struct.L2TransactionRequestTwoBridgesOuter.html">L2TransactionRequestTwoBridgesOuter</a></li>
<li><a href="contracts/l1-contracts/bridgehub/IBridgehub.sol/struct.L2TransactionRequestTwoBridgesInner.html">L2TransactionRequestTwoBridgesInner</a></li>
<li><a href="contracts/l1-contracts/bridgehub/IBridgehub.sol/struct.BridgehubMintCTMAssetData.html">BridgehubMintCTMAssetData</a></li>
<li><a href="contracts/l1-contracts/bridgehub/IBridgehub.sol/struct.BridgehubBurnCTMAssetData.html">BridgehubBurnCTMAssetData</a></li>
<li><a href="contracts/l1-contracts/bridgehub/IBridgehub.sol/interface.IBridgehub.html">IBridgehub</a></li>
<li><a href="contracts/l1-contracts/bridgehub/ICTMDeploymentTracker.sol/interface.ICTMDeploymentTracker.html">ICTMDeploymentTracker</a></li>
<li><a href="contracts/l1-contracts/bridgehub/IChainAssetHandler.sol/interface.IChainAssetHandler.html">IChainAssetHandler</a></li>
<li><a href="contracts/l1-contracts/bridgehub/IMessageRoot.sol/interface.IMessageRoot.html">IMessageRoot</a></li>
<li><a href="contracts/l1-contracts/bridgehub/L1BridgehubErrors.sol/error.AlreadyCurrentSL.html">AlreadyCurrentSL</a></li>
<li><a href="contracts/l1-contracts/bridgehub/L1BridgehubErrors.sol/error.ChainExists.html">ChainExists</a></li>
<li><a href="contracts/l1-contracts/bridgehub/L1BridgehubErrors.sol/error.ChainIdAlreadyPresent.html">ChainIdAlreadyPresent</a></li>
<li><a href="contracts/l1-contracts/bridgehub/L1BridgehubErrors.sol/error.ChainNotLegacy.html">ChainNotLegacy</a></li>
<li><a href="contracts/l1-contracts/bridgehub/L1BridgehubErrors.sol/error.ChainNotPresentInCTM.html">ChainNotPresentInCTM</a></li>
<li><a href="contracts/l1-contracts/bridgehub/L1BridgehubErrors.sol/error.HyperchainNotRegistered.html">HyperchainNotRegistered</a></li>
<li><a href="contracts/l1-contracts/bridgehub/L1BridgehubErrors.sol/error.IncorrectChainAssetId.html">IncorrectChainAssetId</a></li>
<li><a href="contracts/l1-contracts/bridgehub/L1BridgehubErrors.sol/error.IncorrectSender.html">IncorrectSender</a></li>
<li><a href="contracts/l1-contracts/bridgehub/L1BridgehubErrors.sol/error.MessageRootNotRegistered.html">MessageRootNotRegistered</a></li>
<li><a href="contracts/l1-contracts/bridgehub/L1BridgehubErrors.sol/error.NoEthAllowed.html">NoEthAllowed</a></li>
<li><a href="contracts/l1-contracts/bridgehub/L1BridgehubErrors.sol/error.NotAssetRouter.html">NotAssetRouter</a></li>
<li><a href="contracts/l1-contracts/bridgehub/L1BridgehubErrors.sol/error.NotChainAssetHandler.html">NotChainAssetHandler</a></li>
<li><a href="contracts/l1-contracts/bridgehub/L1BridgehubErrors.sol/error.NotCurrentSL.html">NotCurrentSL</a></li>
<li><a href="contracts/l1-contracts/bridgehub/L1BridgehubErrors.sol/error.NotInGatewayMode.html">NotInGatewayMode</a></li>
<li><a href="contracts/l1-contracts/bridgehub/L1BridgehubErrors.sol/error.NotL1.html">NotL1</a></li>
<li><a href="contracts/l1-contracts/bridgehub/L1BridgehubErrors.sol/error.NotOwner.html">NotOwner</a></li>
<li><a href="contracts/l1-contracts/bridgehub/L1BridgehubErrors.sol/error.NotOwnerViaRouter.html">NotOwnerViaRouter</a></li>
<li><a href="contracts/l1-contracts/bridgehub/L1BridgehubErrors.sol/error.NotRelayedSender.html">NotRelayedSender</a></li>
<li><a href="contracts/l1-contracts/bridgehub/L1BridgehubErrors.sol/error.OnlyBridgehub.html">OnlyBridgehub</a></li>
<li><a href="contracts/l1-contracts/bridgehub/L1BridgehubErrors.sol/error.OnlyBridgehubOrChainAssetHandler.html">OnlyBridgehubOrChainAssetHandler</a></li>
<li><a href="contracts/l1-contracts/bridgehub/L1BridgehubErrors.sol/error.OnlyChain.html">OnlyChain</a></li>
<li><a href="contracts/l1-contracts/bridgehub/L1BridgehubErrors.sol/error.SecondBridgeAddressTooLow.html">SecondBridgeAddressTooLow</a></li>
<li><a href="contracts/l1-contracts/bridgehub/L1BridgehubErrors.sol/error.SLNotWhitelisted.html">SLNotWhitelisted</a></li>
<li><a href="contracts/l1-contracts/bridgehub/L1BridgehubErrors.sol/error.WrongCounterPart.html">WrongCounterPart</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="ibridgehub"><a class="header" href="#ibridgehub">IBridgehub</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/l1-contracts/bridgehub/IBridgehub.sol">Git Source</a></p>
<p><strong>Author:</strong>
Matter Labs</p>
<p><strong>Note:</strong>
security-contact: security@matterlabs.dev</p>
<h2 id="functions-18"><a class="header" href="#functions-18">Functions</a></h2>
<h3 id="setpendingadmin"><a class="header" href="#setpendingadmin">setPendingAdmin</a></h3>
<p>Starts the transfer of admin rights. Only the current admin or owner can propose a new pending one.</p>
<p>New admin can accept admin rights by calling <code>acceptAdmin</code> function.</p>
<pre><code class="language-solidity">function setPendingAdmin(address _newPendingAdmin) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_newPendingAdmin</code></td><td><code>address</code></td><td>Address of the new admin</td></tr>
</tbody></table>
</div>
<h3 id="acceptadmin"><a class="header" href="#acceptadmin">acceptAdmin</a></h3>
<p>Accepts transfer of admin rights. Only pending admin can accept the role.</p>
<pre><code class="language-solidity">function acceptAdmin() external;
</code></pre>
<h3 id="chaintypemanagerisregistered"><a class="header" href="#chaintypemanagerisregistered">chainTypeManagerIsRegistered</a></h3>
<p>Getters</p>
<pre><code class="language-solidity">function chainTypeManagerIsRegistered(address _chainTypeManager)
  external
  view
  returns (bool);
</code></pre>
<h3 id="chaintypemanager"><a class="header" href="#chaintypemanager">chainTypeManager</a></h3>
<pre><code class="language-solidity">function chainTypeManager(uint256 _chainId) external view returns (address);
</code></pre>
<h3 id="assetidisregistered"><a class="header" href="#assetidisregistered">assetIdIsRegistered</a></h3>
<pre><code class="language-solidity">function assetIdIsRegistered(bytes32 _baseTokenAssetId)
  external
  view
  returns (bool);
</code></pre>
<h3 id="basetoken"><a class="header" href="#basetoken">baseToken</a></h3>
<pre><code class="language-solidity">function baseToken(uint256 _chainId) external view returns (address);
</code></pre>
<h3 id="basetokenassetid"><a class="header" href="#basetokenassetid">baseTokenAssetId</a></h3>
<pre><code class="language-solidity">function baseTokenAssetId(uint256 _chainId) external view returns (bytes32);
</code></pre>
<h3 id="messageroot"><a class="header" href="#messageroot">messageRoot</a></h3>
<pre><code class="language-solidity">function messageRoot() external view returns (IMessageRoot);
</code></pre>
<h3 id="getzkchain"><a class="header" href="#getzkchain">getZKChain</a></h3>
<pre><code class="language-solidity">function getZKChain(uint256 _chainId) external view returns (address);
</code></pre>
<h3 id="getallzkchains"><a class="header" href="#getallzkchains">getAllZKChains</a></h3>
<pre><code class="language-solidity">function getAllZKChains() external view returns (address[] memory);
</code></pre>
<h3 id="getallzkchainchainids"><a class="header" href="#getallzkchainchainids">getAllZKChainChainIDs</a></h3>
<pre><code class="language-solidity">function getAllZKChainChainIDs() external view returns (uint256[] memory);
</code></pre>
<h3 id="migrationpaused"><a class="header" href="#migrationpaused">migrationPaused</a></h3>
<pre><code class="language-solidity">function migrationPaused() external view returns (bool);
</code></pre>
<h3 id="admin"><a class="header" href="#admin">admin</a></h3>
<pre><code class="language-solidity">function admin() external view returns (address);
</code></pre>
<h3 id="assetrouter"><a class="header" href="#assetrouter">assetRouter</a></h3>
<pre><code class="language-solidity">function assetRouter() external view returns (address);
</code></pre>
<h3 id="provel2messageinclusion"><a class="header" href="#provel2messageinclusion">proveL2MessageInclusion</a></h3>
<p>Mailbox forwarder</p>
<pre><code class="language-solidity">function proveL2MessageInclusion(
  uint256 _chainId,
  uint256 _batchNumber,
  uint256 _index,
  L2Message calldata _message,
  bytes32[] calldata _proof
) external view returns (bool);
</code></pre>
<h3 id="provel2loginclusion"><a class="header" href="#provel2loginclusion">proveL2LogInclusion</a></h3>
<pre><code class="language-solidity">function proveL2LogInclusion(
  uint256 _chainId,
  uint256 _batchNumber,
  uint256 _index,
  L2Log memory _log,
  bytes32[] calldata _proof
) external view returns (bool);
</code></pre>
<h3 id="provel1tol2transactionstatus"><a class="header" href="#provel1tol2transactionstatus">proveL1ToL2TransactionStatus</a></h3>
<pre><code class="language-solidity">function proveL1ToL2TransactionStatus(
  uint256 _chainId,
  bytes32 _l2TxHash,
  uint256 _l2BatchNumber,
  uint256 _l2MessageIndex,
  uint16 _l2TxNumberInBatch,
  bytes32[] calldata _merkleProof,
  TxStatus _status
) external view returns (bool);
</code></pre>
<h3 id="requestl2transactiondirect"><a class="header" href="#requestl2transactiondirect">requestL2TransactionDirect</a></h3>
<pre><code class="language-solidity">function requestL2TransactionDirect(L2TransactionRequestDirect calldata _request)
  external
  payable
  returns (bytes32 canonicalTxHash);
</code></pre>
<h3 id="requestl2transactiontwobridges"><a class="header" href="#requestl2transactiontwobridges">requestL2TransactionTwoBridges</a></h3>
<pre><code class="language-solidity">function requestL2TransactionTwoBridges(L2TransactionRequestTwoBridgesOuter calldata _request)
  external
  payable
  returns (bytes32 canonicalTxHash);
</code></pre>
<h3 id="l2transactionbasecost"><a class="header" href="#l2transactionbasecost">l2TransactionBaseCost</a></h3>
<pre><code class="language-solidity">function l2TransactionBaseCost(
  uint256 _chainId,
  uint256 _gasPrice,
  uint256 _l2GasLimit,
  uint256 _l2GasPerPubdataByteLimit
) external view returns (uint256);
</code></pre>
<h3 id="createnewchain"><a class="header" href="#createnewchain">createNewChain</a></h3>
<pre><code class="language-solidity">function createNewChain(
  uint256 _chainId,
  address _chainTypeManager,
  bytes32 _baseTokenAssetId,
  uint256 _salt,
  address _admin,
  bytes calldata _initData,
  bytes[] calldata _factoryDeps
) external returns (uint256 chainId);
</code></pre>
<h3 id="addchaintypemanager"><a class="header" href="#addchaintypemanager">addChainTypeManager</a></h3>
<pre><code class="language-solidity">function addChainTypeManager(address _chainTypeManager) external;
</code></pre>
<h3 id="removechaintypemanager"><a class="header" href="#removechaintypemanager">removeChainTypeManager</a></h3>
<pre><code class="language-solidity">function removeChainTypeManager(address _chainTypeManager) external;
</code></pre>
<h3 id="addtokenassetid"><a class="header" href="#addtokenassetid">addTokenAssetId</a></h3>
<pre><code class="language-solidity">function addTokenAssetId(bytes32 _baseTokenAssetId) external;
</code></pre>
<h3 id="setaddresses"><a class="header" href="#setaddresses">setAddresses</a></h3>
<pre><code class="language-solidity">function setAddresses(
  address _sharedBridge,
  ICTMDeploymentTracker _l1CtmDeployer,
  IMessageRoot _messageRoot,
  address _chainAssetHandler
) external;
</code></pre>
<h3 id="setchainassethandler"><a class="header" href="#setchainassethandler">setChainAssetHandler</a></h3>
<pre><code class="language-solidity">function setChainAssetHandler(address _chainAssetHandler) external;
</code></pre>
<h3 id="whitelistedsettlementlayers"><a class="header" href="#whitelistedsettlementlayers">whitelistedSettlementLayers</a></h3>
<pre><code class="language-solidity">function whitelistedSettlementLayers(uint256 _chainId)
  external
  view
  returns (bool);
</code></pre>
<h3 id="registersettlementlayer"><a class="header" href="#registersettlementlayer">registerSettlementLayer</a></h3>
<pre><code class="language-solidity">function registerSettlementLayer(
  uint256 _newSettlementLayerChainId,
  bool _isWhitelisted
) external;
</code></pre>
<h3 id="settlementlayer"><a class="header" href="#settlementlayer">settlementLayer</a></h3>
<pre><code class="language-solidity">function settlementLayer(uint256 _chainId) external view returns (uint256);
</code></pre>
<h3 id="forwardtransactionongateway"><a class="header" href="#forwardtransactionongateway">forwardTransactionOnGateway</a></h3>
<pre><code class="language-solidity">function forwardTransactionOnGateway(
  uint256 _chainId,
  bytes32 _canonicalTxHash,
  uint64 _expirationTimestamp
) external;
</code></pre>
<h3 id="ctmassetidfromchainid"><a class="header" href="#ctmassetidfromchainid">ctmAssetIdFromChainId</a></h3>
<pre><code class="language-solidity">function ctmAssetIdFromChainId(uint256 _chainId)
  external
  view
  returns (bytes32);
</code></pre>
<h3 id="ctmassetidfromaddress"><a class="header" href="#ctmassetidfromaddress">ctmAssetIdFromAddress</a></h3>
<pre><code class="language-solidity">function ctmAssetIdFromAddress(address _ctmAddress)
  external
  view
  returns (bytes32);
</code></pre>
<h3 id="l1ctmdeployer"><a class="header" href="#l1ctmdeployer">l1CtmDeployer</a></h3>
<pre><code class="language-solidity">function l1CtmDeployer() external view returns (ICTMDeploymentTracker);
</code></pre>
<h3 id="ctmassetidtoaddress"><a class="header" href="#ctmassetidtoaddress">ctmAssetIdToAddress</a></h3>
<pre><code class="language-solidity">function ctmAssetIdToAddress(bytes32 _assetInfo)
  external
  view
  returns (address);
</code></pre>
<h3 id="setctmassetaddress"><a class="header" href="#setctmassetaddress">setCTMAssetAddress</a></h3>
<pre><code class="language-solidity">function setCTMAssetAddress(bytes32 _additionalData, address _assetAddress)
  external;
</code></pre>
<h3 id="l1_chain_id-1"><a class="header" href="#l1_chain_id-1">L1_CHAIN_ID</a></h3>
<pre><code class="language-solidity">function L1_CHAIN_ID() external view returns (uint256);
</code></pre>
<h3 id="chainassethandler"><a class="header" href="#chainassethandler">chainAssetHandler</a></h3>
<pre><code class="language-solidity">function chainAssetHandler() external view returns (address);
</code></pre>
<h3 id="registeralreadydeployedzkchain"><a class="header" href="#registeralreadydeployedzkchain">registerAlreadyDeployedZKChain</a></h3>
<pre><code class="language-solidity">function registerAlreadyDeployedZKChain(uint256 _chainId, address _hyperchain)
  external;
</code></pre>
<h3 id="registerlegacychain"><a class="header" href="#registerlegacychain">registerLegacyChain</a></h3>
<pre><code class="language-solidity">function registerLegacyChain(uint256 _chainId) external;
</code></pre>
<h3 id="pausemigration"><a class="header" href="#pausemigration">pauseMigration</a></h3>
<pre><code class="language-solidity">function pauseMigration() external;
</code></pre>
<h3 id="unpausemigration"><a class="header" href="#unpausemigration">unpauseMigration</a></h3>
<pre><code class="language-solidity">function unpauseMigration() external;
</code></pre>
<h3 id="forwardedbridgeburnsetsettlementlayer"><a class="header" href="#forwardedbridgeburnsetsettlementlayer">forwardedBridgeBurnSetSettlementLayer</a></h3>
<pre><code class="language-solidity">function forwardedBridgeBurnSetSettlementLayer(
  uint256 _chainId,
  uint256 _newSettlementLayerChainId
) external returns (address zkChain, address ctm);
</code></pre>
<h3 id="forwardedbridgemint"><a class="header" href="#forwardedbridgemint">forwardedBridgeMint</a></h3>
<pre><code class="language-solidity">function forwardedBridgeMint(
  bytes32 _assetId,
  uint256 _chainId,
  bytes32 _baseTokenAssetId
) external returns (address zkChain, address ctm);
</code></pre>
<h3 id="registernewzkchain"><a class="header" href="#registernewzkchain">registerNewZKChain</a></h3>
<pre><code class="language-solidity">function registerNewZKChain(
  uint256 _chainId,
  address _zkChain,
  bool _checkMaxNumberOfZKChains
) external;
</code></pre>
<h3 id="forwardedbridgerecoverfailedtransfer"><a class="header" href="#forwardedbridgerecoverfailedtransfer">forwardedBridgeRecoverFailedTransfer</a></h3>
<pre><code class="language-solidity">function forwardedBridgeRecoverFailedTransfer(uint256 _chainId)
  external
  returns (address zkChain, address ctm);
</code></pre>
<h2 id="events-13"><a class="header" href="#events-13">Events</a></h2>
<h3 id="newpendingadmin"><a class="header" href="#newpendingadmin">NewPendingAdmin</a></h3>
<p>pendingAdmin is changed</p>
<p>Also emitted when new admin is accepted and in this case, <code>newPendingAdmin</code> would be zero address</p>
<pre><code class="language-solidity">event NewPendingAdmin(
  address indexed oldPendingAdmin, address indexed newPendingAdmin
);
</code></pre>
<h3 id="newadmin"><a class="header" href="#newadmin">NewAdmin</a></h3>
<p>Admin changed</p>
<pre><code class="language-solidity">event NewAdmin(address indexed oldAdmin, address indexed newAdmin);
</code></pre>
<h3 id="assetregistered"><a class="header" href="#assetregistered">AssetRegistered</a></h3>
<p>CTM asset registered</p>
<pre><code class="language-solidity">event AssetRegistered(
  bytes32 indexed assetInfo,
  address indexed _assetAddress,
  bytes32 indexed additionalData,
  address sender
);
</code></pre>
<h3 id="settlementlayerregistered"><a class="header" href="#settlementlayerregistered">SettlementLayerRegistered</a></h3>
<pre><code class="language-solidity">event SettlementLayerRegistered(
  uint256 indexed chainId, bool indexed isWhitelisted
);
</code></pre>
<h3 id="newchain"><a class="header" href="#newchain">NewChain</a></h3>
<pre><code class="language-solidity">event NewChain(
  uint256 indexed chainId,
  address chainTypeManager,
  address indexed chainGovernance
);
</code></pre>
<h3 id="chaintypemanageradded"><a class="header" href="#chaintypemanageradded">ChainTypeManagerAdded</a></h3>
<pre><code class="language-solidity">event ChainTypeManagerAdded(address indexed chainTypeManager);
</code></pre>
<h3 id="chaintypemanagerremoved"><a class="header" href="#chaintypemanagerremoved">ChainTypeManagerRemoved</a></h3>
<pre><code class="language-solidity">event ChainTypeManagerRemoved(address indexed chainTypeManager);
</code></pre>
<h3 id="basetokenassetidregistered"><a class="header" href="#basetokenassetidregistered">BaseTokenAssetIdRegistered</a></h3>
<pre><code class="language-solidity">event BaseTokenAssetIdRegistered(bytes32 indexed assetId);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="ictmdeploymenttracker"><a class="header" href="#ictmdeploymenttracker">ICTMDeploymentTracker</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/l1-contracts/bridgehub/ICTMDeploymentTracker.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
<a href="contracts/l1-contracts/bridgehub/ICTMDeploymentTracker.sol//contracts/l1-contracts/bridge/interfaces/IL1AssetDeploymentTracker.sol/interface.IL1AssetDeploymentTracker.html">IL1AssetDeploymentTracker</a></p>
<p><strong>Author:</strong>
Matter Labs</p>
<p><strong>Note:</strong>
security-contact: security@matterlabs.dev</p>
<h2 id="functions-19"><a class="header" href="#functions-19">Functions</a></h2>
<h3 id="bridgehubdeposit-1"><a class="header" href="#bridgehubdeposit-1">bridgehubDeposit</a></h3>
<pre><code class="language-solidity">function bridgehubDeposit(
  uint256 _chainId,
  address _originalCaller,
  uint256 _l2Value,
  bytes calldata _data
)
  external
  payable
  returns (L2TransactionRequestTwoBridgesInner memory request);
</code></pre>
<h3 id="bridge_hub-2"><a class="header" href="#bridge_hub-2">BRIDGE_HUB</a></h3>
<pre><code class="language-solidity">function BRIDGE_HUB() external view returns (IBridgehub);
</code></pre>
<h3 id="l1_asset_router-2"><a class="header" href="#l1_asset_router-2">L1_ASSET_ROUTER</a></h3>
<pre><code class="language-solidity">function L1_ASSET_ROUTER() external view returns (IAssetRouterBase);
</code></pre>
<h3 id="registerctmassetonl1"><a class="header" href="#registerctmassetonl1">registerCTMAssetOnL1</a></h3>
<pre><code class="language-solidity">function registerCTMAssetOnL1(address _ctmAddress) external;
</code></pre>
<h3 id="calculateassetid"><a class="header" href="#calculateassetid">calculateAssetId</a></h3>
<pre><code class="language-solidity">function calculateAssetId(address _l1CTM) external view returns (bytes32);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="imessageroot"><a class="header" href="#imessageroot">IMessageRoot</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/l1-contracts/bridgehub/IMessageRoot.sol">Git Source</a></p>
<p><strong>Author:</strong>
Matter Labs</p>
<p>MessageRoot contract is responsible for storing and aggregating the roots of the batches from different chains into the MessageRoot.</p>
<p><strong>Note:</strong>
security-contact: security@matterlabs.dev</p>
<h2 id="functions-20"><a class="header" href="#functions-20">Functions</a></h2>
<h3 id="bridge_hub-3"><a class="header" href="#bridge_hub-3">BRIDGE_HUB</a></h3>
<pre><code class="language-solidity">function BRIDGE_HUB() external view returns (IBridgehub);
</code></pre>
<h3 id="addnewchain"><a class="header" href="#addnewchain">addNewChain</a></h3>
<pre><code class="language-solidity">function addNewChain(uint256 _chainId) external;
</code></pre>
<h3 id="addchainbatchroot"><a class="header" href="#addchainbatchroot">addChainBatchRoot</a></h3>
<pre><code class="language-solidity">function addChainBatchRoot(
  uint256 _chainId,
  uint256 _batchNumber,
  bytes32 _chainBatchRoot
) external;
</code></pre>
<h3 id="historicalroot"><a class="header" href="#historicalroot">historicalRoot</a></h3>
<pre><code class="language-solidity">function historicalRoot(uint256 _blockNumber) external view returns (bytes32);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="ichainassethandler"><a class="header" href="#ichainassethandler">IChainAssetHandler</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/l1-contracts/bridgehub/IChainAssetHandler.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
<a href="contracts/l1-contracts/bridgehub/IChainAssetHandler.sol//contracts/l1-contracts/bridge/interfaces/IAssetHandler.sol/interface.IAssetHandler.html">IAssetHandler</a>, <a href="contracts/l1-contracts/bridgehub/IChainAssetHandler.sol//contracts/l1-contracts/bridge/interfaces/IL1AssetHandler.sol/interface.IL1AssetHandler.html">IL1AssetHandler</a></p>
<p><strong>Author:</strong>
Matter Labs</p>
<p><strong>Note:</strong>
security-contact: security@matterlabs.dev</p>
<h2 id="events-14"><a class="header" href="#events-14">Events</a></h2>
<h3 id="migrationstarted"><a class="header" href="#migrationstarted">MigrationStarted</a></h3>
<p>Emitted when the bridging to the chain is started.</p>
<pre><code class="language-solidity">event MigrationStarted(
  uint256 indexed chainId,
  bytes32 indexed assetId,
  uint256 indexed settlementLayerChainId
);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>chainId</code></td><td><code>uint256</code></td><td>Chain ID of the ZK chain</td></tr>
<tr><td><code>assetId</code></td><td><code>bytes32</code></td><td>Asset ID of the token for the zkChain's CTM</td></tr>
<tr><td><code>settlementLayerChainId</code></td><td><code>uint256</code></td><td>The chain id of the settlement layer the chain migrates to.</td></tr>
</tbody></table>
</div>
<h3 id="migrationfinalized"><a class="header" href="#migrationfinalized">MigrationFinalized</a></h3>
<p>Emitted when the bridging to the chain is complete.</p>
<pre><code class="language-solidity">event MigrationFinalized(
  uint256 indexed chainId, bytes32 indexed assetId, address indexed zkChain
);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>chainId</code></td><td><code>uint256</code></td><td>Chain ID of the ZK chain</td></tr>
<tr><td><code>assetId</code></td><td><code>bytes32</code></td><td>Asset ID of the token for the zkChain's CTM</td></tr>
<tr><td><code>zkChain</code></td><td><code>address</code></td><td>The address of the ZK chain on the chain where it is migrated to.</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="contents-6"><a class="header" href="#contents-6">Contents</a></h1>
<ul>
<li><a href="contracts/l1-contracts/common//contracts/l1-contracts/common/interfaces">interfaces</a></li>
<li><a href="contracts/l1-contracts/common//contracts/l1-contracts/common/l2-helpers">l2-helpers</a></li>
<li><a href="contracts/l1-contracts/common//contracts/l1-contracts/common/libraries">libraries</a></li>
<li><a href="contracts/l1-contracts/common/Config.sol/struct.PriorityTreeCommitment.html">PriorityTreeCommitment</a></li>
<li><a href="contracts/l1-contracts/common/Config.sol/struct.ZKChainCommitment.html">ZKChainCommitment</a></li>
<li><a href="contracts/l1-contracts/common/Config.sol/constants.Config.html">Config constants</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.AccessToFallbackDenied.html">AccessToFallbackDenied</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.AccessToFunctionDenied.html">AccessToFunctionDenied</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.AddressAlreadySet.html">AddressAlreadySet</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.AddressHasNoCode.html">AddressHasNoCode</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.AddressMismatch.html">AddressMismatch</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.AlreadyPermanentRollup.html">AlreadyPermanentRollup</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.AlreadyWhitelisted.html">AlreadyWhitelisted</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.AmountMustBeGreaterThanZero.html">AmountMustBeGreaterThanZero</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.AssetHandlerDoesNotExist.html">AssetHandlerDoesNotExist</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.AssetHandlerNotRegistered.html">AssetHandlerNotRegistered</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.AssetIdAlreadyRegistered.html">AssetIdAlreadyRegistered</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.AssetIdMismatch.html">AssetIdMismatch</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.AssetIdNotSupported.html">AssetIdNotSupported</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.AssetRouterAllowanceNotZero.html">AssetRouterAllowanceNotZero</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.BaseTokenGasPriceDenominatorNotSet.html">BaseTokenGasPriceDenominatorNotSet</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.BatchHashMismatch.html">BatchHashMismatch</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.BatchNotExecuted.html">BatchNotExecuted</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.BatchNumberMismatch.html">BatchNumberMismatch</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.BridgeHubAlreadyRegistered.html">BridgeHubAlreadyRegistered</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.BridgeMintNotImplemented.html">BridgeMintNotImplemented</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.BurningNativeWETHNotSupported.html">BurningNativeWETHNotSupported</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.BytecodeAlreadyPublished.html">BytecodeAlreadyPublished</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.CallerNotTimerAdmin.html">CallerNotTimerAdmin</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.CallNotAllowed.html">CallNotAllowed</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.CanOnlyProcessOneBatch.html">CanOnlyProcessOneBatch</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.CantExecuteUnprovenBatches.html">CantExecuteUnprovenBatches</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.CantRevertExecutedBatch.html">CantRevertExecutedBatch</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.ChainAlreadyLive.html">ChainAlreadyLive</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.ChainIdAlreadyExists.html">ChainIdAlreadyExists</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.ChainIdCantBeCurrentChain.html">ChainIdCantBeCurrentChain</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.ChainIdMismatch.html">ChainIdMismatch</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.ChainIdNotRegistered.html">ChainIdNotRegistered</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.ChainIdTooBig.html">ChainIdTooBig</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.CTMAlreadyRegistered.html">CTMAlreadyRegistered</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.CTMNotRegistered.html">CTMNotRegistered</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.DeadlineNotYetPassed.html">DeadlineNotYetPassed</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.DefaultAdminTransferNotAllowed.html">DefaultAdminTransferNotAllowed</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.DelegateCallFailed.html">DelegateCallFailed</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.DenominatorIsZero.html">DenominatorIsZero</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.DeployFailed.html">DeployFailed</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.DeployingBridgedTokenForNativeToken.html">DeployingBridgedTokenForNativeToken</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.DepositDoesNotExist.html">DepositDoesNotExist</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.DepositExists.html">DepositExists</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.DiamondAlreadyFrozen.html">DiamondAlreadyFrozen</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.DiamondNotFrozen.html">DiamondNotFrozen</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.EmptyAddress.html">EmptyAddress</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.EmptyAssetId.html">EmptyAssetId</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.EmptyBytes32.html">EmptyBytes32</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.EmptyData.html">EmptyData</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.EmptyDeposit.html">EmptyDeposit</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.EmptyPrecommitData.html">EmptyPrecommitData</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.EmptyProofLength.html">EmptyProofLength</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.ETHDepositNotSupported.html">ETHDepositNotSupported</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.FacetExists.html">FacetExists</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.GasPerPubdataMismatch.html">GasPerPubdataMismatch</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.GenesisBatchCommitmentZero.html">GenesisBatchCommitmentZero</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.GenesisBatchHashZero.html">GenesisBatchHashZero</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.GenesisIndexStorageZero.html">GenesisIndexStorageZero</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.GenesisUpgradeZero.html">GenesisUpgradeZero</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.HashedLogIsDefault.html">HashedLogIsDefault</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.HashMismatch.html">HashMismatch</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.IncorrectBatchBounds.html">IncorrectBatchBounds</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.IncorrectBridgeHubAddress.html">IncorrectBridgeHubAddress</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.IncorrectTokenAddressFromNTV.html">IncorrectTokenAddressFromNTV</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.InsufficientChainBalance.html">InsufficientChainBalance</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.InvalidBatchNumber.html">InvalidBatchNumber</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.InvalidCaller.html">InvalidCaller</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.InvalidDAForPermanentRollup.html">InvalidDAForPermanentRollup</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.InvalidDelay.html">InvalidDelay</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.InvalidLogSender.html">InvalidLogSender</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.InvalidMessageRoot.html">InvalidMessageRoot</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.InvalidNTVBurnData.html">InvalidNTVBurnData</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.InvalidNumberOfBlobs.html">InvalidNumberOfBlobs</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.InvalidPackedPrecommitmentLength.html">InvalidPackedPrecommitmentLength</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.InvalidProof.html">InvalidProof</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.InvalidProofLengthForFinalNode.html">InvalidProofLengthForFinalNode</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.InvalidProtocolVersion.html">InvalidProtocolVersion</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.InvalidPubdataPricingMode.html">InvalidPubdataPricingMode</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.InvalidSelector.html">InvalidSelector</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.InvalidSystemLogsLength.html">InvalidSystemLogsLength</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.InvalidUpgradeTxn.html">InvalidUpgradeTxn</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.L2TimestampTooBig.html">L2TimestampTooBig</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.L2WithdrawalMessageWrongLength.html">L2WithdrawalMessageWrongLength</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.LegacyBridgeNotSet.html">LegacyBridgeNotSet</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.LegacyBridgeUsesNonNativeToken.html">LegacyBridgeUsesNonNativeToken</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.LegacyEncodingUsedForNonL1Token.html">LegacyEncodingUsedForNonL1Token</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.LegacyMethodForNonL1Token.html">LegacyMethodForNonL1Token</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.LengthIsNotDivisibleBy32.html">LengthIsNotDivisibleBy32</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.LogAlreadyProcessed.html">LogAlreadyProcessed</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.MalformedBytecode.html">MalformedBytecode</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.MerkleIndexOrHeightMismatch.html">MerkleIndexOrHeightMismatch</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.MerkleIndexOutOfBounds.html">MerkleIndexOutOfBounds</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.MerkleNothingToProve.html">MerkleNothingToProve</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.MerklePathEmpty.html">MerklePathEmpty</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.MerklePathLengthMismatch.html">MerklePathLengthMismatch</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.MerklePathOutOfBounds.html">MerklePathOutOfBounds</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.MerkleWrongIndex.html">MerkleWrongIndex</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.MerkleWrongLength.html">MerkleWrongLength</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.MigrationPaused.html">MigrationPaused</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.MigrationsNotPaused.html">MigrationsNotPaused</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.MissingSystemLogs.html">MissingSystemLogs</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.MsgValueMismatch.html">MsgValueMismatch</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.MsgValueTooLow.html">MsgValueTooLow</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.NewDeadlineExceedsMaxDeadline.html">NewDeadlineExceedsMaxDeadline</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.NewDeadlineNotGreaterThanCurrent.html">NewDeadlineNotGreaterThanCurrent</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.NoCallsProvided.html">NoCallsProvided</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.NoCTMForAssetId.html">NoCTMForAssetId</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.NoFunctionsForDiamondCut.html">NoFunctionsForDiamondCut</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.NoFundsTransferred.html">NoFundsTransferred</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.NoLegacySharedBridge.html">NoLegacySharedBridge</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.NonEmptyCalldata.html">NonEmptyCalldata</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.NonEmptyMsgValue.html">NonEmptyMsgValue</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.NonIncreasingTimestamp.html">NonIncreasingTimestamp</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.NonSequentialBatch.html">NonSequentialBatch</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.NonSequentialVersion.html">NonSequentialVersion</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.NotAllowed.html">NotAllowed</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.NotARestriction.html">NotARestriction</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.NotAZKChain.html">NotAZKChain</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.NotInitializedReentrancyGuard.html">NotInitializedReentrancyGuard</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.NotWhitelisted.html">NotWhitelisted</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.OnlyEraSupported.html">OnlyEraSupported</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.OnlySelfAllowed.html">OnlySelfAllowed</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.OperationExists.html">OperationExists</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.OperationMustBePending.html">OperationMustBePending</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.OperationMustBeReady.html">OperationMustBeReady</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.OriginChainIdNotFound.html">OriginChainIdNotFound</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.PrecommitmentMismatch.html">PrecommitmentMismatch</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.PreviousOperationNotExecuted.html">PreviousOperationNotExecuted</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.PriorityOperationsRollingHashMismatch.html">PriorityOperationsRollingHashMismatch</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.PriorityTxPubdataExceedsMaxPubDataPerBatch.html">PriorityTxPubdataExceedsMaxPubDataPerBatch</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.ProtocolIdMismatch.html">ProtocolIdMismatch</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.ProtocolIdNotGreater.html">ProtocolIdNotGreater</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.PubdataGreaterThanLimit.html">PubdataGreaterThanLimit</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.QueueIsEmpty.html">QueueIsEmpty</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.Reentrancy.html">Reentrancy</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.RemoveFunctionFacetAddressNotZero.html">RemoveFunctionFacetAddressNotZero</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.RemoveFunctionFacetAddressZero.html">RemoveFunctionFacetAddressZero</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.RemovingPermanentRestriction.html">RemovingPermanentRestriction</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.ReplaceFunctionFacetAddressZero.html">ReplaceFunctionFacetAddressZero</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.RestrictionWasAlreadyPresent.html">RestrictionWasAlreadyPresent</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.RestrictionWasNotPresent.html">RestrictionWasNotPresent</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.RevertedBatchNotAfterNewLastBatch.html">RevertedBatchNotAfterNewLastBatch</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.RoleAccessDenied.html">RoleAccessDenied</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.SelectorsMustAllHaveSameFreezability.html">SelectorsMustAllHaveSameFreezability</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.SettlementLayersMustSettleOnL1.html">SettlementLayersMustSettleOnL1</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.SharedBridgeNotSet.html">SharedBridgeNotSet</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.SharedBridgeValueNotSet.html">SharedBridgeValueNotSet</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.SlotOccupied.html">SlotOccupied</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.SystemLogsSizeTooBig.html">SystemLogsSizeTooBig</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.TimeNotReached.html">TimeNotReached</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.TimerAlreadyStarted.html">TimerAlreadyStarted</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.TimestampError.html">TimestampError</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.TokenIsLegacy.html">TokenIsLegacy</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.TokenNotLegacy.html">TokenNotLegacy</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.TokenNotSupported.html">TokenNotSupported</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.TokensWithFeesNotSupported.html">TokensWithFeesNotSupported</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.TooHighDeploymentNonce.html">TooHighDeploymentNonce</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.TooManyFactoryDeps.html">TooManyFactoryDeps</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.TooMuchGas.html">TooMuchGas</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.TransactionNotAllowed.html">TransactionNotAllowed</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.TxHashMismatch.html">TxHashMismatch</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.TxnBodyGasLimitNotEnoughGas.html">TxnBodyGasLimitNotEnoughGas</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.UnallowedImplementation.html">UnallowedImplementation</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.Unauthorized.html">Unauthorized</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.UndefinedDiamondCutAction.html">UndefinedDiamondCutAction</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.UnexpectedSystemLog.html">UnexpectedSystemLog</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.UnknownVerifierType.html">UnknownVerifierType</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.UnsupportedCommitBatchEncoding.html">UnsupportedCommitBatchEncoding</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.UnsupportedEncodingVersion.html">UnsupportedEncodingVersion</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.UnsupportedExecuteBatchEncoding.html">UnsupportedExecuteBatchEncoding</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.UnsupportedProofBatchEncoding.html">UnsupportedProofBatchEncoding</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.UpgradeBatchNumberIsNotZero.html">UpgradeBatchNumberIsNotZero</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.ValidateTxnNotEnoughGas.html">ValidateTxnNotEnoughGas</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.ValueMismatch.html">ValueMismatch</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.VerifiedBatchesExceedsCommittedBatches.html">VerifiedBatchesExceedsCommittedBatches</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.WithdrawalAlreadyFinalized.html">WithdrawalAlreadyFinalized</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.WithdrawFailed.html">WithdrawFailed</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.WrappedBaseTokenAlreadyRegistered.html">WrappedBaseTokenAlreadyRegistered</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.WrongMagicValue.html">WrongMagicValue</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.ZeroAddress.html">ZeroAddress</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.ZeroChainId.html">ZeroChainId</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/error.ZKChainLimitReached.html">ZKChainLimitReached</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/enum.SharedBridgeKey.html">SharedBridgeKey</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/enum.BytecodeError.html">BytecodeError</a></li>
<li><a href="contracts/l1-contracts/common/L1ContractErrors.sol/enum.UpgradeTxVerifyParam.html">UpgradeTxVerifyParam</a></li>
<li><a href="contracts/l1-contracts/common/Messaging.sol/enum.TxStatus.html">TxStatus</a></li>
<li><a href="contracts/l1-contracts/common/Messaging.sol/struct.L2Log.html">L2Log</a></li>
<li><a href="contracts/l1-contracts/common/Messaging.sol/struct.L2Message.html">L2Message</a></li>
<li><a href="contracts/l1-contracts/common/Messaging.sol/struct.WritePriorityOpParams.html">WritePriorityOpParams</a></li>
<li><a href="contracts/l1-contracts/common/Messaging.sol/struct.L2CanonicalTransaction.html">L2CanonicalTransaction</a></li>
<li><a href="contracts/l1-contracts/common/Messaging.sol/struct.BridgehubL2TransactionRequest.html">BridgehubL2TransactionRequest</a></li>
<li><a href="contracts/l1-contracts/common/Messaging.sol/struct.InteropRoot.html">InteropRoot</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="il2contractdeployer"><a class="header" href="#il2contractdeployer">IL2ContractDeployer</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/l1-contracts/common/interfaces/IL2ContractDeployer.sol">Git Source</a></p>
<p><strong>Author:</strong>
Matter Labs</p>
<p>System smart contract that is responsible for deploying other smart contracts on a ZK chain.</p>
<h2 id="functions-21"><a class="header" href="#functions-21">Functions</a></h2>
<h3 id="allowedbytecodetypestodeploy"><a class="header" href="#allowedbytecodetypestodeploy">allowedBytecodeTypesToDeploy</a></h3>
<p>Returns what types of bytecode are allowed to be deployed on this chain</p>
<pre><code class="language-solidity">function allowedBytecodeTypesToDeploy()
  external
  view
  returns (AllowedBytecodeTypes mode);
</code></pre>
<h3 id="forcedeployonaddresses"><a class="header" href="#forcedeployonaddresses">forceDeployOnAddresses</a></h3>
<p>This method is to be used only during an upgrade to set bytecodes on specific addresses.</p>
<pre><code class="language-solidity">function forceDeployOnAddresses(ForceDeployment[] calldata _deployParams)
  external;
</code></pre>
<h3 id="create2"><a class="header" href="#create2">create2</a></h3>
<p>Deploys a contract with similar address derivation rules to the EVM's <code>CREATE2</code> opcode.</p>
<pre><code class="language-solidity">function create2(bytes32 _salt, bytes32 _bytecodeHash, bytes calldata _input)
  external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_salt</code></td><td><code>bytes32</code></td><td>The create2 salt.</td></tr>
<tr><td><code>_bytecodeHash</code></td><td><code>bytes32</code></td><td>The correctly formatted hash of the bytecode.</td></tr>
<tr><td><code>_input</code></td><td><code>bytes</code></td><td>The constructor calldata.</td></tr>
</tbody></table>
</div>
<h3 id="setallowedbytecodetypestodeploy"><a class="header" href="#setallowedbytecodetypestodeploy">setAllowedBytecodeTypesToDeploy</a></h3>
<p>Changes what types of bytecodes are allowed to be deployed on the chain.</p>
<pre><code class="language-solidity">function setAllowedBytecodeTypesToDeploy(AllowedBytecodeTypes newAllowedBytecodeTypes)
  external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>newAllowedBytecodeTypes</code></td><td><code>AllowedBytecodeTypes</code></td><td>The new allowed bytecode types mode.</td></tr>
</tbody></table>
</div>
<h2 id="structs"><a class="header" href="#structs">Structs</a></h2>
<h3 id="forcedeployment"><a class="header" href="#forcedeployment">ForceDeployment</a></h3>
<p>A struct that describes a forced deployment on an address.</p>
<pre><code class="language-solidity">struct ForceDeployment {
  bytes32 bytecodeHash;
  address newAddress;
  bool callConstructor;
  uint256 value;
  bytes input;
}
</code></pre>
<p><strong>Properties</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>bytecodeHash</code></td><td><code>bytes32</code></td><td>The bytecode hash to put on an address.</td></tr>
<tr><td><code>newAddress</code></td><td><code>address</code></td><td>The address on which to deploy the bytecodehash to.</td></tr>
<tr><td><code>callConstructor</code></td><td><code>bool</code></td><td>Whether to run the constructor on the force deployment.</td></tr>
<tr><td><code>value</code></td><td><code>uint256</code></td><td>The <code>msg.value</code> with which to initialize a contract.</td></tr>
<tr><td><code>input</code></td><td><code>bytes</code></td><td>The constructor calldata.</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="il2interoprootstorage"><a class="header" href="#il2interoprootstorage">IL2InteropRootStorage</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/l1-contracts/common/interfaces/IL2InteropRootStorage.sol">Git Source</a></p>
<p><strong>Author:</strong>
Matter Labs</p>
<p>The interface of the L2 InteropRootStorage contract,
responsible for storing the message roots of other chains on the L2.</p>
<p><strong>Note:</strong>
security-contact: security@matterlabs.dev</p>
<h2 id="functions-22"><a class="header" href="#functions-22">Functions</a></h2>
<h3 id="interoproots"><a class="header" href="#interoproots">interopRoots</a></h3>
<p>Mapping of chain ID to block or batch number to message root.</p>
<pre><code class="language-solidity">function interopRoots(uint256 chainId, uint256 blockOrBatchNumber)
  external
  view
  returns (bytes32);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="iownable"><a class="header" href="#iownable">IOwnable</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/l1-contracts/common/interfaces/IOwnable.sol">Git Source</a></p>
<p><strong>Author:</strong>
Matter Labs</p>
<p><strong>Note:</strong>
security-contact: security@matterlabs.dev</p>
<h2 id="functions-23"><a class="header" href="#functions-23">Functions</a></h2>
<h3 id="owner"><a class="header" href="#owner">owner</a></h3>
<pre><code class="language-solidity">function owner() external view returns (address);
</code></pre>
<h3 id="transferownership"><a class="header" href="#transferownership">transferOwnership</a></h3>
<pre><code class="language-solidity">function transferOwnership(address newOwner) external;
</code></pre>
<h3 id="pendingowner"><a class="header" href="#pendingowner">pendingOwner</a></h3>
<pre><code class="language-solidity">function pendingOwner() external view returns (address);
</code></pre>
<h3 id="acceptownership"><a class="header" href="#acceptownership">acceptOwnership</a></h3>
<pre><code class="language-solidity">function acceptOwnership() external;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="l2helpers"><a class="header" href="#l2helpers">L2Helpers</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="il2tol1messenger"><a class="header" href="#il2tol1messenger">IL2ToL1Messenger</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/l1-contracts/common/l2-helpers/IL2ToL1Messenger.sol">Git Source</a></p>
<p><strong>Author:</strong>
Matter Labs</p>
<p>The interface of the L1 Messenger contract, responsible for sending messages to L1.</p>
<p>by default ZkSync can send fixed-length messages on L1.
A fixed length message has 4 parameters <code>senderAddress</code>, <code>isService</code>, <code>key</code>, <code>value</code>,
the first one is taken from the context, the other three are chosen by the sender.</p>
<p>To send a variable-length message we use this trick:</p>
<ul>
<li>This system contract accepts an arbitrary length message and sends a fixed length message with
parameters <code>senderAddress == this</code>, <code>isService == true</code>, <code>key == msg.sender</code>, <code>value == keccak256(message)</code>.</li>
<li>The contract on L1 accepts all sent messages and if the message came from this system contract
it requires the preimage of <code>value</code> to be provided.</li>
</ul>
<p><strong>Note:</strong>
security-contact: security@matterlabs.dev</p>
<h2 id="functions-24"><a class="header" href="#functions-24">Functions</a></h2>
<h3 id="sendtol1"><a class="header" href="#sendtol1">sendToL1</a></h3>
<p>Sends an arbitrary length message to L1.</p>
<pre><code class="language-solidity">function sendToL1(bytes calldata _message) external returns (bytes32);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_message</code></td><td><code>bytes</code></td><td>The variable length message to be sent to L1.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>bytes32</code></td><td>Returns the keccak256 hashed value of the message.</td></tr>
</tbody></table>
</div>
<h3 id="sendl2tol1log"><a class="header" href="#sendl2tol1log">sendL2ToL1Log</a></h3>
<p>Sends L2ToL1Log.</p>
<p>Can be called only by a system contract.</p>
<pre><code class="language-solidity">function sendL2ToL1Log(bool _isService, bytes32 _key, bytes32 _value)
  external
  returns (uint256 logIdInMerkleTree);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_isService</code></td><td><code>bool</code></td><td>The <code>isService</code> flag.</td></tr>
<tr><td><code>_key</code></td><td><code>bytes32</code></td><td>The <code>key</code> part of the L2Log.</td></tr>
<tr><td><code>_value</code></td><td><code>bytes32</code></td><td>The <code>value</code> part of the L2Log.</td></tr>
</tbody></table>
</div>
<h3 id="requestbytecodel1publication"><a class="header" href="#requestbytecodel1publication">requestBytecodeL1Publication</a></h3>
<p>This function is expected to be called only by the KnownCodesStorage system contract</p>
<pre><code class="language-solidity">function requestBytecodeL1Publication(bytes32 _bytecodeHash) external;
</code></pre>
<h2 id="events-15"><a class="header" href="#events-15">Events</a></h2>
<h3 id="l1messagesent"><a class="header" href="#l1messagesent">L1MessageSent</a></h3>
<pre><code class="language-solidity">event L1MessageSent(
  address indexed _sender, bytes32 indexed _hash, bytes _message
);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="l2contractaddresses"><a class="header" href="#l2contractaddresses">L2ContractAddresses</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="l2contracthelper"><a class="header" href="#l2contracthelper">L2ContractHelper</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/l1-contracts/common/l2-helpers/L2ContractHelper.sol">Git Source</a></p>
<p><strong>Author:</strong>
Matter Labs</p>
<p>Helper library for working with L2 contracts on L1.</p>
<p><strong>Note:</strong>
security-contact: security@matterlabs.dev</p>
<h2 id="state-variables"><a class="header" href="#state-variables">State Variables</a></h2>
<h3 id="create2_prefix"><a class="header" href="#create2_prefix">CREATE2_PREFIX</a></h3>
<p>The prefix used to create CREATE2 addresses.</p>
<pre><code class="language-solidity">bytes32 private constant CREATE2_PREFIX = keccak256("zksyncCreate2")
</code></pre>
<h3 id="create_prefix"><a class="header" href="#create_prefix">CREATE_PREFIX</a></h3>
<p>Prefix used during derivation of account addresses using CREATE</p>
<p>keccak256("zksyncCreate")</p>
<pre><code class="language-solidity">bytes32 private constant CREATE_PREFIX =
  0x63bae3a9951d38e8a3fbb7b70909afc1200610fc5bc55ade242f815974674f23
</code></pre>
<h2 id="functions-25"><a class="header" href="#functions-25">Functions</a></h2>
<h3 id="sendmessagetol1-1"><a class="header" href="#sendmessagetol1-1">sendMessageToL1</a></h3>
<p>Sends L2 -&gt; L1 arbitrary-long message through the system contract messenger.</p>
<pre><code class="language-solidity">function sendMessageToL1(bytes memory _message) internal returns (bytes32);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_message</code></td><td><code>bytes</code></td><td>Data to be sent to L1.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>bytes32</code></td><td>keccak256 hash of the sent message.</td></tr>
</tbody></table>
</div>
<h3 id="hashl2bytecode"><a class="header" href="#hashl2bytecode">hashL2Bytecode</a></h3>
<p>Validate the bytecode format and calculate its hash.</p>
<pre><code class="language-solidity">function hashL2Bytecode(bytes memory _bytecode)
  internal
  pure
  returns (bytes32 hashedBytecode);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_bytecode</code></td><td><code>bytes</code></td><td>The bytecode to hash.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>hashedBytecode</code></td><td><code>bytes32</code></td><td>The 32-byte hash of the bytecode. Note: The function reverts the execution if the bytecode has non expected format: - Bytecode bytes length is not a multiple of 32 - Bytecode bytes length is not less than 2^21 bytes (2^16 words) - Bytecode words length is not odd</td></tr>
</tbody></table>
</div>
<h3 id="hashl2bytecodecalldata"><a class="header" href="#hashl2bytecodecalldata">hashL2BytecodeCalldata</a></h3>
<p>Validate the bytecode format and calculate its hash.</p>
<pre><code class="language-solidity">function hashL2BytecodeCalldata(bytes calldata _bytecode)
  internal
  pure
  returns (bytes32 hashedBytecode);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_bytecode</code></td><td><code>bytes</code></td><td>The bytecode to hash.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>hashedBytecode</code></td><td><code>bytes32</code></td><td>The 32-byte hash of the bytecode. Note: The function reverts the execution if the bytecode has non expected format: - Bytecode bytes length is not a multiple of 32 - Bytecode bytes length is not less than 2^21 bytes (2^16 words) - Bytecode words length is not odd</td></tr>
</tbody></table>
</div>
<h3 id="validatebytecodehash"><a class="header" href="#validatebytecodehash">validateBytecodeHash</a></h3>
<p>Validates the format of the given bytecode hash.</p>
<p>Due to the specification of the L2 bytecode hash, not every 32 bytes could be a legit bytecode hash.</p>
<p>The function reverts on invalid bytecode hash format.</p>
<pre><code class="language-solidity">function validateBytecodeHash(bytes32 _bytecodeHash) internal pure;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_bytecodeHash</code></td><td><code>bytes32</code></td><td>The hash of the bytecode to validate.</td></tr>
</tbody></table>
</div>
<h3 id="bytecodelen"><a class="header" href="#bytecodelen">bytecodeLen</a></h3>
<p>Returns the length of the bytecode associated with the given hash.</p>
<pre><code class="language-solidity">function bytecodeLen(bytes32 _bytecodeHash)
  internal
  pure
  returns (uint256 codeLengthInWords);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_bytecodeHash</code></td><td><code>bytes32</code></td><td>The hash of the bytecode.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>codeLengthInWords</code></td><td><code>uint256</code></td><td>The length of the bytecode in words.</td></tr>
</tbody></table>
</div>
<h3 id="computecreate2address"><a class="header" href="#computecreate2address">computeCreate2Address</a></h3>
<p>Computes the create2 address for a Layer 2 contract.</p>
<pre><code class="language-solidity">function computeCreate2Address(
  address _sender,
  bytes32 _salt,
  bytes32 _bytecodeHash,
  bytes32 _constructorInputHash
) internal pure returns (address);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_sender</code></td><td><code>address</code></td><td>The address of the sender.</td></tr>
<tr><td><code>_salt</code></td><td><code>bytes32</code></td><td>The salt value to use in the create2 address computation.</td></tr>
<tr><td><code>_bytecodeHash</code></td><td><code>bytes32</code></td><td>The contract bytecode hash.</td></tr>
<tr><td><code>_constructorInputHash</code></td><td><code>bytes32</code></td><td>The hash of the constructor input data.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>address</code></td><td>The create2 address of the contract. NOTE: L2 create2 derivation is different from L1 derivation!</td></tr>
</tbody></table>
</div>
<h3 id="computecreateaddress"><a class="header" href="#computecreateaddress">computeCreateAddress</a></h3>
<p>Calculates the address of a deployed contract via create</p>
<pre><code class="language-solidity">function computeCreateAddress(address _sender, uint256 _senderNonce)
  internal
  pure
  returns (address);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_sender</code></td><td><code>address</code></td><td>The account that deploys the contract.</td></tr>
<tr><td><code>_senderNonce</code></td><td><code>uint256</code></td><td>The deploy nonce of the sender's account. NOTE: L2 create derivation is different from L1 derivation!</td></tr>
</tbody></table>
</div>
<h3 id="hashfactorydeps"><a class="header" href="#hashfactorydeps">hashFactoryDeps</a></h3>
<p>Hashes the L2 bytecodes and returns them in the format in which they are processed by the bootloader</p>
<pre><code class="language-solidity">function hashFactoryDeps(bytes[] memory _factoryDeps)
  internal
  pure
  returns (uint256[] memory hashedFactoryDeps);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="contents-7"><a class="header" href="#contents-7">Contents</a></h1>
<ul>
<li><a href="contracts/l1-contracts/governance//contracts/l1-contracts/governance/restriction">restriction</a></li>
<li><a href="contracts/l1-contracts/governance/Common.sol/struct.Call.html">Call</a></li>
<li><a href="contracts/l1-contracts/governance/IAccessControlRestriction.sol/interface.IAccessControlRestriction.html">IAccessControlRestriction</a></li>
<li><a href="contracts/l1-contracts/governance/IChainAdmin.sol/interface.IChainAdmin.html">IChainAdmin</a></li>
<li><a href="contracts/l1-contracts/governance/IChainAdminOwnable.sol/interface.IChainAdminOwnable.html">IChainAdminOwnable</a></li>
<li><a href="contracts/l1-contracts/governance/IGovernance.sol/interface.IGovernance.html">IGovernance</a></li>
<li><a href="contracts/l1-contracts/governance/IPermanentRestriction.sol/interface.IPermanentRestriction.html">IPermanentRestriction</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="contents-8"><a class="header" href="#contents-8">Contents</a></h1>
<ul>
<li><a href="contracts/l1-contracts/governance/restriction/IRestriction.sol/interface.IRestriction.html">IRestriction</a></li>
<li><a href="contracts/l1-contracts/governance/restriction/IRestriction.sol/constants.IRestriction.html">IRestriction constants</a></li>
<li><a href="contracts/l1-contracts/governance/restriction/RestrictionValidator.sol/library.RestrictionValidator.html">RestrictionValidator</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="irestriction"><a class="header" href="#irestriction">IRestriction</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/l1-contracts/governance/restriction/IRestriction.sol">Git Source</a></p>
<p><strong>Title:</strong>
Restriction contract interface</p>
<p><strong>Author:</strong>
Matter Labs</p>
<p><strong>Note:</strong>
security-contact: security@matterlabs.dev</p>
<h2 id="functions-26"><a class="header" href="#functions-26">Functions</a></h2>
<h3 id="getsupportsrestrictionmagic"><a class="header" href="#getsupportsrestrictionmagic">getSupportsRestrictionMagic</a></h3>
<p>A method used to check that the contract supports this interface.</p>
<pre><code class="language-solidity">function getSupportsRestrictionMagic() external view returns (bytes32);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>bytes32</code></td><td>Returns the <code>RESTRICTION_MAGIC</code></td></tr>
</tbody></table>
</div>
<h3 id="validatecall"><a class="header" href="#validatecall">validateCall</a></h3>
<p>Ensures that the invoker has the required role to call the function.</p>
<pre><code class="language-solidity">function validateCall(Call calldata _call, address _invoker) external view;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_call</code></td><td><code>Call</code></td><td>The call data.</td></tr>
<tr><td><code>_invoker</code></td><td><code>address</code></td><td>The address of the invoker.</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="constants-1"><a class="header" href="#constants-1">Constants</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/l1-contracts/governance/restriction/IRestriction.sol">Git Source</a></p>
<h3 id="restriction_magic"><a class="header" href="#restriction_magic">RESTRICTION_MAGIC</a></h3>
<p>The magic value that has to be returned by the <code>getSupportsRestrictionMagic</code></p>
<pre><code class="language-solidity">bytes32 constant RESTRICTION_MAGIC = keccak256("Restriction")
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="iaccesscontrolrestriction"><a class="header" href="#iaccesscontrolrestriction">IAccessControlRestriction</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/l1-contracts/governance/IAccessControlRestriction.sol">Git Source</a></p>
<p><strong>Title:</strong>
AccessControlRestriction contract interface</p>
<p><strong>Author:</strong>
Matter Labs</p>
<p><strong>Note:</strong>
security-contact: security@matterlabs.dev</p>
<h2 id="events-16"><a class="header" href="#events-16">Events</a></h2>
<h3 id="roleset"><a class="header" href="#roleset">RoleSet</a></h3>
<p>Emitted when the required role for a specific function is set.</p>
<pre><code class="language-solidity">event RoleSet(
  address indexed target, bytes4 indexed selector, bytes32 requiredRole
);
</code></pre>
<h3 id="fallbackroleset"><a class="header" href="#fallbackroleset">FallbackRoleSet</a></h3>
<p>Emitted when the required role for a fallback function is set.</p>
<pre><code class="language-solidity">event FallbackRoleSet(address indexed target, bytes32 requiredRole);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="ichainadmin"><a class="header" href="#ichainadmin">IChainAdmin</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/l1-contracts/governance/IChainAdmin.sol">Git Source</a></p>
<p><strong>Title:</strong>
ChainAdmin contract interface</p>
<p><strong>Author:</strong>
Matter Labs</p>
<p><strong>Note:</strong>
security-contact: security@matterlabs.dev</p>
<h2 id="functions-27"><a class="header" href="#functions-27">Functions</a></h2>
<h3 id="getrestrictions"><a class="header" href="#getrestrictions">getRestrictions</a></h3>
<p>Returns the list of active restrictions.</p>
<pre><code class="language-solidity">function getRestrictions() external view returns (address[] memory);
</code></pre>
<h3 id="isrestrictionactive"><a class="header" href="#isrestrictionactive">isRestrictionActive</a></h3>
<p>Checks if the restriction is active.</p>
<pre><code class="language-solidity">function isRestrictionActive(address _restriction)
  external
  view
  returns (bool);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_restriction</code></td><td><code>address</code></td><td>The address of the restriction contract.</td></tr>
</tbody></table>
</div>
<h3 id="addrestriction"><a class="header" href="#addrestriction">addRestriction</a></h3>
<p>Adds a new restriction to the active restrictions set.</p>
<pre><code class="language-solidity">function addRestriction(address _restriction) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_restriction</code></td><td><code>address</code></td><td>The address of the restriction contract.</td></tr>
</tbody></table>
</div>
<h3 id="removerestriction"><a class="header" href="#removerestriction">removeRestriction</a></h3>
<p>Removes a restriction from the active restrictions set.</p>
<p>Sometimes restrictions might need to enforce their permanence (e.g. if a chain should be a rollup forever).</p>
<pre><code class="language-solidity">function removeRestriction(address _restriction) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_restriction</code></td><td><code>address</code></td><td>The address of the restriction contract.</td></tr>
</tbody></table>
</div>
<h3 id="multicall"><a class="header" href="#multicall">multicall</a></h3>
<p>Execute multiple calls as part of contract administration.</p>
<p>Intended for batch processing of contract interactions, managing gas efficiency and atomicity of operations.</p>
<p>Note, that this function lacks access control. It is expected that the access control is implemented in a separate restriction contract.</p>
<p>Even though all the validation from external modules is executed via <code>staticcall</code>, the function
is marked as <code>nonReentrant</code> to prevent reentrancy attacks in case the staticcall restriction is lifted in the future.</p>
<pre><code class="language-solidity">function multicall(Call[] calldata _calls, bool _requireSuccess)
  external
  payable;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_calls</code></td><td><code>Call[]</code></td><td>Array of Call structures defining target, value, and data for each call.</td></tr>
<tr><td><code>_requireSuccess</code></td><td><code>bool</code></td><td>If true, reverts transaction on any call failure.</td></tr>
</tbody></table>
</div>
<h2 id="events-17"><a class="header" href="#events-17">Events</a></h2>
<h3 id="updateupgradetimestamp"><a class="header" href="#updateupgradetimestamp">UpdateUpgradeTimestamp</a></h3>
<p>Emitted when the expected upgrade timestamp for a specific protocol version is set.</p>
<pre><code class="language-solidity">event UpdateUpgradeTimestamp(
  uint256 indexed protocolVersion, uint256 upgradeTimestamp
);
</code></pre>
<h3 id="callexecuted"><a class="header" href="#callexecuted">CallExecuted</a></h3>
<p>Emitted when the call is executed from the contract.</p>
<pre><code class="language-solidity">event CallExecuted(Call call, bool success, bytes returnData);
</code></pre>
<h3 id="restrictionadded"><a class="header" href="#restrictionadded">RestrictionAdded</a></h3>
<p>Emitted when a new restriction is added.</p>
<pre><code class="language-solidity">event RestrictionAdded(address indexed restriction);
</code></pre>
<h3 id="restrictionremoved"><a class="header" href="#restrictionremoved">RestrictionRemoved</a></h3>
<p>Emitted when a restriction is removed.</p>
<pre><code class="language-solidity">event RestrictionRemoved(address indexed restriction);
</code></pre>
<h3 id="enableevmemulator"><a class="header" href="#enableevmemulator">EnableEvmEmulator</a></h3>
<p>The EVM emulator has been enabled</p>
<pre><code class="language-solidity">event EnableEvmEmulator();
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="ichainadminownable"><a class="header" href="#ichainadminownable">IChainAdminOwnable</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/l1-contracts/governance/IChainAdminOwnable.sol">Git Source</a></p>
<p><strong>Title:</strong>
ChainAdmin contract interface</p>
<p><strong>Author:</strong>
Matter Labs</p>
<p><strong>Note:</strong>
security-contact: security@matterlabs.dev</p>
<h2 id="functions-28"><a class="header" href="#functions-28">Functions</a></h2>
<h3 id="settokenmultipliersetter"><a class="header" href="#settokenmultipliersetter">setTokenMultiplierSetter</a></h3>
<pre><code class="language-solidity">function setTokenMultiplierSetter(address _tokenMultiplierSetter) external;
</code></pre>
<h3 id="setupgradetimestamp"><a class="header" href="#setupgradetimestamp">setUpgradeTimestamp</a></h3>
<pre><code class="language-solidity">function setUpgradeTimestamp(
  uint256 _protocolVersion,
  uint256 _upgradeTimestamp
) external;
</code></pre>
<h3 id="multicall-1"><a class="header" href="#multicall-1">multicall</a></h3>
<pre><code class="language-solidity">function multicall(Call[] calldata _calls, bool _requireSuccess)
  external
  payable;
</code></pre>
<h3 id="settokenmultiplier"><a class="header" href="#settokenmultiplier">setTokenMultiplier</a></h3>
<pre><code class="language-solidity">function setTokenMultiplier(
  IAdmin _chainContract,
  uint128 _nominator,
  uint128 _denominator
) external;
</code></pre>
<h2 id="events-18"><a class="header" href="#events-18">Events</a></h2>
<h3 id="updateupgradetimestamp-1"><a class="header" href="#updateupgradetimestamp-1">UpdateUpgradeTimestamp</a></h3>
<p>Emitted when the expected upgrade timestamp for a specific protocol version is set.</p>
<pre><code class="language-solidity">event UpdateUpgradeTimestamp(
  uint256 indexed _protocolVersion, uint256 _upgradeTimestamp
);
</code></pre>
<h3 id="callexecuted-1"><a class="header" href="#callexecuted-1">CallExecuted</a></h3>
<p>Emitted when the call is executed from the contract.</p>
<pre><code class="language-solidity">event CallExecuted(Call _call, bool _success, bytes _returnData);
</code></pre>
<h3 id="newtokenmultipliersetter"><a class="header" href="#newtokenmultipliersetter">NewTokenMultiplierSetter</a></h3>
<p>Emitted when the new token multiplier address is set.</p>
<pre><code class="language-solidity">event NewTokenMultiplierSetter(
  address _oldTokenMultiplierSetter, address _newTokenMultiplierSetter
);
</code></pre>
<h2 id="structs-1"><a class="header" href="#structs-1">Structs</a></h2>
<h3 id="call"><a class="header" href="#call">Call</a></h3>
<p>Represents a call to be made during multicall.</p>
<pre><code class="language-solidity">struct Call {
  address target;
  uint256 value;
  bytes data;
}
</code></pre>
<p><strong>Properties</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>target</code></td><td><code>address</code></td><td>The address to which the call will be made.</td></tr>
<tr><td><code>value</code></td><td><code>uint256</code></td><td>The amount of Ether (in wei) to be sent along with the call.</td></tr>
<tr><td><code>data</code></td><td><code>bytes</code></td><td>The calldata to be executed on the <code>target</code> address.</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="igovernance"><a class="header" href="#igovernance">IGovernance</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/l1-contracts/governance/IGovernance.sol">Git Source</a></p>
<p><strong>Title:</strong>
Governance contract interface</p>
<p><strong>Author:</strong>
Matter Labs</p>
<p><strong>Note:</strong>
security-contact: security@matterlabs.dev</p>
<h2 id="functions-29"><a class="header" href="#functions-29">Functions</a></h2>
<h3 id="isoperation"><a class="header" href="#isoperation">isOperation</a></h3>
<pre><code class="language-solidity">function isOperation(bytes32 _id) external view returns (bool);
</code></pre>
<h3 id="isoperationpending"><a class="header" href="#isoperationpending">isOperationPending</a></h3>
<pre><code class="language-solidity">function isOperationPending(bytes32 _id) external view returns (bool);
</code></pre>
<h3 id="isoperationready"><a class="header" href="#isoperationready">isOperationReady</a></h3>
<pre><code class="language-solidity">function isOperationReady(bytes32 _id) external view returns (bool);
</code></pre>
<h3 id="isoperationdone"><a class="header" href="#isoperationdone">isOperationDone</a></h3>
<pre><code class="language-solidity">function isOperationDone(bytes32 _id) external view returns (bool);
</code></pre>
<h3 id="getoperationstate"><a class="header" href="#getoperationstate">getOperationState</a></h3>
<pre><code class="language-solidity">function getOperationState(bytes32 _id) external view returns (OperationState);
</code></pre>
<h3 id="scheduletransparent"><a class="header" href="#scheduletransparent">scheduleTransparent</a></h3>
<pre><code class="language-solidity">function scheduleTransparent(Operation calldata _operation, uint256 _delay)
  external;
</code></pre>
<h3 id="scheduleshadow"><a class="header" href="#scheduleshadow">scheduleShadow</a></h3>
<pre><code class="language-solidity">function scheduleShadow(bytes32 _id, uint256 _delay) external;
</code></pre>
<h3 id="cancel"><a class="header" href="#cancel">cancel</a></h3>
<pre><code class="language-solidity">function cancel(bytes32 _id) external;
</code></pre>
<h3 id="execute"><a class="header" href="#execute">execute</a></h3>
<pre><code class="language-solidity">function execute(Operation calldata _operation) external payable;
</code></pre>
<h3 id="executeinstant"><a class="header" href="#executeinstant">executeInstant</a></h3>
<pre><code class="language-solidity">function executeInstant(Operation calldata _operation) external payable;
</code></pre>
<h3 id="hashoperation"><a class="header" href="#hashoperation">hashOperation</a></h3>
<pre><code class="language-solidity">function hashOperation(Operation calldata _operation)
  external
  pure
  returns (bytes32);
</code></pre>
<h3 id="updatedelay"><a class="header" href="#updatedelay">updateDelay</a></h3>
<pre><code class="language-solidity">function updateDelay(uint256 _newDelay) external;
</code></pre>
<h3 id="updatesecuritycouncil"><a class="header" href="#updatesecuritycouncil">updateSecurityCouncil</a></h3>
<pre><code class="language-solidity">function updateSecurityCouncil(address _newSecurityCouncil) external;
</code></pre>
<h2 id="events-19"><a class="header" href="#events-19">Events</a></h2>
<h3 id="transparentoperationscheduled"><a class="header" href="#transparentoperationscheduled">TransparentOperationScheduled</a></h3>
<p>Emitted when transparent operation is scheduled.</p>
<pre><code class="language-solidity">event TransparentOperationScheduled(
  bytes32 indexed _id, uint256 delay, Operation _operation
);
</code></pre>
<h3 id="shadowoperationscheduled"><a class="header" href="#shadowoperationscheduled">ShadowOperationScheduled</a></h3>
<p>Emitted when shadow operation is scheduled.</p>
<pre><code class="language-solidity">event ShadowOperationScheduled(bytes32 indexed _id, uint256 delay);
</code></pre>
<h3 id="operationexecuted"><a class="header" href="#operationexecuted">OperationExecuted</a></h3>
<p>Emitted when the operation is executed with delay or instantly.</p>
<pre><code class="language-solidity">event OperationExecuted(bytes32 indexed _id);
</code></pre>
<h3 id="changesecuritycouncil"><a class="header" href="#changesecuritycouncil">ChangeSecurityCouncil</a></h3>
<p>Emitted when the security council address is changed.</p>
<pre><code class="language-solidity">event ChangeSecurityCouncil(
  address _securityCouncilBefore, address _securityCouncilAfter
);
</code></pre>
<h3 id="changemindelay"><a class="header" href="#changemindelay">ChangeMinDelay</a></h3>
<p>Emitted when the minimum delay for future operations is modified.</p>
<pre><code class="language-solidity">event ChangeMinDelay(uint256 _delayBefore, uint256 _delayAfter);
</code></pre>
<h3 id="operationcancelled"><a class="header" href="#operationcancelled">OperationCancelled</a></h3>
<p>Emitted when the operation with specified id is cancelled.</p>
<pre><code class="language-solidity">event OperationCancelled(bytes32 indexed _id);
</code></pre>
<h2 id="structs-2"><a class="header" href="#structs-2">Structs</a></h2>
<h3 id="operation"><a class="header" href="#operation">Operation</a></h3>
<p>Defines the structure of an operation that Governance executes.</p>
<pre><code class="language-solidity">struct Operation {
  Call[] calls;
  bytes32 predecessor;
  bytes32 salt;
}
</code></pre>
<p><strong>Properties</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>calls</code></td><td><code>Call[]</code></td><td>An array of <code>Call</code> structs, each representing a call to be made during the operation.</td></tr>
<tr><td><code>predecessor</code></td><td><code>bytes32</code></td><td>The hash of the predecessor operation, that should be executed before this operation.</td></tr>
<tr><td><code>salt</code></td><td><code>bytes32</code></td><td>A bytes32 value used for creating unique operation hashes.</td></tr>
</tbody></table>
</div>
<h2 id="enums"><a class="header" href="#enums">Enums</a></h2>
<h3 id="operationstate"><a class="header" href="#operationstate">OperationState</a></h3>
<p>This enumeration includes the following states:</p>
<pre><code class="language-solidity">enum OperationState {
  Unset,
  Waiting,
  Ready,
  Done
}
</code></pre>
<p><strong>Variants</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Description</th></tr></thead><tbody>
<tr><td><code>Unset</code></td><td>Default state, indicating the operation has not been set.</td></tr>
<tr><td><code>Waiting</code></td><td>The operation is scheduled but not yet ready to be executed.</td></tr>
<tr><td><code>Ready</code></td><td>The operation is ready to be executed.</td></tr>
<tr><td><code>Done</code></td><td>The operation has been successfully executed.</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="ipermanentrestriction"><a class="header" href="#ipermanentrestriction">IPermanentRestriction</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/l1-contracts/governance/IPermanentRestriction.sol">Git Source</a></p>
<p><strong>Author:</strong>
Matter Labs</p>
<p>The interface for the permanent restriction contract.</p>
<p><strong>Note:</strong>
security-contact: security@matterlabs.dev</p>
<h2 id="events-20"><a class="header" href="#events-20">Events</a></h2>
<h3 id="adminimplementationallowed"><a class="header" href="#adminimplementationallowed">AdminImplementationAllowed</a></h3>
<p>Emitted when the implementation is allowed or disallowed.</p>
<pre><code class="language-solidity">event AdminImplementationAllowed(
  bytes32 indexed implementationHash, bool isAllowed
);
</code></pre>
<h3 id="alloweddatachanged"><a class="header" href="#alloweddatachanged">AllowedDataChanged</a></h3>
<p>Emitted when a certain calldata is allowed or disallowed.</p>
<pre><code class="language-solidity">event AllowedDataChanged(bytes data, bool isAllowed);
</code></pre>
<h3 id="selectorvalidationchanged"><a class="header" href="#selectorvalidationchanged">SelectorValidationChanged</a></h3>
<p>Emitted when the selector is labeled as validated or not.</p>
<pre><code class="language-solidity">event SelectorValidationChanged(bytes4 indexed selector, bool isValidated);
</code></pre>
<h3 id="allowl2admin"><a class="header" href="#allowl2admin">AllowL2Admin</a></h3>
<p>Emitted when the L2 admin is whitelisted or not.</p>
<pre><code class="language-solidity">event AllowL2Admin(address indexed adminAddress);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="contents-9"><a class="header" href="#contents-9">Contents</a></h1>
<ul>
<li><a href="contracts/l1-contracts/state-transition//contracts/l1-contracts/state-transition/chain-deps">chain-deps</a></li>
<li><a href="contracts/l1-contracts/state-transition//contracts/l1-contracts/state-transition/chain-interfaces">chain-interfaces</a></li>
<li><a href="contracts/l1-contracts/state-transition//contracts/l1-contracts/state-transition/l2-deps">l2-deps</a></li>
<li><a href="contracts/l1-contracts/state-transition//contracts/l1-contracts/state-transition/libraries">libraries</a></li>
<li><a href="contracts/l1-contracts/state-transition/IChainTypeManager.sol/struct.ChainTypeManagerInitializeData.html">ChainTypeManagerInitializeData</a></li>
<li><a href="contracts/l1-contracts/state-transition/IChainTypeManager.sol/struct.ChainCreationParams.html">ChainCreationParams</a></li>
<li><a href="contracts/l1-contracts/state-transition/IChainTypeManager.sol/interface.IChainTypeManager.html">IChainTypeManager</a></li>
<li><a href="contracts/l1-contracts/state-transition/IValidatorTimelock.sol/interface.IValidatorTimelock.html">IValidatorTimelock</a></li>
<li><a href="contracts/l1-contracts/state-transition/L1StateTransitionErrors.sol/error.AdminZero.html">AdminZero</a></li>
<li><a href="contracts/l1-contracts/state-transition/L1StateTransitionErrors.sol/error.AlreadyMigrated.html">AlreadyMigrated</a></li>
<li><a href="contracts/l1-contracts/state-transition/L1StateTransitionErrors.sol/error.BlobHashBlobCommitmentMismatchValue.html">BlobHashBlobCommitmentMismatchValue</a></li>
<li><a href="contracts/l1-contracts/state-transition/L1StateTransitionErrors.sol/error.CommitBasedInteropNotSupported.html">CommitBasedInteropNotSupported</a></li>
<li><a href="contracts/l1-contracts/state-transition/L1StateTransitionErrors.sol/error.ContractNotDeployed.html">ContractNotDeployed</a></li>
<li><a href="contracts/l1-contracts/state-transition/L1StateTransitionErrors.sol/error.DependencyRootsRollingHashMismatch.html">DependencyRootsRollingHashMismatch</a></li>
<li><a href="contracts/l1-contracts/state-transition/L1StateTransitionErrors.sol/error.ExecutedIsNotConsistentWithVerified.html">ExecutedIsNotConsistentWithVerified</a></li>
<li><a href="contracts/l1-contracts/state-transition/L1StateTransitionErrors.sol/error.InitialForceDeploymentMismatch.html">InitialForceDeploymentMismatch</a></li>
<li><a href="contracts/l1-contracts/state-transition/L1StateTransitionErrors.sol/error.InvalidBatchesDataLength.html">InvalidBatchesDataLength</a></li>
<li><a href="contracts/l1-contracts/state-transition/L1StateTransitionErrors.sol/error.InvalidChainId.html">InvalidChainId</a></li>
<li><a href="contracts/l1-contracts/state-transition/L1StateTransitionErrors.sol/error.InvalidCommitment.html">InvalidCommitment</a></li>
<li><a href="contracts/l1-contracts/state-transition/L1StateTransitionErrors.sol/error.InvalidL2DAOutputHash.html">InvalidL2DAOutputHash</a></li>
<li><a href="contracts/l1-contracts/state-transition/L1StateTransitionErrors.sol/error.InvalidNextLeafIndex.html">InvalidNextLeafIndex</a></li>
<li><a href="contracts/l1-contracts/state-transition/L1StateTransitionErrors.sol/error.InvalidNumberOfBatchHashes.html">InvalidNumberOfBatchHashes</a></li>
<li><a href="contracts/l1-contracts/state-transition/L1StateTransitionErrors.sol/error.InvalidNumberOfBlobs.html">InvalidNumberOfBlobs</a></li>
<li><a href="contracts/l1-contracts/state-transition/L1StateTransitionErrors.sol/error.InvalidPubdataHash.html">InvalidPubdataHash</a></li>
<li><a href="contracts/l1-contracts/state-transition/L1StateTransitionErrors.sol/error.InvalidPubdataSource.html">InvalidPubdataSource</a></li>
<li><a href="contracts/l1-contracts/state-transition/L1StateTransitionErrors.sol/error.InvalidStartIndex.html">InvalidStartIndex</a></li>
<li><a href="contracts/l1-contracts/state-transition/L1StateTransitionErrors.sol/error.InvalidUnprocessedIndex.html">InvalidUnprocessedIndex</a></li>
<li><a href="contracts/l1-contracts/state-transition/L1StateTransitionErrors.sol/error.L1DAValidatorAddressIsZero.html">L1DAValidatorAddressIsZero</a></li>
<li><a href="contracts/l1-contracts/state-transition/L1StateTransitionErrors.sol/error.L1DAValidatorInvalidSender.html">L1DAValidatorInvalidSender</a></li>
<li><a href="contracts/l1-contracts/state-transition/L1StateTransitionErrors.sol/error.L2DAValidatorAddressIsZero.html">L2DAValidatorAddressIsZero</a></li>
<li><a href="contracts/l1-contracts/state-transition/L1StateTransitionErrors.sol/error.LocalRootIsZero.html">LocalRootIsZero</a></li>
<li><a href="contracts/l1-contracts/state-transition/L1StateTransitionErrors.sol/error.LocalRootMustBeZero.html">LocalRootMustBeZero</a></li>
<li><a href="contracts/l1-contracts/state-transition/L1StateTransitionErrors.sol/error.MessageRootIsZero.html">MessageRootIsZero</a></li>
<li><a href="contracts/l1-contracts/state-transition/L1StateTransitionErrors.sol/error.MismatchL2DAValidator.html">MismatchL2DAValidator</a></li>
<li><a href="contracts/l1-contracts/state-transition/L1StateTransitionErrors.sol/error.MismatchNumberOfLayer1Txs.html">MismatchNumberOfLayer1Txs</a></li>
<li><a href="contracts/l1-contracts/state-transition/L1StateTransitionErrors.sol/error.NotAllBatchesExecuted.html">NotAllBatchesExecuted</a></li>
<li><a href="contracts/l1-contracts/state-transition/L1StateTransitionErrors.sol/error.NotChainAdmin.html">NotChainAdmin</a></li>
<li><a href="contracts/l1-contracts/state-transition/L1StateTransitionErrors.sol/error.NotHistoricalRoot.html">NotHistoricalRoot</a></li>
<li><a href="contracts/l1-contracts/state-transition/L1StateTransitionErrors.sol/error.NotHyperchain.html">NotHyperchain</a></li>
<li><a href="contracts/l1-contracts/state-transition/L1StateTransitionErrors.sol/error.NotL1.html">NotL1</a></li>
<li><a href="contracts/l1-contracts/state-transition/L1StateTransitionErrors.sol/error.NotMigrated.html">NotMigrated</a></li>
<li><a href="contracts/l1-contracts/state-transition/L1StateTransitionErrors.sol/error.NotSettlementLayer.html">NotSettlementLayer</a></li>
<li><a href="contracts/l1-contracts/state-transition/L1StateTransitionErrors.sol/error.OnlyOneBlobWithCalldataAllowed.html">OnlyOneBlobWithCalldataAllowed</a></li>
<li><a href="contracts/l1-contracts/state-transition/L1StateTransitionErrors.sol/error.OperatorDAInputTooSmall.html">OperatorDAInputTooSmall</a></li>
<li><a href="contracts/l1-contracts/state-transition/L1StateTransitionErrors.sol/error.OutdatedProtocolVersion.html">OutdatedProtocolVersion</a></li>
<li><a href="contracts/l1-contracts/state-transition/L1StateTransitionErrors.sol/error.ProtocolVersionNotUpToDate.html">ProtocolVersionNotUpToDate</a></li>
<li><a href="contracts/l1-contracts/state-transition/L1StateTransitionErrors.sol/error.PubdataInputTooSmall.html">PubdataInputTooSmall</a></li>
<li><a href="contracts/l1-contracts/state-transition/L1StateTransitionErrors.sol/error.PubdataLengthTooBig.html">PubdataLengthTooBig</a></li>
<li><a href="contracts/l1-contracts/state-transition/L1StateTransitionErrors.sol/error.UnsupportedProofMetadataVersion.html">UnsupportedProofMetadataVersion</a></li>
<li><a href="contracts/l1-contracts/state-transition/L1StateTransitionErrors.sol/error.ValL1DAWrongInputLength.html">ValL1DAWrongInputLength</a></li>
<li><a href="contracts/l1-contracts/state-transition/L1StateTransitionErrors.sol/error.VerifiedIsNotConsistentWithCommitted.html">VerifiedIsNotConsistentWithCommitted</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="ivalidatortimelock"><a class="header" href="#ivalidatortimelock">IValidatorTimelock</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/l1-contracts/state-transition/IValidatorTimelock.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
<a href="contracts/l1-contracts/state-transition/IValidatorTimelock.sol//contracts/l1-contracts/state-transition/chain-interfaces/IExecutor.sol/interface.IExecutor.html">IExecutor</a></p>
<p><strong>Author:</strong>
Matter Labs</p>
<p><strong>Note:</strong>
security-contact: security@matterlabs.dev</p>
<h2 id="functions-30"><a class="header" href="#functions-30">Functions</a></h2>
<h3 id="precommitter_role"><a class="header" href="#precommitter_role">PRECOMMITTER_ROLE</a></h3>
<p>Role hash for addresses allowed to precommit batches on a chain.</p>
<pre><code class="language-solidity">function PRECOMMITTER_ROLE() external view returns (bytes32);
</code></pre>
<h3 id="committer_role"><a class="header" href="#committer_role">COMMITTER_ROLE</a></h3>
<p>Role hash for addresses allowed to commit batches on a chain.</p>
<pre><code class="language-solidity">function COMMITTER_ROLE() external view returns (bytes32);
</code></pre>
<h3 id="reverter_role"><a class="header" href="#reverter_role">REVERTER_ROLE</a></h3>
<p>Role hash for addresses allowed to revert batches on a chain.</p>
<pre><code class="language-solidity">function REVERTER_ROLE() external view returns (bytes32);
</code></pre>
<h3 id="prover_role"><a class="header" href="#prover_role">PROVER_ROLE</a></h3>
<p>Role hash for addresses allowed to prove batches on a chain.</p>
<pre><code class="language-solidity">function PROVER_ROLE() external view returns (bytes32);
</code></pre>
<h3 id="executor_role"><a class="header" href="#executor_role">EXECUTOR_ROLE</a></h3>
<p>Role hash for addresses allowed to execute batches on a chain.</p>
<pre><code class="language-solidity">function EXECUTOR_ROLE() external view returns (bytes32);
</code></pre>
<h3 id="optional_precommitter_admin_role"><a class="header" href="#optional_precommitter_admin_role">OPTIONAL_PRECOMMITTER_ADMIN_ROLE</a></h3>
<p>Optional admin role hash for managing PRECOMMITTER_ROLE assignments.</p>
<p>Note, that it is optional, meaning that by default the admin role is held by the chain admin</p>
<pre><code class="language-solidity">function OPTIONAL_PRECOMMITTER_ADMIN_ROLE() external view returns (bytes32);
</code></pre>
<h3 id="optional_committer_admin_role"><a class="header" href="#optional_committer_admin_role">OPTIONAL_COMMITTER_ADMIN_ROLE</a></h3>
<p>Optional admin role hash for managing COMMITTER_ROLE assignments.</p>
<p>Note, that it is optional, meaning that by default the admin role is held by the chain admin</p>
<pre><code class="language-solidity">function OPTIONAL_COMMITTER_ADMIN_ROLE() external view returns (bytes32);
</code></pre>
<h3 id="optional_reverter_admin_role"><a class="header" href="#optional_reverter_admin_role">OPTIONAL_REVERTER_ADMIN_ROLE</a></h3>
<p>Optional admin role hash for managing REVERTER_ROLE assignments.</p>
<p>Note, that it is optional, meaning that by default the admin role is held by the chain admin</p>
<pre><code class="language-solidity">function OPTIONAL_REVERTER_ADMIN_ROLE() external view returns (bytes32);
</code></pre>
<h3 id="optional_prover_admin_role"><a class="header" href="#optional_prover_admin_role">OPTIONAL_PROVER_ADMIN_ROLE</a></h3>
<p>Optional admin role hash for managing PROVER_ROLE assignments.</p>
<p>Note, that it is optional, meaning that by default the admin role is held by the chain admin</p>
<pre><code class="language-solidity">function OPTIONAL_PROVER_ADMIN_ROLE() external view returns (bytes32);
</code></pre>
<h3 id="optional_executor_admin_role"><a class="header" href="#optional_executor_admin_role">OPTIONAL_EXECUTOR_ADMIN_ROLE</a></h3>
<p>Optional admin role hash for managing EXECUTOR_ROLE assignments.</p>
<p>Note, that it is optional, meaning that by default the admin role is held by the chain admin</p>
<pre><code class="language-solidity">function OPTIONAL_EXECUTOR_ADMIN_ROLE() external view returns (bytes32);
</code></pre>
<h3 id="bridge_hub-4"><a class="header" href="#bridge_hub-4">BRIDGE_HUB</a></h3>
<p>The address of the bridgehub</p>
<pre><code class="language-solidity">function BRIDGE_HUB() external view returns (IBridgehub);
</code></pre>
<h3 id="executiondelay"><a class="header" href="#executiondelay">executionDelay</a></h3>
<p>The delay between committing and executing batches.</p>
<pre><code class="language-solidity">function executionDelay() external view returns (uint32);
</code></pre>
<h3 id="getname"><a class="header" href="#getname">getName</a></h3>
<p>Part of the IBase interface. Not used in this contract.</p>
<pre><code class="language-solidity">function getName() external pure returns (string memory);
</code></pre>
<h3 id="initialize-1"><a class="header" href="#initialize-1">initialize</a></h3>
<p>Initializer for the contract.</p>
<p>Expected to be delegatecalled in the constructor of the TransparentUpgradeableProxy</p>
<pre><code class="language-solidity">function initialize(address _initialOwner, uint32 _initialExecutionDelay)
  external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_initialOwner</code></td><td><code>address</code></td><td>The initial owner of the Validator timelock.</td></tr>
<tr><td><code>_initialExecutionDelay</code></td><td><code>uint32</code></td><td>The initial execution delay, i.e. minimal time between a batch is committed and executed.</td></tr>
</tbody></table>
</div>
<h3 id="setexecutiondelay"><a class="header" href="#setexecutiondelay">setExecutionDelay</a></h3>
<p>Set the delay between committing and executing batches.</p>
<pre><code class="language-solidity">function setExecutionDelay(uint32 _executionDelay) external;
</code></pre>
<h3 id="getcommittedbatchtimestamp"><a class="header" href="#getcommittedbatchtimestamp">getCommittedBatchTimestamp</a></h3>
<p>Returns the timestamp when <code>_l2BatchNumber</code> was committed.</p>
<pre><code class="language-solidity">function getCommittedBatchTimestamp(
  address _chainAddress,
  uint256 _l2BatchNumber
) external view returns (uint256);
</code></pre>
<h3 id="removevalidatorroles"><a class="header" href="#removevalidatorroles">removeValidatorRoles</a></h3>
<p>Revokes the specified validator roles for a given validator on the target chain.</p>
<p>Note that the access control is managed by the inner <code>revokeRole</code> functions.</p>
<pre><code class="language-solidity">function removeValidatorRoles(
  address _chainAddress,
  address _validator,
  ValidatorRotationParams memory params
) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_chainAddress</code></td><td><code>address</code></td><td>The address identifier of the ZK chain.</td></tr>
<tr><td><code>_validator</code></td><td><code>address</code></td><td>The address of the validator to update.</td></tr>
<tr><td><code>params</code></td><td><code>ValidatorRotationParams</code></td><td>Flags indicating which roles to revoke.</td></tr>
</tbody></table>
</div>
<h3 id="removevalidator"><a class="header" href="#removevalidator">removeValidator</a></h3>
<p>Convenience wrapper to revoke all validator roles for a given validator on the target chain.</p>
<pre><code class="language-solidity">function removeValidator(address _chainAddress, address _validator) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_chainAddress</code></td><td><code>address</code></td><td>The address identifier of the ZK chain.</td></tr>
<tr><td><code>_validator</code></td><td><code>address</code></td><td>The address of the validator to remove.</td></tr>
</tbody></table>
</div>
<h3 id="removevalidatorforchainid"><a class="header" href="#removevalidatorforchainid">removeValidatorForChainId</a></h3>
<p>Convenience wrapper to revoke all validator roles for a given validator on the target chain.</p>
<pre><code class="language-solidity">function removeValidatorForChainId(uint256 _chainId, address _validator)
  external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_chainId</code></td><td><code>uint256</code></td><td>The chain Id of the ZK chain.</td></tr>
<tr><td><code>_validator</code></td><td><code>address</code></td><td>The address of the validator to remove.</td></tr>
</tbody></table>
</div>
<h3 id="addvalidatorroles"><a class="header" href="#addvalidatorroles">addValidatorRoles</a></h3>
<p>Grants the specified validator roles for a given validator on the target chain.</p>
<pre><code class="language-solidity">function addValidatorRoles(
  address _chainAddress,
  address _validator,
  ValidatorRotationParams memory params
) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_chainAddress</code></td><td><code>address</code></td><td>The address identifier of the ZK chain.</td></tr>
<tr><td><code>_validator</code></td><td><code>address</code></td><td>The address of the validator to update.</td></tr>
<tr><td><code>params</code></td><td><code>ValidatorRotationParams</code></td><td>Flags indicating which roles to grant.</td></tr>
</tbody></table>
</div>
<h3 id="addvalidator"><a class="header" href="#addvalidator">addValidator</a></h3>
<p>Convenience wrapper to grant all validator roles for a given validator on the target chain.</p>
<pre><code class="language-solidity">function addValidator(address _chainAddress, address _validator) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_chainAddress</code></td><td><code>address</code></td><td>The address identifier of the ZK chain.</td></tr>
<tr><td><code>_validator</code></td><td><code>address</code></td><td>The address of the validator to add.</td></tr>
</tbody></table>
</div>
<h3 id="addvalidatorforchainid"><a class="header" href="#addvalidatorforchainid">addValidatorForChainId</a></h3>
<p>Convenience wrapper to grant all validator roles for a given validator on the target chain.</p>
<pre><code class="language-solidity">function addValidatorForChainId(uint256 _chainId, address _validator) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_chainId</code></td><td><code>uint256</code></td><td>The chain Id of the ZK chain.</td></tr>
<tr><td><code>_validator</code></td><td><code>address</code></td><td>The address of the validator to add.</td></tr>
</tbody></table>
</div>
<h3 id="hasroleforchainid"><a class="header" href="#hasroleforchainid">hasRoleForChainId</a></h3>
<p>Convenience wrapper to retrieve whether a certain address has a role for a chain.</p>
<pre><code class="language-solidity">function hasRoleForChainId(uint256 _chainId, bytes32 _role, address _address)
  external
  view
  returns (bool);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_chainId</code></td><td><code>uint256</code></td><td>The chain Id of the ZK chain.</td></tr>
<tr><td><code>_role</code></td><td><code>bytes32</code></td><td>The bytes32 ID of the role.</td></tr>
<tr><td><code>_address</code></td><td><code>address</code></td><td>The address that may have the role.</td></tr>
</tbody></table>
</div>
<h3 id="precommitsharedbridge"><a class="header" href="#precommitsharedbridge">precommitSharedBridge</a></h3>
<p>Make a call to the zkChain diamond contract with the same calldata.</p>
<pre><code class="language-solidity">function precommitSharedBridge(
  address _chainAddress,
  uint256 _l2BlockNumber,
  bytes calldata _l2Block
) external;
</code></pre>
<h3 id="commitbatchessharedbridge"><a class="header" href="#commitbatchessharedbridge">commitBatchesSharedBridge</a></h3>
<p>Records the timestamp for all provided committed batches and make
a call to the zkChain diamond contract with the same calldata.</p>
<pre><code class="language-solidity">function commitBatchesSharedBridge(
  address _chainAddress,
  uint256 _processBatchFrom,
  uint256 _processBatchTo,
  bytes calldata _batchData
) external;
</code></pre>
<h3 id="revertbatchessharedbridge"><a class="header" href="#revertbatchessharedbridge">revertBatchesSharedBridge</a></h3>
<p>Make a call to the zkChain diamond contract with the same calldata.
Note: If the batch is reverted, it needs to be committed first before the execution.
So it's safe to not override the committed batches.</p>
<pre><code class="language-solidity">function revertBatchesSharedBridge(
  address _chainAddress,
  uint256 _newLastBatch
) external;
</code></pre>
<h3 id="provebatchessharedbridge"><a class="header" href="#provebatchessharedbridge">proveBatchesSharedBridge</a></h3>
<p>Make a call to the zkChain diamond contract with the same calldata.
Note: We don't track the time when batches are proven, since all information about
the batch is known on the commit stage and the proved is not finalized (may be reverted).</p>
<pre><code class="language-solidity">function proveBatchesSharedBridge(
  address _chainAddress,
  uint256 _processBatchFrom,
  uint256 _processBatchTo,
  bytes calldata _proofData
) external;
</code></pre>
<h3 id="executebatchessharedbridge"><a class="header" href="#executebatchessharedbridge">executeBatchesSharedBridge</a></h3>
<p>Check that batches were committed at least X time ago and
make a call to the zkChain diamond contract with the same calldata.</p>
<pre><code class="language-solidity">function executeBatchesSharedBridge(
  address _chainAddress,
  uint256 _processBatchFrom,
  uint256 _processBatchTo,
  bytes calldata _batchData
) external;
</code></pre>
<h2 id="events-21"><a class="header" href="#events-21">Events</a></h2>
<h3 id="newexecutiondelay"><a class="header" href="#newexecutiondelay">NewExecutionDelay</a></h3>
<p>The delay between committing and executing batches is changed.</p>
<pre><code class="language-solidity">event NewExecutionDelay(uint256 _newExecutionDelay);
</code></pre>
<h2 id="structs-3"><a class="header" href="#structs-3">Structs</a></h2>
<h3 id="validatorrotationparams"><a class="header" href="#validatorrotationparams">ValidatorRotationParams</a></h3>
<p>Struct specifying which validator roles to grant or revoke in a single call.</p>
<pre><code class="language-solidity">struct ValidatorRotationParams {
  bool rotatePrecommitterRole;
  bool rotateCommitterRole;
  bool rotateReverterRole;
  bool rotateProverRole;
  bool rotateExecutorRole;
}
</code></pre>
<p><strong>Properties</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>rotatePrecommitterRole</code></td><td><code>bool</code></td><td>Whether to rotate the PRECOMMITTER_ROLE.</td></tr>
<tr><td><code>rotateCommitterRole</code></td><td><code>bool</code></td><td>Whether to rotate the COMMITTER_ROLE.</td></tr>
<tr><td><code>rotateReverterRole</code></td><td><code>bool</code></td><td>Whether to rotate the REVERTER_ROLE.</td></tr>
<tr><td><code>rotateProverRole</code></td><td><code>bool</code></td><td>Whether to rotate the PROVER_ROLE.</td></tr>
<tr><td><code>rotateExecutorRole</code></td><td><code>bool</code></td><td>Whether to rotate the EXECUTOR_ROLE.</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="ichaintypemanager"><a class="header" href="#ichaintypemanager">IChainTypeManager</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/l1-contracts/state-transition/IChainTypeManager.sol">Git Source</a></p>
<h2 id="functions-31"><a class="header" href="#functions-31">Functions</a></h2>
<h3 id="bridge_hub-5"><a class="header" href="#bridge_hub-5">BRIDGE_HUB</a></h3>
<pre><code class="language-solidity">function BRIDGE_HUB() external view returns (address);
</code></pre>
<h3 id="setpendingadmin-1"><a class="header" href="#setpendingadmin-1">setPendingAdmin</a></h3>
<pre><code class="language-solidity">function setPendingAdmin(address _newPendingAdmin) external;
</code></pre>
<h3 id="acceptadmin-1"><a class="header" href="#acceptadmin-1">acceptAdmin</a></h3>
<pre><code class="language-solidity">function acceptAdmin() external;
</code></pre>
<h3 id="getzkchain-1"><a class="header" href="#getzkchain-1">getZKChain</a></h3>
<pre><code class="language-solidity">function getZKChain(uint256 _chainId) external view returns (address);
</code></pre>
<h3 id="gethyperchain"><a class="header" href="#gethyperchain">getHyperchain</a></h3>
<pre><code class="language-solidity">function getHyperchain(uint256 _chainId) external view returns (address);
</code></pre>
<h3 id="getzkchainlegacy"><a class="header" href="#getzkchainlegacy">getZKChainLegacy</a></h3>
<pre><code class="language-solidity">function getZKChainLegacy(uint256 _chainId) external view returns (address);
</code></pre>
<h3 id="storedbatchzero"><a class="header" href="#storedbatchzero">storedBatchZero</a></h3>
<pre><code class="language-solidity">function storedBatchZero() external view returns (bytes32);
</code></pre>
<h3 id="initialcuthash"><a class="header" href="#initialcuthash">initialCutHash</a></h3>
<pre><code class="language-solidity">function initialCutHash() external view returns (bytes32);
</code></pre>
<h3 id="l1genesisupgrade"><a class="header" href="#l1genesisupgrade">l1GenesisUpgrade</a></h3>
<pre><code class="language-solidity">function l1GenesisUpgrade() external view returns (address);
</code></pre>
<h3 id="upgradecuthash"><a class="header" href="#upgradecuthash">upgradeCutHash</a></h3>
<pre><code class="language-solidity">function upgradeCutHash(uint256 _protocolVersion)
  external
  view
  returns (bytes32);
</code></pre>
<h3 id="protocolversion"><a class="header" href="#protocolversion">protocolVersion</a></h3>
<pre><code class="language-solidity">function protocolVersion() external view returns (uint256);
</code></pre>
<h3 id="protocolversiondeadline"><a class="header" href="#protocolversiondeadline">protocolVersionDeadline</a></h3>
<pre><code class="language-solidity">function protocolVersionDeadline(uint256 _protocolVersion)
  external
  view
  returns (uint256);
</code></pre>
<h3 id="protocolversionisactive"><a class="header" href="#protocolversionisactive">protocolVersionIsActive</a></h3>
<pre><code class="language-solidity">function protocolVersionIsActive(uint256 _protocolVersion)
  external
  view
  returns (bool);
</code></pre>
<h3 id="getprotocolversion"><a class="header" href="#getprotocolversion">getProtocolVersion</a></h3>
<pre><code class="language-solidity">function getProtocolVersion(uint256 _chainId) external view returns (uint256);
</code></pre>
<h3 id="initialize-2"><a class="header" href="#initialize-2">initialize</a></h3>
<pre><code class="language-solidity">function initialize(ChainTypeManagerInitializeData calldata _initializeData)
  external;
</code></pre>
<h3 id="setlegacyvalidatortimelock"><a class="header" href="#setlegacyvalidatortimelock">setLegacyValidatorTimelock</a></h3>
<pre><code class="language-solidity">function setLegacyValidatorTimelock(address _validatorTimelock) external;
</code></pre>
<h3 id="setvalidatortimelockpostv29"><a class="header" href="#setvalidatortimelockpostv29">setValidatorTimelockPostV29</a></h3>
<pre><code class="language-solidity">function setValidatorTimelockPostV29(address _validatorTimelockPostV29)
  external;
</code></pre>
<h3 id="setchaincreationparams"><a class="header" href="#setchaincreationparams">setChainCreationParams</a></h3>
<pre><code class="language-solidity">function setChainCreationParams(ChainCreationParams calldata _chainCreationParams)
  external;
</code></pre>
<h3 id="getchainadmin"><a class="header" href="#getchainadmin">getChainAdmin</a></h3>
<pre><code class="language-solidity">function getChainAdmin(uint256 _chainId) external view returns (address);
</code></pre>
<h3 id="createnewchain-1"><a class="header" href="#createnewchain-1">createNewChain</a></h3>
<pre><code class="language-solidity">function createNewChain(
  uint256 _chainId,
  bytes32 _baseTokenAssetId,
  address _admin,
  bytes calldata _initData,
  bytes[] calldata _factoryDeps
) external returns (address);
</code></pre>
<h3 id="setnewversionupgrade"><a class="header" href="#setnewversionupgrade">setNewVersionUpgrade</a></h3>
<pre><code class="language-solidity">function setNewVersionUpgrade(
  Diamond.DiamondCutData calldata _cutData,
  uint256 _oldProtocolVersion,
  uint256 _oldProtocolVersionDeadline,
  uint256 _newProtocolVersion
) external;
</code></pre>
<h3 id="setupgradediamondcut"><a class="header" href="#setupgradediamondcut">setUpgradeDiamondCut</a></h3>
<pre><code class="language-solidity">function setUpgradeDiamondCut(
  Diamond.DiamondCutData calldata _cutData,
  uint256 _oldProtocolVersion
) external;
</code></pre>
<h3 id="executeupgrade"><a class="header" href="#executeupgrade">executeUpgrade</a></h3>
<pre><code class="language-solidity">function executeUpgrade(
  uint256 _chainId,
  Diamond.DiamondCutData calldata _diamondCut
) external;
</code></pre>
<h3 id="setprioritytxmaxgaslimit"><a class="header" href="#setprioritytxmaxgaslimit">setPriorityTxMaxGasLimit</a></h3>
<pre><code class="language-solidity">function setPriorityTxMaxGasLimit(uint256 _chainId, uint256 _maxGasLimit)
  external;
</code></pre>
<h3 id="freezechain"><a class="header" href="#freezechain">freezeChain</a></h3>
<pre><code class="language-solidity">function freezeChain(uint256 _chainId) external;
</code></pre>
<h3 id="unfreezechain"><a class="header" href="#unfreezechain">unfreezeChain</a></h3>
<pre><code class="language-solidity">function unfreezeChain(uint256 _chainId) external;
</code></pre>
<h3 id="settokenmultiplier-1"><a class="header" href="#settokenmultiplier-1">setTokenMultiplier</a></h3>
<pre><code class="language-solidity">function setTokenMultiplier(
  uint256 _chainId,
  uint128 _nominator,
  uint128 _denominator
) external;
</code></pre>
<h3 id="changefeeparams"><a class="header" href="#changefeeparams">changeFeeParams</a></h3>
<pre><code class="language-solidity">function changeFeeParams(uint256 _chainId, FeeParams calldata _newFeeParams)
  external;
</code></pre>
<h3 id="setvalidator"><a class="header" href="#setvalidator">setValidator</a></h3>
<pre><code class="language-solidity">function setValidator(uint256 _chainId, address _validator, bool _active)
  external;
</code></pre>
<h3 id="setporteravailability"><a class="header" href="#setporteravailability">setPorterAvailability</a></h3>
<pre><code class="language-solidity">function setPorterAvailability(uint256 _chainId, bool _zkPorterIsAvailable)
  external;
</code></pre>
<h3 id="upgradechainfromversion"><a class="header" href="#upgradechainfromversion">upgradeChainFromVersion</a></h3>
<pre><code class="language-solidity">function upgradeChainFromVersion(
  uint256 _chainId,
  uint256 _oldProtocolVersion,
  Diamond.DiamondCutData calldata _diamondCut
) external;
</code></pre>
<h3 id="getsemverprotocolversion"><a class="header" href="#getsemverprotocolversion">getSemverProtocolVersion</a></h3>
<pre><code class="language-solidity">function getSemverProtocolVersion()
  external
  view
  returns (uint32, uint32, uint32);
</code></pre>
<h3 id="forwardedbridgeburn"><a class="header" href="#forwardedbridgeburn">forwardedBridgeBurn</a></h3>
<pre><code class="language-solidity">function forwardedBridgeBurn(uint256 _chainId, bytes calldata _data)
  external
  returns (bytes memory _bridgeMintData);
</code></pre>
<h3 id="forwardedbridgemint-1"><a class="header" href="#forwardedbridgemint-1">forwardedBridgeMint</a></h3>
<pre><code class="language-solidity">function forwardedBridgeMint(uint256 _chainId, bytes calldata _data)
  external
  returns (address);
</code></pre>
<h3 id="forwardedbridgerecoverfailedtransfer-1"><a class="header" href="#forwardedbridgerecoverfailedtransfer-1">forwardedBridgeRecoverFailedTransfer</a></h3>
<pre><code class="language-solidity">function forwardedBridgeRecoverFailedTransfer(
  uint256 _chainId,
  bytes32 _assetInfo,
  address _depositSender,
  bytes calldata _ctmData
) external;
</code></pre>
<h2 id="events-22"><a class="header" href="#events-22">Events</a></h2>
<h3 id="newzkchain"><a class="header" href="#newzkchain">NewZKChain</a></h3>
<p>Emitted when a new ZKChain is added</p>
<pre><code class="language-solidity">event NewZKChain(uint256 indexed _chainId, address indexed _zkChainContract);
</code></pre>
<h3 id="genesisupgrade"><a class="header" href="#genesisupgrade">GenesisUpgrade</a></h3>
<p>emitted when an chain registers and a GenesisUpgrade happens</p>
<pre><code class="language-solidity">event GenesisUpgrade(
  address indexed _zkChain,
  L2CanonicalTransaction _l2Transaction,
  uint256 indexed _protocolVersion
);
</code></pre>
<h3 id="newpendingadmin-1"><a class="header" href="#newpendingadmin-1">NewPendingAdmin</a></h3>
<p>pendingAdmin is changed</p>
<p>Also emitted when new admin is accepted and in this case, <code>newPendingAdmin</code> would be zero address</p>
<pre><code class="language-solidity">event NewPendingAdmin(
  address indexed oldPendingAdmin, address indexed newPendingAdmin
);
</code></pre>
<h3 id="newadmin-1"><a class="header" href="#newadmin-1">NewAdmin</a></h3>
<p>Admin changed</p>
<pre><code class="language-solidity">event NewAdmin(address indexed oldAdmin, address indexed newAdmin);
</code></pre>
<h3 id="newvalidatortimelock"><a class="header" href="#newvalidatortimelock">NewValidatorTimelock</a></h3>
<p>ValidatorTimelock changed</p>
<pre><code class="language-solidity">event NewValidatorTimelock(
  address indexed oldValidatorTimelock, address indexed newValidatorTimelock
);
</code></pre>
<h3 id="newvalidatortimelockpostv29"><a class="header" href="#newvalidatortimelockpostv29">NewValidatorTimelockPostV29</a></h3>
<p>ValidatorTimelockPostV29 changed</p>
<pre><code class="language-solidity">event NewValidatorTimelockPostV29(
  address indexed oldValidatorTimelockPostV29,
  address indexed newvalidatorTimelockPostV29
);
</code></pre>
<h3 id="newservernotifier"><a class="header" href="#newservernotifier">NewServerNotifier</a></h3>
<p>ServerNotifier changed</p>
<pre><code class="language-solidity">event NewServerNotifier(
  address indexed oldServerNotifier, address indexed newServerNotifier
);
</code></pre>
<h3 id="newchaincreationparams"><a class="header" href="#newchaincreationparams">NewChainCreationParams</a></h3>
<p>chain creation parameters changed</p>
<pre><code class="language-solidity">event NewChainCreationParams(
  address genesisUpgrade,
  bytes32 genesisBatchHash,
  uint64 genesisIndexRepeatedStorageChanges,
  bytes32 genesisBatchCommitment,
  Diamond.DiamondCutData newInitialCut,
  bytes32 newInitialCutHash,
  bytes forceDeploymentsData,
  bytes32 forceDeploymentHash
);
</code></pre>
<h3 id="newupgradecuthash"><a class="header" href="#newupgradecuthash">NewUpgradeCutHash</a></h3>
<p>New UpgradeCutHash</p>
<pre><code class="language-solidity">event NewUpgradeCutHash(
  uint256 indexed protocolVersion, bytes32 indexed upgradeCutHash
);
</code></pre>
<h3 id="newupgradecutdata"><a class="header" href="#newupgradecutdata">NewUpgradeCutData</a></h3>
<p>New UpgradeCutData</p>
<pre><code class="language-solidity">event NewUpgradeCutData(
  uint256 indexed protocolVersion, Diamond.DiamondCutData diamondCutData
);
</code></pre>
<h3 id="newprotocolversion"><a class="header" href="#newprotocolversion">NewProtocolVersion</a></h3>
<p>New ProtocolVersion</p>
<pre><code class="language-solidity">event NewProtocolVersion(
  uint256 indexed oldProtocolVersion, uint256 indexed newProtocolVersion
);
</code></pre>
<h3 id="updateprotocolversiondeadline"><a class="header" href="#updateprotocolversiondeadline">UpdateProtocolVersionDeadline</a></h3>
<p>Updated ProtocolVersion deadline</p>
<pre><code class="language-solidity">event UpdateProtocolVersionDeadline(
  uint256 indexed protocolVersion, uint256 deadline
);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="l1statetransitionerrors"><a class="header" href="#l1statetransitionerrors">L1StateTransitionErrors</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="contents-10"><a class="header" href="#contents-10">Contents</a></h1>
<ul>
<li><a href="contracts/l1-contracts/state-transition/chain-interfaces/IAdmin.sol/interface.IAdmin.html">IAdmin</a></li>
<li><a href="contracts/l1-contracts/state-transition/chain-interfaces/IDiamondInit.sol/struct.InitializeData.html">InitializeData</a></li>
<li><a href="contracts/l1-contracts/state-transition/chain-interfaces/IDiamondInit.sol/struct.InitializeDataNewChain.html">InitializeDataNewChain</a></li>
<li><a href="contracts/l1-contracts/state-transition/chain-interfaces/IDiamondInit.sol/interface.IDiamondInit.html">IDiamondInit</a></li>
<li><a href="contracts/l1-contracts/state-transition/chain-interfaces/IExecutor.sol/enum.SystemLogKey.html">SystemLogKey</a></li>
<li><a href="contracts/l1-contracts/state-transition/chain-interfaces/IExecutor.sol/struct.LogProcessingOutput.html">LogProcessingOutput</a></li>
<li><a href="contracts/l1-contracts/state-transition/chain-interfaces/IExecutor.sol/interface.IExecutor.html">IExecutor</a></li>
<li><a href="contracts/l1-contracts/state-transition/chain-interfaces/IExecutor.sol/constants.IExecutor.html">IExecutor constants</a></li>
<li><a href="contracts/l1-contracts/state-transition/chain-interfaces/IGetters.sol/interface.IGetters.html">IGetters</a></li>
<li><a href="contracts/l1-contracts/state-transition/chain-interfaces/IL1DAValidator.sol/enum.PubdataSource.html">PubdataSource</a></li>
<li><a href="contracts/l1-contracts/state-transition/chain-interfaces/IL1DAValidator.sol/struct.L1DAValidatorOutput.html">L1DAValidatorOutput</a></li>
<li><a href="contracts/l1-contracts/state-transition/chain-interfaces/IL1DAValidator.sol/interface.IL1DAValidator.html">IL1DAValidator</a></li>
<li><a href="contracts/l1-contracts/state-transition/chain-interfaces/ILegacyGetters.sol/interface.ILegacyGetters.html">ILegacyGetters</a></li>
<li><a href="contracts/l1-contracts/state-transition/chain-interfaces/IMailbox.sol/interface.IMailbox.html">IMailbox</a></li>
<li><a href="contracts/l1-contracts/state-transition/chain-interfaces/IMailboxImpl.sol/interface.IMailboxImpl.html">IMailboxImpl</a></li>
<li><a href="contracts/l1-contracts/state-transition/chain-interfaces/IMessageVerification.sol/interface.IMessageVerification.html">IMessageVerification</a></li>
<li><a href="contracts/l1-contracts/state-transition/chain-interfaces/ITransactionFilterer.sol/interface.ITransactionFilterer.html">ITransactionFilterer</a></li>
<li><a href="contracts/l1-contracts/state-transition/chain-interfaces/IVerifier.sol/struct.VerifierParams.html">VerifierParams</a></li>
<li><a href="contracts/l1-contracts/state-transition/chain-interfaces/IVerifier.sol/interface.IVerifier.html">IVerifier</a></li>
<li><a href="contracts/l1-contracts/state-transition/chain-interfaces/IVerifierV2.sol/interface.IVerifierV2.html">IVerifierV2</a></li>
<li><a href="contracts/l1-contracts/state-transition/chain-interfaces/IZKChain.sol/interface.IZKChain.html">IZKChain</a></li>
<li><a href="contracts/l1-contracts/state-transition/chain-interfaces/IZKChainBase.sol/interface.IZKChainBase.html">IZKChainBase</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="iadmin"><a class="header" href="#iadmin">IAdmin</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/l1-contracts/state-transition/chain-interfaces/IAdmin.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
<a href="contracts/l1-contracts/state-transition/chain-interfaces/IAdmin.sol//contracts/l1-contracts/state-transition/chain-interfaces/IZKChainBase.sol/interface.IZKChainBase.html">IZKChainBase</a></p>
<p><strong>Title:</strong>
The interface of the Admin Contract that controls access rights for contract management.</p>
<p><strong>Author:</strong>
Matter Labs</p>
<p><strong>Note:</strong>
security-contact: security@matterlabs.dev</p>
<h2 id="functions-32"><a class="header" href="#functions-32">Functions</a></h2>
<h3 id="setpendingadmin-2"><a class="header" href="#setpendingadmin-2">setPendingAdmin</a></h3>
<p>Starts the transfer of admin rights. Only the current admin can propose a new pending one.</p>
<p>New admin can accept admin rights by calling <code>acceptAdmin</code> function.</p>
<pre><code class="language-solidity">function setPendingAdmin(address _newPendingAdmin) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_newPendingAdmin</code></td><td><code>address</code></td><td>Address of the new admin</td></tr>
</tbody></table>
</div>
<h3 id="acceptadmin-2"><a class="header" href="#acceptadmin-2">acceptAdmin</a></h3>
<p>Accepts transfer of admin rights. Only pending admin can accept the role.</p>
<pre><code class="language-solidity">function acceptAdmin() external;
</code></pre>
<h3 id="setvalidator-1"><a class="header" href="#setvalidator-1">setValidator</a></h3>
<p>Change validator status (active or not active)</p>
<pre><code class="language-solidity">function setValidator(address _validator, bool _active) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_validator</code></td><td><code>address</code></td><td>Validator address</td></tr>
<tr><td><code>_active</code></td><td><code>bool</code></td><td>Active flag</td></tr>
</tbody></table>
</div>
<h3 id="setporteravailability-1"><a class="header" href="#setporteravailability-1">setPorterAvailability</a></h3>
<p>Change zk porter availability</p>
<pre><code class="language-solidity">function setPorterAvailability(bool _zkPorterIsAvailable) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_zkPorterIsAvailable</code></td><td><code>bool</code></td><td>The availability of zk porter shard</td></tr>
</tbody></table>
</div>
<h3 id="setprioritytxmaxgaslimit-1"><a class="header" href="#setprioritytxmaxgaslimit-1">setPriorityTxMaxGasLimit</a></h3>
<p>Change the max L2 gas limit for L1 -&gt; L2 transactions</p>
<pre><code class="language-solidity">function setPriorityTxMaxGasLimit(uint256 _newPriorityTxMaxGasLimit) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_newPriorityTxMaxGasLimit</code></td><td><code>uint256</code></td><td>The maximum number of L2 gas that a user can request for L1 -&gt; L2 transactions</td></tr>
</tbody></table>
</div>
<h3 id="changefeeparams-1"><a class="header" href="#changefeeparams-1">changeFeeParams</a></h3>
<p>Change the fee params for L1-&gt;L2 transactions</p>
<pre><code class="language-solidity">function changeFeeParams(FeeParams calldata _newFeeParams) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_newFeeParams</code></td><td><code>FeeParams</code></td><td>The new fee params</td></tr>
</tbody></table>
</div>
<h3 id="settokenmultiplier-2"><a class="header" href="#settokenmultiplier-2">setTokenMultiplier</a></h3>
<p>Change the token multiplier for L1-&gt;L2 transactions</p>
<pre><code class="language-solidity">function setTokenMultiplier(uint128 _nominator, uint128 _denominator) external;
</code></pre>
<h3 id="setpubdatapricingmode"><a class="header" href="#setpubdatapricingmode">setPubdataPricingMode</a></h3>
<p>Change the pubdata pricing mode before the first batch is processed</p>
<pre><code class="language-solidity">function setPubdataPricingMode(PubdataPricingMode _pricingMode) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_pricingMode</code></td><td><code>PubdataPricingMode</code></td><td>The new pubdata pricing mode</td></tr>
</tbody></table>
</div>
<h3 id="settransactionfilterer"><a class="header" href="#settransactionfilterer">setTransactionFilterer</a></h3>
<p>Set the transaction filterer</p>
<pre><code class="language-solidity">function setTransactionFilterer(address _transactionFilterer) external;
</code></pre>
<h3 id="allowevmemulation"><a class="header" href="#allowevmemulation">allowEvmEmulation</a></h3>
<p>Allow EVM emulation on chain</p>
<pre><code class="language-solidity">function allowEvmEmulation() external returns (bytes32 canonicalTxHash);
</code></pre>
<h3 id="upgradechainfromversion-1"><a class="header" href="#upgradechainfromversion-1">upgradeChainFromVersion</a></h3>
<p>Perform the upgrade from the current protocol version with the corresponding upgrade data</p>
<pre><code class="language-solidity">function upgradeChainFromVersion(
  uint256 _protocolVersion,
  Diamond.DiamondCutData calldata _cutData
) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_protocolVersion</code></td><td><code>uint256</code></td><td>The current protocol version from which upgrade is executed</td></tr>
<tr><td><code>_cutData</code></td><td><code>Diamond.DiamondCutData</code></td><td>The diamond cut parameters that is executed in the upgrade</td></tr>
</tbody></table>
</div>
<h3 id="executeupgrade-1"><a class="header" href="#executeupgrade-1">executeUpgrade</a></h3>
<p>Executes a proposed governor upgrade</p>
<p>Only the ChainTypeManager contract can execute the upgrade</p>
<pre><code class="language-solidity">function executeUpgrade(Diamond.DiamondCutData calldata _diamondCut) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_diamondCut</code></td><td><code>Diamond.DiamondCutData</code></td><td>The diamond cut parameters to be executed</td></tr>
</tbody></table>
</div>
<h3 id="freezediamond"><a class="header" href="#freezediamond">freezeDiamond</a></h3>
<p>Instantly pause the functionality of all freezable facets &amp; their selectors</p>
<p>Only the governance mechanism may freeze Diamond Proxy</p>
<pre><code class="language-solidity">function freezeDiamond() external;
</code></pre>
<h3 id="unfreezediamond"><a class="header" href="#unfreezediamond">unfreezeDiamond</a></h3>
<p>Unpause the functionality of all freezable facets &amp; their selectors</p>
<p>Only the CTM can unfreeze Diamond Proxy</p>
<pre><code class="language-solidity">function unfreezeDiamond() external;
</code></pre>
<h3 id="genesisupgrade-1"><a class="header" href="#genesisupgrade-1">genesisUpgrade</a></h3>
<pre><code class="language-solidity">function genesisUpgrade(
  address _l1GenesisUpgrade,
  address _ctmDeployer,
  bytes calldata _forceDeploymentData,
  bytes[] calldata _factoryDeps
) external;
</code></pre>
<h3 id="getrollupdamanager"><a class="header" href="#getrollupdamanager">getRollupDAManager</a></h3>
<p>Returns address of the RollupDAManager of the ZK Chain.</p>
<pre><code class="language-solidity">function getRollupDAManager() external view returns (address);
</code></pre>
<h3 id="setdavalidatorpair"><a class="header" href="#setdavalidatorpair">setDAValidatorPair</a></h3>
<p>Set the L1 DA validator address as well as the L2 DA validator address.</p>
<p>While in principle it is possible that updating only one of the addresses is needed,
usually these should work in pair and L1 validator typically expects a specific input from the L2 Validator.
That's why we change those together to prevent admins of chains from shooting themselves in the foot.</p>
<pre><code class="language-solidity">function setDAValidatorPair(address _l1DAValidator, address _l2DAValidator)
  external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_l1DAValidator</code></td><td><code>address</code></td><td>The address of the L1 DA validator</td></tr>
<tr><td><code>_l2DAValidator</code></td><td><code>address</code></td><td>The address of the L2 DA validator</td></tr>
</tbody></table>
</div>
<h3 id="makepermanentrollup"><a class="header" href="#makepermanentrollup">makePermanentRollup</a></h3>
<p>Makes the chain as permanent rollup.</p>
<p>This is a security feature needed for chains that should be
trusted to keep their data available even if the chain admin becomes malicious
and tries to set the DA validator pair to something which does not publish DA to Ethereum.</p>
<p>DANGEROUS: once activated, there is no way back!</p>
<pre><code class="language-solidity">function makePermanentRollup() external;
</code></pre>
<h3 id="forwardedbridgeburn-1"><a class="header" href="#forwardedbridgeburn-1">forwardedBridgeBurn</a></h3>
<p>Similar to IL1AssetHandler interface, used to send chains.</p>
<pre><code class="language-solidity">function forwardedBridgeBurn(
  address _settlementLayer,
  address _originalCaller,
  bytes calldata _data
) external payable returns (bytes memory _bridgeMintData);
</code></pre>
<h3 id="forwardedbridgerecoverfailedtransfer-2"><a class="header" href="#forwardedbridgerecoverfailedtransfer-2">forwardedBridgeRecoverFailedTransfer</a></h3>
<p>Similar to IL1AssetHandler interface, used to claim failed chain transfers.</p>
<pre><code class="language-solidity">function forwardedBridgeRecoverFailedTransfer(
  uint256 _chainId,
  bytes32 _assetInfo,
  address _originalCaller,
  bytes calldata _chainData
) external payable;
</code></pre>
<h3 id="forwardedbridgemint-2"><a class="header" href="#forwardedbridgemint-2">forwardedBridgeMint</a></h3>
<p>Similar to IL1AssetHandler interface, used to receive chains.</p>
<pre><code class="language-solidity">function forwardedBridgeMint(
  bytes calldata _data,
  bool _contractAlreadyDeployed
) external payable;
</code></pre>
<h3 id="preparechaincommitment"><a class="header" href="#preparechaincommitment">prepareChainCommitment</a></h3>
<pre><code class="language-solidity">function prepareChainCommitment()
  external
  view
  returns (ZKChainCommitment memory commitment);
</code></pre>
<h2 id="events-23"><a class="header" href="#events-23">Events</a></h2>
<h3 id="isporteravailablestatusupdate"><a class="header" href="#isporteravailablestatusupdate">IsPorterAvailableStatusUpdate</a></h3>
<p>Porter availability status changes</p>
<pre><code class="language-solidity">event IsPorterAvailableStatusUpdate(bool isPorterAvailable);
</code></pre>
<h3 id="validatorstatusupdate"><a class="header" href="#validatorstatusupdate">ValidatorStatusUpdate</a></h3>
<p>Validator's status changed</p>
<pre><code class="language-solidity">event ValidatorStatusUpdate(address indexed validatorAddress, bool isActive);
</code></pre>
<h3 id="newpendingadmin-2"><a class="header" href="#newpendingadmin-2">NewPendingAdmin</a></h3>
<p>pendingAdmin is changed</p>
<p>Also emitted when new admin is accepted and in this case, <code>newPendingAdmin</code> would be zero address</p>
<pre><code class="language-solidity">event NewPendingAdmin(
  address indexed oldPendingAdmin, address indexed newPendingAdmin
);
</code></pre>
<h3 id="newadmin-2"><a class="header" href="#newadmin-2">NewAdmin</a></h3>
<p>Admin changed</p>
<pre><code class="language-solidity">event NewAdmin(address indexed oldAdmin, address indexed newAdmin);
</code></pre>
<h3 id="newprioritytxmaxgaslimit"><a class="header" href="#newprioritytxmaxgaslimit">NewPriorityTxMaxGasLimit</a></h3>
<p>Priority transaction max L2 gas limit changed</p>
<pre><code class="language-solidity">event NewPriorityTxMaxGasLimit(
  uint256 oldPriorityTxMaxGasLimit, uint256 newPriorityTxMaxGasLimit
);
</code></pre>
<h3 id="newfeeparams"><a class="header" href="#newfeeparams">NewFeeParams</a></h3>
<p>Fee params for L1-&gt;L2 transactions changed</p>
<pre><code class="language-solidity">event NewFeeParams(FeeParams oldFeeParams, FeeParams newFeeParams);
</code></pre>
<h3 id="pubdatapricingmodeupdate"><a class="header" href="#pubdatapricingmodeupdate">PubdataPricingModeUpdate</a></h3>
<p>Validium mode status changed</p>
<pre><code class="language-solidity">event PubdataPricingModeUpdate(PubdataPricingMode validiumMode);
</code></pre>
<h3 id="newtransactionfilterer"><a class="header" href="#newtransactionfilterer">NewTransactionFilterer</a></h3>
<p>The transaction filterer has been updated</p>
<pre><code class="language-solidity">event NewTransactionFilterer(
  address oldTransactionFilterer, address newTransactionFilterer
);
</code></pre>
<h3 id="newbasetokenmultiplier"><a class="header" href="#newbasetokenmultiplier">NewBaseTokenMultiplier</a></h3>
<p>BaseToken multiplier for L1-&gt;L2 transactions changed</p>
<pre><code class="language-solidity">event NewBaseTokenMultiplier(
  uint128 oldNominator,
  uint128 oldDenominator,
  uint128 newNominator,
  uint128 newDenominator
);
</code></pre>
<h3 id="executeupgrade-2"><a class="header" href="#executeupgrade-2">ExecuteUpgrade</a></h3>
<p>Emitted when an upgrade is executed.</p>
<pre><code class="language-solidity">event ExecuteUpgrade(Diamond.DiamondCutData diamondCut);
</code></pre>
<h3 id="migrationcomplete"><a class="header" href="#migrationcomplete">MigrationComplete</a></h3>
<p>Emitted when the migration to the new settlement layer is complete.</p>
<pre><code class="language-solidity">event MigrationComplete();
</code></pre>
<h3 id="freeze"><a class="header" href="#freeze">Freeze</a></h3>
<p>Emitted when the contract is frozen.</p>
<pre><code class="language-solidity">event Freeze();
</code></pre>
<h3 id="unfreeze"><a class="header" href="#unfreeze">Unfreeze</a></h3>
<p>Emitted when the contract is unfrozen.</p>
<pre><code class="language-solidity">event Unfreeze();
</code></pre>
<h3 id="enableevmemulator-1"><a class="header" href="#enableevmemulator-1">EnableEvmEmulator</a></h3>
<p>The EVM emulator has been enabled</p>
<pre><code class="language-solidity">event EnableEvmEmulator();
</code></pre>
<h3 id="newl2davalidator"><a class="header" href="#newl2davalidator">NewL2DAValidator</a></h3>
<p>New pair of DA validators set</p>
<pre><code class="language-solidity">event NewL2DAValidator(
  address indexed oldL2DAValidator, address indexed newL2DAValidator
);
</code></pre>
<h3 id="newl1davalidator"><a class="header" href="#newl1davalidator">NewL1DAValidator</a></h3>
<pre><code class="language-solidity">event NewL1DAValidator(
  address indexed oldL1DAValidator, address indexed newL1DAValidator
);
</code></pre>
<h3 id="bridgemint-4"><a class="header" href="#bridgemint-4">BridgeMint</a></h3>
<pre><code class="language-solidity">event BridgeMint(address indexed _account, uint256 _amount);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="idiamondinit"><a class="header" href="#idiamondinit">IDiamondInit</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/l1-contracts/state-transition/chain-interfaces/IDiamondInit.sol">Git Source</a></p>
<h2 id="functions-33"><a class="header" href="#functions-33">Functions</a></h2>
<h3 id="initialize-3"><a class="header" href="#initialize-3">initialize</a></h3>
<pre><code class="language-solidity">function initialize(InitializeData calldata _initData)
  external
  returns (bytes32);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="iexecutor"><a class="header" href="#iexecutor">IExecutor</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/l1-contracts/state-transition/chain-interfaces/IExecutor.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
<a href="contracts/l1-contracts/state-transition/chain-interfaces/IExecutor.sol//contracts/l1-contracts/state-transition/chain-interfaces/IZKChainBase.sol/interface.IZKChainBase.html">IZKChainBase</a></p>
<p><strong>Title:</strong>
The interface of the ZKsync Executor contract capable of processing events emitted in the ZKsync protocol.</p>
<p><strong>Author:</strong>
Matter Labs</p>
<p><strong>Note:</strong>
security-contact: security@matterlabs.dev</p>
<h2 id="functions-34"><a class="header" href="#functions-34">Functions</a></h2>
<h3 id="precommitsharedbridge-1"><a class="header" href="#precommitsharedbridge-1">precommitSharedBridge</a></h3>
<p>Precommits the status of all L2 transactions for the next batch on the shared bridge.</p>
<pre><code class="language-solidity">function precommitSharedBridge(
  address _chainAddress,
  uint256 _batchNumber,
  bytes calldata _precommitData
) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_chainAddress</code></td><td><code>address</code></td><td>The address of the DiamondProxy of the chain. Note, that it is not used in the implementation, because it is expected to be equal to the <code>address(this)</code>, but it is kept here to maintain the same interface on both <code>ValidatorTimelock</code> and <code>Executor</code> for easier and cheaper implementation of the timelock.</td></tr>
<tr><td><code>_batchNumber</code></td><td><code>uint256</code></td><td>The sequential batch number to precommit (must equal <code>s.totalBatchesCommitted + 1</code>).</td></tr>
<tr><td><code>_precommitData</code></td><td><code>bytes</code></td><td>ABI‚Äêencoded transaction status list for the precommit.</td></tr>
</tbody></table>
</div>
<h3 id="commitbatchessharedbridge-1"><a class="header" href="#commitbatchessharedbridge-1">commitBatchesSharedBridge</a></h3>
<p>Function called by the operator to commit new batches. It is responsible for:</p>
<ul>
<li>Verifying the correctness of their timestamps.</li>
<li>Processing their L2-&gt;L1 logs.</li>
<li>Storing batch commitments.</li>
</ul>
<pre><code class="language-solidity">function commitBatchesSharedBridge(
  address _chainAddress,
  uint256 _processFrom,
  uint256 _processTo,
  bytes calldata _commitData
) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_chainAddress</code></td><td><code>address</code></td><td>The address of the DiamondProxy of the chain. Note, that it is not used in the implementation, because it is expected to be equal to the <code>address(this)</code>, but it is kept here to maintain the same interface on both <code>ValidatorTimelock</code> and <code>Executor</code> for easier and cheaper implementation of the timelock.</td></tr>
<tr><td><code>_processFrom</code></td><td><code>uint256</code></td><td>The batch number from which the processing starts.</td></tr>
<tr><td><code>_processTo</code></td><td><code>uint256</code></td><td>The batch number at which the processing ends.</td></tr>
<tr><td><code>_commitData</code></td><td><code>bytes</code></td><td>The encoded data of the new batches to be committed.</td></tr>
</tbody></table>
</div>
<h3 id="provebatchessharedbridge-1"><a class="header" href="#provebatchessharedbridge-1">proveBatchesSharedBridge</a></h3>
<p>Batches commitment verification.</p>
<p>Only verifies batch commitments without any other processing.</p>
<pre><code class="language-solidity">function proveBatchesSharedBridge(
  address _chainAddress,
  uint256 _processBatchFrom,
  uint256 _processBatchTo,
  bytes calldata _proofData
) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_chainAddress</code></td><td><code>address</code></td><td>The address of the DiamondProxy of the chain. Note, that it is not used in the implementation, because it is expected to be equal to the <code>address(this)</code>, but it is kept here to maintain the same interface on both <code>ValidatorTimelock</code> and <code>Executor</code> for easier and cheaper implementation of the timelock.</td></tr>
<tr><td><code>_processBatchFrom</code></td><td><code>uint256</code></td><td>The batch number from which the verification starts.</td></tr>
<tr><td><code>_processBatchTo</code></td><td><code>uint256</code></td><td>The batch number at which the verification ends.</td></tr>
<tr><td><code>_proofData</code></td><td><code>bytes</code></td><td>The encoded data of the new batches to be verified.</td></tr>
</tbody></table>
</div>
<h3 id="executebatchessharedbridge-1"><a class="header" href="#executebatchessharedbridge-1">executeBatchesSharedBridge</a></h3>
<p>The function called by the operator to finalize (execute) batches. It is responsible for:</p>
<ul>
<li>Processing all pending operations (commpleting priority requests).</li>
<li>Finalizing this batch (i.e. allowing to withdraw funds from the system)</li>
</ul>
<pre><code class="language-solidity">function executeBatchesSharedBridge(
  address _chainAddress,
  uint256 _processFrom,
  uint256 _processTo,
  bytes calldata _executeData
) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_chainAddress</code></td><td><code>address</code></td><td>The address of the DiamondProxy of the chain. Note, that it is not used in the implementation, because it is expected to be equal to the <code>address(this)</code>, but it is kept here to maintain the same interface on both <code>ValidatorTimelock</code> and <code>Executor</code> for easier and cheaper implementation of the timelock.</td></tr>
<tr><td><code>_processFrom</code></td><td><code>uint256</code></td><td>The batch number from which the execution starts.</td></tr>
<tr><td><code>_processTo</code></td><td><code>uint256</code></td><td>The batch number at which the execution ends.</td></tr>
<tr><td><code>_executeData</code></td><td><code>bytes</code></td><td>The encoded data of the new batches to be executed.</td></tr>
</tbody></table>
</div>
<h3 id="revertbatchessharedbridge-1"><a class="header" href="#revertbatchessharedbridge-1">revertBatchesSharedBridge</a></h3>
<p>Reverts unexecuted batches</p>
<p>When the _newLastBatch is equal to the number of committed batches,
only the precommitment is erased.
NOTE: Doesn't delete the stored data about batches, but only decreases
counters that are responsible for the number of batches</p>
<pre><code class="language-solidity">function revertBatchesSharedBridge(
  address _chainAddress,
  uint256 _newLastBatch
) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_chainAddress</code></td><td><code>address</code></td><td>The address of the DiamondProxy of the chain.</td></tr>
<tr><td><code>_newLastBatch</code></td><td><code>uint256</code></td><td>batch number after which batches should be reverted</td></tr>
</tbody></table>
</div>
<h2 id="events-24"><a class="header" href="#events-24">Events</a></h2>
<h3 id="blockcommit"><a class="header" href="#blockcommit">BlockCommit</a></h3>
<p>Event emitted when a batch is committed</p>
<p>It has the name "BlockCommit" and not "BatchCommit" due to backward compatibility considerations</p>
<pre><code class="language-solidity">event BlockCommit(
  uint256 indexed batchNumber,
  bytes32 indexed batchHash,
  bytes32 indexed commitment
);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>batchNumber</code></td><td><code>uint256</code></td><td>Number of the batch committed</td></tr>
<tr><td><code>batchHash</code></td><td><code>bytes32</code></td><td>Hash of the L2 batch</td></tr>
<tr><td><code>commitment</code></td><td><code>bytes32</code></td><td>Calculated input for the ZKsync circuit</td></tr>
</tbody></table>
</div>
<h3 id="blocksverification"><a class="header" href="#blocksverification">BlocksVerification</a></h3>
<p>Event emitted when batches are verified</p>
<p>It has the name "BlocksVerification" and not "BatchesVerification" due to backward compatibility considerations</p>
<pre><code class="language-solidity">event BlocksVerification(
  uint256 indexed previousLastVerifiedBatch,
  uint256 indexed currentLastVerifiedBatch
);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>previousLastVerifiedBatch</code></td><td><code>uint256</code></td><td>Batch number of the previous last verified batch</td></tr>
<tr><td><code>currentLastVerifiedBatch</code></td><td><code>uint256</code></td><td>Batch number of the current last verified batch</td></tr>
</tbody></table>
</div>
<h3 id="blockexecution"><a class="header" href="#blockexecution">BlockExecution</a></h3>
<p>Event emitted when a batch is executed</p>
<p>It has the name "BlockExecution" and not "BatchExecution" due to backward compatibility considerations</p>
<pre><code class="language-solidity">event BlockExecution(
  uint256 indexed batchNumber,
  bytes32 indexed batchHash,
  bytes32 indexed commitment
);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>batchNumber</code></td><td><code>uint256</code></td><td>Number of the batch executed</td></tr>
<tr><td><code>batchHash</code></td><td><code>bytes32</code></td><td>Hash of the L2 batch</td></tr>
<tr><td><code>commitment</code></td><td><code>bytes32</code></td><td>Verified input for the ZKsync circuit</td></tr>
</tbody></table>
</div>
<h3 id="blocksrevert"><a class="header" href="#blocksrevert">BlocksRevert</a></h3>
<p>Event emitted when batches are reverted</p>
<p>It has the name "BlocksRevert" and not "BatchesRevert" due to backward compatibility considerations</p>
<pre><code class="language-solidity">event BlocksRevert(
  uint256 totalBatchesCommitted,
  uint256 totalBatchesVerified,
  uint256 totalBatchesExecuted
);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>totalBatchesCommitted</code></td><td><code>uint256</code></td><td>Total number of committed batches after the revert</td></tr>
<tr><td><code>totalBatchesVerified</code></td><td><code>uint256</code></td><td>Total number of verified batches after the revert</td></tr>
<tr><td><code>totalBatchesExecuted</code></td><td><code>uint256</code></td><td>Total number of executed batches</td></tr>
</tbody></table>
</div>
<h3 id="batchprecommitmentset"><a class="header" href="#batchprecommitmentset">BatchPrecommitmentSet</a></h3>
<p>Emitted when a new precommitment is set for a batch.</p>
<pre><code class="language-solidity">event BatchPrecommitmentSet(
  uint256 indexed batchNumber,
  uint256 indexed untrustedLastL2BlockNumberHint,
  bytes32 precommitment
);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>batchNumber</code></td><td><code>uint256</code></td><td>The batch number for which the precommitment was recorded.</td></tr>
<tr><td><code>untrustedLastL2BlockNumberHint</code></td><td><code>uint256</code></td><td>The hint to what L2 block number the precommitment should correspond to. Note, that there are no guarantees on its correctness, it is just a way for the server to make external nodes' indexing simpler.</td></tr>
<tr><td><code>precommitment</code></td><td><code>bytes32</code></td><td>The resulting rolling hash of all transaction statuses.</td></tr>
</tbody></table>
</div>
<h2 id="structs-4"><a class="header" href="#structs-4">Structs</a></h2>
<h3 id="storedbatchinfo"><a class="header" href="#storedbatchinfo">StoredBatchInfo</a></h3>
<p>Rollup batch stored data</p>
<pre><code class="language-solidity">struct StoredBatchInfo {
  uint64 batchNumber;
  bytes32 batchHash;
  uint64 indexRepeatedStorageChanges;
  uint256 numberOfLayer1Txs;
  bytes32 priorityOperationsHash;
  bytes32 dependencyRootsRollingHash;
  bytes32 l2LogsTreeRoot;
  uint256 timestamp;
  bytes32 commitment;
}
</code></pre>
<p><strong>Properties</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>batchNumber</code></td><td><code>uint64</code></td><td>Rollup batch number</td></tr>
<tr><td><code>batchHash</code></td><td><code>bytes32</code></td><td>Hash of L2 batch</td></tr>
<tr><td><code>indexRepeatedStorageChanges</code></td><td><code>uint64</code></td><td>The serial number of the shortcut index that's used as a unique identifier for storage keys that were used twice or more</td></tr>
<tr><td><code>numberOfLayer1Txs</code></td><td><code>uint256</code></td><td>Number of priority operations to be processed</td></tr>
<tr><td><code>priorityOperationsHash</code></td><td><code>bytes32</code></td><td>Hash of all priority operations from this batch</td></tr>
<tr><td><code>dependencyRootsRollingHash</code></td><td><code>bytes32</code></td><td></td></tr>
<tr><td><code>l2LogsTreeRoot</code></td><td><code>bytes32</code></td><td>Root hash of tree that contains L2 -&gt; L1 messages from this batch</td></tr>
<tr><td><code>timestamp</code></td><td><code>uint256</code></td><td>Rollup batch timestamp, have the same format as Ethereum batch constant</td></tr>
<tr><td><code>commitment</code></td><td><code>bytes32</code></td><td>Verified input for the ZKsync circuit</td></tr>
</tbody></table>
</div>
<h3 id="legacystoredbatchinfo"><a class="header" href="#legacystoredbatchinfo">LegacyStoredBatchInfo</a></h3>
<p>Legacy StoredBatchInfo struct</p>
<p>dependencyRootsRollingHash is not included in the struct</p>
<pre><code class="language-solidity">struct LegacyStoredBatchInfo {
  uint64 batchNumber;
  bytes32 batchHash;
  uint64 indexRepeatedStorageChanges;
  uint256 numberOfLayer1Txs;
  bytes32 priorityOperationsHash;
  bytes32 l2LogsTreeRoot;
  uint256 timestamp;
  bytes32 commitment;
}
</code></pre>
<h3 id="commitbatchinfo"><a class="header" href="#commitbatchinfo">CommitBatchInfo</a></h3>
<p>Data needed to commit new batch</p>
<p>pubdataCommitments format: This will always start with a 1 byte pubdataSource flag. Current allowed values are 0 (calldata) or 1 (blobs)
kzg: list of: opening point (16 bytes) || claimed value (32 bytes) || commitment (48 bytes) || proof (48 bytes) = 144 bytes
calldata: pubdataCommitments.length - 1 - 32 bytes of pubdata
and 32 bytes appended to serve as the blob commitment part for the aux output part of the batch commitment</p>
<p>For 2 blobs we will be sending 288 bytes of calldata instead of the full amount for pubdata.</p>
<p>When using calldata, we only need to send one blob commitment since the max number of bytes in calldata fits in a single blob and we can pull the
linear hash from the system logs</p>
<pre><code class="language-solidity">struct CommitBatchInfo {
  uint64 batchNumber;
  uint64 timestamp;
  uint64 indexRepeatedStorageChanges;
  bytes32 newStateRoot;
  uint256 numberOfLayer1Txs;
  bytes32 priorityOperationsHash;
  bytes32 bootloaderHeapInitialContentsHash;
  bytes32 eventsQueueStateHash;
  bytes systemLogs;
  bytes operatorDAInput;
}
</code></pre>
<p><strong>Properties</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>batchNumber</code></td><td><code>uint64</code></td><td>Number of the committed batch</td></tr>
<tr><td><code>timestamp</code></td><td><code>uint64</code></td><td>Unix timestamp denoting the start of the batch execution</td></tr>
<tr><td><code>indexRepeatedStorageChanges</code></td><td><code>uint64</code></td><td>The serial number of the shortcut index that's used as a unique identifier for storage keys that were used twice or more</td></tr>
<tr><td><code>newStateRoot</code></td><td><code>bytes32</code></td><td>The state root of the full state tree</td></tr>
<tr><td><code>numberOfLayer1Txs</code></td><td><code>uint256</code></td><td>Number of priority operations to be processed</td></tr>
<tr><td><code>priorityOperationsHash</code></td><td><code>bytes32</code></td><td>Hash of all priority operations from this batch</td></tr>
<tr><td><code>bootloaderHeapInitialContentsHash</code></td><td><code>bytes32</code></td><td>Hash of the initial contents of the bootloader heap. In practice it serves as the commitment to the transactions in the batch.</td></tr>
<tr><td><code>eventsQueueStateHash</code></td><td><code>bytes32</code></td><td>Hash of the events queue state. In practice it serves as the commitment to the events in the batch.</td></tr>
<tr><td><code>systemLogs</code></td><td><code>bytes</code></td><td>concatenation of all L2 -&gt; L1 system logs in the batch</td></tr>
<tr><td><code>operatorDAInput</code></td><td><code>bytes</code></td><td>Packed pubdata commitments/data.</td></tr>
</tbody></table>
</div>
<h3 id="precommitinfo"><a class="header" href="#precommitinfo">PrecommitInfo</a></h3>
<p>Container for a list of transaction statuses to precommit.</p>
<pre><code class="language-solidity">struct PrecommitInfo {
  bytes packedTxsCommitments;
  uint256 untrustedLastL2BlockNumberHint;
}
</code></pre>
<p><strong>Properties</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>packedTxsCommitments</code></td><td><code>bytes</code></td><td></td></tr>
<tr><td><code>untrustedLastL2BlockNumberHint</code></td><td><code>uint256</code></td><td>The "hint" for what the last L2 block number that these txs represent is.</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="constants-2"><a class="header" href="#constants-2">Constants</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/l1-contracts/state-transition/chain-interfaces/IExecutor.sol">Git Source</a></p>
<h3 id="max_log_key"><a class="header" href="#max_log_key">MAX_LOG_KEY</a></h3>
<p>Maximal value that SystemLogKey variable can have.</p>
<pre><code class="language-solidity">uint256 constant MAX_LOG_KEY = uint256(type(SystemLogKey).max)
</code></pre>
<h3 id="l2_log_address_offset"><a class="header" href="#l2_log_address_offset">L2_LOG_ADDRESS_OFFSET</a></h3>
<p>Offset used to pull Address From Log. Equal to 4 (bytes for shardId, isService and txNumberInBatch)</p>
<pre><code class="language-solidity">uint256 constant L2_LOG_ADDRESS_OFFSET = 4
</code></pre>
<h3 id="l2_log_key_offset"><a class="header" href="#l2_log_key_offset">L2_LOG_KEY_OFFSET</a></h3>
<p>Offset used to pull Key From Log. Equal to 4 (bytes for shardId, isService and txNumberInBatch) + 20 (bytes for address)</p>
<pre><code class="language-solidity">uint256 constant L2_LOG_KEY_OFFSET = 24
</code></pre>
<h3 id="l2_log_value_offset"><a class="header" href="#l2_log_value_offset">L2_LOG_VALUE_OFFSET</a></h3>
<p>Offset used to pull Value From Log. Equal to 4 (bytes for shardId, isService and txNumberInBatch) + 20 (bytes for address) + 32 (bytes for key)</p>
<pre><code class="language-solidity">uint256 constant L2_LOG_VALUE_OFFSET = 56
</code></pre>
<h3 id="max_number_of_blobs"><a class="header" href="#max_number_of_blobs">MAX_NUMBER_OF_BLOBS</a></h3>
<p>Max number of blobs currently supported</p>
<pre><code class="language-solidity">uint256 constant MAX_NUMBER_OF_BLOBS = 6
</code></pre>
<h3 id="total_blobs_in_commitment"><a class="header" href="#total_blobs_in_commitment">TOTAL_BLOBS_IN_COMMITMENT</a></h3>
<p>The number of blobs that must be present in the commitment to a batch.
It represents the maximal number of blobs that circuits can support and can be larger
than the maximal number of blobs supported by the contract (<code>MAX_NUMBER_OF_BLOBS</code>).</p>
<pre><code class="language-solidity">uint256 constant TOTAL_BLOBS_IN_COMMITMENT = 16
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="igetters"><a class="header" href="#igetters">IGetters</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/l1-contracts/state-transition/chain-interfaces/IGetters.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
<a href="contracts/l1-contracts/state-transition/chain-interfaces/IGetters.sol//contracts/l1-contracts/state-transition/chain-interfaces/IZKChainBase.sol/interface.IZKChainBase.html">IZKChainBase</a></p>
<p><strong>Title:</strong>
The interface of the Getters Contract that implements functions for getting contract state from outside the blockchain.</p>
<p><strong>Author:</strong>
Matter Labs</p>
<p>Most of the methods simply return the values that correspond to the current diamond proxy and possibly
not to the ZK Chain as a whole. For example, if the chain is migrated to another settlement layer, the values returned
by this facet will correspond to the values stored on this chain and possilbly not the canonical state of the chain.</p>
<p><strong>Note:</strong>
security-contact: security@matterlabs.dev</p>
<h2 id="functions-35"><a class="header" href="#functions-35">Functions</a></h2>
<h3 id="getverifier"><a class="header" href="#getverifier">getVerifier</a></h3>
<pre><code class="language-solidity">function getVerifier() external view returns (address);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>address</code></td><td>The address of the verifier smart contract</td></tr>
</tbody></table>
</div>
<h3 id="getadmin"><a class="header" href="#getadmin">getAdmin</a></h3>
<pre><code class="language-solidity">function getAdmin() external view returns (address);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>address</code></td><td>The address of the current admin</td></tr>
</tbody></table>
</div>
<h3 id="getpendingadmin"><a class="header" href="#getpendingadmin">getPendingAdmin</a></h3>
<pre><code class="language-solidity">function getPendingAdmin() external view returns (address);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>address</code></td><td>The address of the pending admin</td></tr>
</tbody></table>
</div>
<h3 id="getbridgehub"><a class="header" href="#getbridgehub">getBridgehub</a></h3>
<pre><code class="language-solidity">function getBridgehub() external view returns (address);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>address</code></td><td>The address of the bridgehub</td></tr>
</tbody></table>
</div>
<h3 id="getchaintypemanager"><a class="header" href="#getchaintypemanager">getChainTypeManager</a></h3>
<pre><code class="language-solidity">function getChainTypeManager() external view returns (address);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>address</code></td><td>The address of the state transition</td></tr>
</tbody></table>
</div>
<h3 id="getchainid"><a class="header" href="#getchainid">getChainId</a></h3>
<pre><code class="language-solidity">function getChainId() external view returns (uint256);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint256</code></td><td>The chain ID</td></tr>
</tbody></table>
</div>
<h3 id="getbasetoken"><a class="header" href="#getbasetoken">getBaseToken</a></h3>
<pre><code class="language-solidity">function getBaseToken() external view returns (address);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>address</code></td><td>The address of the base token</td></tr>
</tbody></table>
</div>
<h3 id="getbasetokenassetid"><a class="header" href="#getbasetokenassetid">getBaseTokenAssetId</a></h3>
<pre><code class="language-solidity">function getBaseTokenAssetId() external view returns (bytes32);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>bytes32</code></td><td>The address of the base token</td></tr>
</tbody></table>
</div>
<h3 id="gettotalbatchescommitted"><a class="header" href="#gettotalbatchescommitted">getTotalBatchesCommitted</a></h3>
<pre><code class="language-solidity">function getTotalBatchesCommitted() external view returns (uint256);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint256</code></td><td>The total number of batches that were committed</td></tr>
</tbody></table>
</div>
<h3 id="gettotalbatchesverified"><a class="header" href="#gettotalbatchesverified">getTotalBatchesVerified</a></h3>
<pre><code class="language-solidity">function getTotalBatchesVerified() external view returns (uint256);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint256</code></td><td>The total number of batches that were committed &amp; verified</td></tr>
</tbody></table>
</div>
<h3 id="gettotalbatchesexecuted"><a class="header" href="#gettotalbatchesexecuted">getTotalBatchesExecuted</a></h3>
<pre><code class="language-solidity">function getTotalBatchesExecuted() external view returns (uint256);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint256</code></td><td>The total number of batches that were committed &amp; verified &amp; executed</td></tr>
</tbody></table>
</div>
<h3 id="gettransactionfilterer"><a class="header" href="#gettransactionfilterer">getTransactionFilterer</a></h3>
<pre><code class="language-solidity">function getTransactionFilterer() external view returns (address);
</code></pre>
<h3 id="gettotalprioritytxs"><a class="header" href="#gettotalprioritytxs">getTotalPriorityTxs</a></h3>
<pre><code class="language-solidity">function getTotalPriorityTxs() external view returns (uint256);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint256</code></td><td>The total number of priority operations that were added to the priority queue, including all processed ones</td></tr>
</tbody></table>
</div>
<h3 id="getprioritytreestartindex"><a class="header" href="#getprioritytreestartindex">getPriorityTreeStartIndex</a></h3>
<pre><code class="language-solidity">function getPriorityTreeStartIndex() external view returns (uint256);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint256</code></td><td>The start index of the priority tree, i.e. the index of the first priority operation that was included into the priority tree.</td></tr>
</tbody></table>
</div>
<h3 id="getprioritytreeroot"><a class="header" href="#getprioritytreeroot">getPriorityTreeRoot</a></h3>
<pre><code class="language-solidity">function getPriorityTreeRoot() external view returns (bytes32);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>bytes32</code></td><td>The root hash of the priority tree</td></tr>
</tbody></table>
</div>
<h3 id="ispriorityqueueactive"><a class="header" href="#ispriorityqueueactive">isPriorityQueueActive</a></h3>
<pre><code class="language-solidity">function isPriorityQueueActive() external view returns (bool);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>bool</code></td><td>Whether the priority queue is active, i.e. whether new priority operations are appended to it. Once the chain processes all the transactions that were present in the priority queue, all the L1-&gt;L2 related operations will start to get done using the priority tree.</td></tr>
</tbody></table>
</div>
<h3 id="getfirstunprocessedprioritytx"><a class="header" href="#getfirstunprocessedprioritytx">getFirstUnprocessedPriorityTx</a></h3>
<p>The function that returns the first unprocessed priority transaction.</p>
<p>Returns zero if and only if no operations were processed from the queue.</p>
<p>If all the transactions were processed, it will return the last processed index, so
in case exactly <em>unprocessed</em> transactions are needed, one should check that getPriorityQueueSize() is greater than 0.</p>
<pre><code class="language-solidity">function getFirstUnprocessedPriorityTx() external view returns (uint256);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint256</code></td><td>Index of the oldest priority operation that wasn't processed yet</td></tr>
</tbody></table>
</div>
<h3 id="getpriorityqueuesize"><a class="header" href="#getpriorityqueuesize">getPriorityQueueSize</a></h3>
<pre><code class="language-solidity">function getPriorityQueueSize() external view returns (uint256);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint256</code></td><td>The number of priority operations currently in the queue</td></tr>
</tbody></table>
</div>
<h3 id="isvalidator"><a class="header" href="#isvalidator">isValidator</a></h3>
<pre><code class="language-solidity">function isValidator(address _address) external view returns (bool);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>bool</code></td><td>Whether the address has a validator access</td></tr>
</tbody></table>
</div>
<h3 id="l2logsroothash"><a class="header" href="#l2logsroothash">l2LogsRootHash</a></h3>
<pre><code class="language-solidity">function l2LogsRootHash(uint256 _batchNumber)
  external
  view
  returns (bytes32 merkleRoot);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>merkleRoot</code></td><td><code>bytes32</code></td><td>Merkle root of the tree with L2 logs for the selected batch</td></tr>
</tbody></table>
</div>
<h3 id="storedbatchhash"><a class="header" href="#storedbatchhash">storedBatchHash</a></h3>
<p>For unfinalized (non executed) batches may change</p>
<p>returns zero for non-committed batches</p>
<pre><code class="language-solidity">function storedBatchHash(uint256 _batchNumber) external view returns (bytes32);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>bytes32</code></td><td>The hash of committed L2 batch.</td></tr>
</tbody></table>
</div>
<h3 id="getl2bootloaderbytecodehash"><a class="header" href="#getl2bootloaderbytecodehash">getL2BootloaderBytecodeHash</a></h3>
<pre><code class="language-solidity">function getL2BootloaderBytecodeHash() external view returns (bytes32);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>bytes32</code></td><td>Bytecode hash of bootloader program.</td></tr>
</tbody></table>
</div>
<h3 id="getl2defaultaccountbytecodehash"><a class="header" href="#getl2defaultaccountbytecodehash">getL2DefaultAccountBytecodeHash</a></h3>
<pre><code class="language-solidity">function getL2DefaultAccountBytecodeHash() external view returns (bytes32);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>bytes32</code></td><td>Bytecode hash of default account (bytecode for EOA).</td></tr>
</tbody></table>
</div>
<h3 id="getl2evmemulatorbytecodehash"><a class="header" href="#getl2evmemulatorbytecodehash">getL2EvmEmulatorBytecodeHash</a></h3>
<pre><code class="language-solidity">function getL2EvmEmulatorBytecodeHash() external view returns (bytes32);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>bytes32</code></td><td>Bytecode hash of EVM emulator.</td></tr>
</tbody></table>
</div>
<h3 id="getverifierparams"><a class="header" href="#getverifierparams">getVerifierParams</a></h3>
<p>This function is deprecated and will soon be removed.</p>
<pre><code class="language-solidity">function getVerifierParams() external view returns (VerifierParams memory);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>VerifierParams</code></td><td>Verifier parameters.</td></tr>
</tbody></table>
</div>
<h3 id="isdiamondstoragefrozen"><a class="header" href="#isdiamondstoragefrozen">isDiamondStorageFrozen</a></h3>
<pre><code class="language-solidity">function isDiamondStorageFrozen() external view returns (bool);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>bool</code></td><td>Whether the diamond is frozen or not</td></tr>
</tbody></table>
</div>
<h3 id="getprotocolversion-1"><a class="header" href="#getprotocolversion-1">getProtocolVersion</a></h3>
<pre><code class="language-solidity">function getProtocolVersion() external view returns (uint256);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint256</code></td><td>The current packed protocol version. To access human-readable version, use <code>getSemverProtocolVersion</code> function.</td></tr>
</tbody></table>
</div>
<h3 id="getsemverprotocolversion-1"><a class="header" href="#getsemverprotocolversion-1">getSemverProtocolVersion</a></h3>
<pre><code class="language-solidity">function getSemverProtocolVersion()
  external
  view
  returns (uint32, uint32, uint32);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint32</code></td><td>The tuple of (major, minor, patch) protocol version.</td></tr>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint32</code></td><td></td></tr>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint32</code></td><td></td></tr>
</tbody></table>
</div>
<h3 id="getl2systemcontractsupgradetxhash"><a class="header" href="#getl2systemcontractsupgradetxhash">getL2SystemContractsUpgradeTxHash</a></h3>
<pre><code class="language-solidity">function getL2SystemContractsUpgradeTxHash() external view returns (bytes32);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>bytes32</code></td><td>The upgrade system contract transaction hash, 0 if the upgrade is not initialized</td></tr>
</tbody></table>
</div>
<h3 id="getl2systemcontractsupgradebatchnumber"><a class="header" href="#getl2systemcontractsupgradebatchnumber">getL2SystemContractsUpgradeBatchNumber</a></h3>
<p>It is equal to 0 in the following two cases:</p>
<ul>
<li>No upgrade transaction has ever been processed.</li>
<li>The upgrade transaction has been processed and the batch with such transaction has been
executed (i.e. finalized).</li>
</ul>
<pre><code class="language-solidity">function getL2SystemContractsUpgradeBatchNumber()
  external
  view
  returns (uint256);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint256</code></td><td>The L2 batch number in which the upgrade transaction was processed.</td></tr>
</tbody></table>
</div>
<h3 id="getprioritytxmaxgaslimit"><a class="header" href="#getprioritytxmaxgaslimit">getPriorityTxMaxGasLimit</a></h3>
<pre><code class="language-solidity">function getPriorityTxMaxGasLimit() external view returns (uint256);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint256</code></td><td>The maximum number of L2 gas that a user can request for L1 -&gt; L2 transactions</td></tr>
</tbody></table>
</div>
<h3 id="isethwithdrawalfinalized"><a class="header" href="#isethwithdrawalfinalized">isEthWithdrawalFinalized</a></h3>
<pre><code class="language-solidity">function isEthWithdrawalFinalized(
  uint256 _l2BatchNumber,
  uint256 _l2MessageIndex
) external view returns (bool);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_l2BatchNumber</code></td><td><code>uint256</code></td><td>The L2 batch number within which the withdrawal happened.</td></tr>
<tr><td><code>_l2MessageIndex</code></td><td><code>uint256</code></td><td>The index of the L2-&gt;L1 message denoting the withdrawal.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>bool</code></td><td>Whether a withdrawal has been finalized.</td></tr>
</tbody></table>
</div>
<h3 id="getpubdatapricingmode"><a class="header" href="#getpubdatapricingmode">getPubdataPricingMode</a></h3>
<pre><code class="language-solidity">function getPubdataPricingMode() external view returns (PubdataPricingMode);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>PubdataPricingMode</code></td><td>The pubdata pricing mode.</td></tr>
</tbody></table>
</div>
<h3 id="basetokengaspricemultipliernominator"><a class="header" href="#basetokengaspricemultipliernominator">baseTokenGasPriceMultiplierNominator</a></h3>
<pre><code class="language-solidity">function baseTokenGasPriceMultiplierNominator()
  external
  view
  returns (uint128);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint128</code></td><td>the baseTokenGasPriceMultiplierNominator, used to compare the baseTokenPrice to ether for L1-&gt;L2 transactions</td></tr>
</tbody></table>
</div>
<h3 id="basetokengaspricemultiplierdenominator"><a class="header" href="#basetokengaspricemultiplierdenominator">baseTokenGasPriceMultiplierDenominator</a></h3>
<pre><code class="language-solidity">function baseTokenGasPriceMultiplierDenominator()
  external
  view
  returns (uint128);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint128</code></td><td>the baseTokenGasPriceMultiplierDenominator, used to compare the baseTokenPrice to ether for L1-&gt;L2 transactions</td></tr>
</tbody></table>
</div>
<h3 id="facets"><a class="header" href="#facets">facets</a></h3>
<pre><code class="language-solidity">function facets() external view returns (Facet[] memory);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>Facet[]</code></td><td>result All facet addresses and their function selectors</td></tr>
</tbody></table>
</div>
<h3 id="facetfunctionselectors"><a class="header" href="#facetfunctionselectors">facetFunctionSelectors</a></h3>
<pre><code class="language-solidity">function facetFunctionSelectors(address _facet)
  external
  view
  returns (bytes4[] memory);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>bytes4[]</code></td><td>NON-sorted array with function selectors supported by a specific facet</td></tr>
</tbody></table>
</div>
<h3 id="facetaddresses"><a class="header" href="#facetaddresses">facetAddresses</a></h3>
<pre><code class="language-solidity">function facetAddresses() external view returns (address[] memory facets);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>facets</code></td><td><code>address[]</code></td><td>NON-sorted array of facet addresses supported on diamond</td></tr>
</tbody></table>
</div>
<h3 id="facetaddress"><a class="header" href="#facetaddress">facetAddress</a></h3>
<pre><code class="language-solidity">function facetAddress(bytes4 _selector) external view returns (address facet);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>facet</code></td><td><code>address</code></td><td>The facet address associated with a selector. Zero if the selector is not added to the diamond</td></tr>
</tbody></table>
</div>
<h3 id="isfunctionfreezable"><a class="header" href="#isfunctionfreezable">isFunctionFreezable</a></h3>
<pre><code class="language-solidity">function isFunctionFreezable(bytes4 _selector) external view returns (bool);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>bool</code></td><td>Whether the selector can be frozen by the admin or always accessible</td></tr>
</tbody></table>
</div>
<h3 id="isfacetfreezable"><a class="header" href="#isfacetfreezable">isFacetFreezable</a></h3>
<pre><code class="language-solidity">function isFacetFreezable(address _facet)
  external
  view
  returns (bool isFreezable);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>isFreezable</code></td><td><code>bool</code></td><td>Whether the facet can be frozen by the admin or always accessible</td></tr>
</tbody></table>
</div>
<h3 id="getsettlementlayer"><a class="header" href="#getsettlementlayer">getSettlementLayer</a></h3>
<pre><code class="language-solidity">function getSettlementLayer() external view returns (address);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>address</code></td><td>The address of the current settlement layer.</td></tr>
</tbody></table>
</div>
<h2 id="structs-5"><a class="header" href="#structs-5">Structs</a></h2>
<h3 id="facet"><a class="header" href="#facet">Facet</a></h3>
<p>Fa—Ået structure compatible with the EIP-2535 diamond loupe</p>
<pre><code class="language-solidity">struct Facet {
  address addr;
  bytes4[] selectors;
}
</code></pre>
<p><strong>Properties</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>addr</code></td><td><code>address</code></td><td>The address of the facet contract</td></tr>
<tr><td><code>selectors</code></td><td><code>bytes4[]</code></td><td>The NON-sorted array with selectors associated with facet</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="il1davalidator"><a class="header" href="#il1davalidator">IL1DAValidator</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/l1-contracts/state-transition/chain-interfaces/IL1DAValidator.sol">Git Source</a></p>
<h2 id="functions-36"><a class="header" href="#functions-36">Functions</a></h2>
<h3 id="checkda"><a class="header" href="#checkda">checkDA</a></h3>
<p>The function that checks the data availability for the given batch input.</p>
<pre><code class="language-solidity">function checkDA(
  uint256 _chainId,
  uint256 _batchNumber,
  bytes32 _l2DAValidatorOutputHash,
  bytes calldata _operatorDAInput,
  uint256 _maxBlobsSupported
) external returns (L1DAValidatorOutput memory output);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_chainId</code></td><td><code>uint256</code></td><td>The chain id of the chain that is being committed.</td></tr>
<tr><td><code>_batchNumber</code></td><td><code>uint256</code></td><td>The batch number for which the data availability is being checked.</td></tr>
<tr><td><code>_l2DAValidatorOutputHash</code></td><td><code>bytes32</code></td><td>The hash of that was returned by the l2DAValidator.</td></tr>
<tr><td><code>_operatorDAInput</code></td><td><code>bytes</code></td><td>The DA input by the operator provided on L1.</td></tr>
<tr><td><code>_maxBlobsSupported</code></td><td><code>uint256</code></td><td>The maximal number of blobs supported by the chain. We provide this value for future compatibility. This is needed because the corresponding <code>blobsLinearHashes</code>/<code>blobsOpeningCommitments</code> in the <code>L1DAValidatorOutput</code> struct will have to have this length as it is required to be static by the circuits.</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="ilegacygetters"><a class="header" href="#ilegacygetters">ILegacyGetters</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/l1-contracts/state-transition/chain-interfaces/ILegacyGetters.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
<a href="contracts/l1-contracts/state-transition/chain-interfaces/ILegacyGetters.sol//contracts/l1-contracts/state-transition/chain-interfaces/IZKChainBase.sol/interface.IZKChainBase.html">IZKChainBase</a></p>
<p><strong>Author:</strong>
Matter Labs</p>
<p>This interface contains getters for the ZKsync contract that should not be used,
but still are kept for backward compatibility.</p>
<p><strong>Note:</strong>
security-contact: security@matterlabs.dev</p>
<h2 id="functions-37"><a class="header" href="#functions-37">Functions</a></h2>
<h3 id="gettotalblockscommitted"><a class="header" href="#gettotalblockscommitted">getTotalBlocksCommitted</a></h3>
<p>It is a <em>deprecated</em> method, please use <code>getTotalBatchesCommitted</code> instead</p>
<pre><code class="language-solidity">function getTotalBlocksCommitted() external view returns (uint256);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint256</code></td><td>The total number of batches that were committed</td></tr>
</tbody></table>
</div>
<h3 id="gettotalblocksverified"><a class="header" href="#gettotalblocksverified">getTotalBlocksVerified</a></h3>
<p>It is a <em>deprecated</em> method, please use <code>getTotalBatchesVerified</code> instead.</p>
<pre><code class="language-solidity">function getTotalBlocksVerified() external view returns (uint256);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint256</code></td><td>The total number of batches that were committed &amp; verified</td></tr>
</tbody></table>
</div>
<h3 id="gettotalblocksexecuted"><a class="header" href="#gettotalblocksexecuted">getTotalBlocksExecuted</a></h3>
<p>It is a <em>deprecated</em> method, please use <code>getTotalBatchesExecuted</code> instead.</p>
<pre><code class="language-solidity">function getTotalBlocksExecuted() external view returns (uint256);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint256</code></td><td>The total number of batches that were committed &amp; verified &amp; executed</td></tr>
</tbody></table>
</div>
<h3 id="storedblockhash"><a class="header" href="#storedblockhash">storedBlockHash</a></h3>
<p>For unfinalized (non executed) batches may change</p>
<p>It is a <em>deprecated</em> method, please use <code>storedBatchHash</code> instead.</p>
<p>returns zero for non-committed batches</p>
<pre><code class="language-solidity">function storedBlockHash(uint256 _batchNumber) external view returns (bytes32);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>bytes32</code></td><td>The hash of committed L2 batch.</td></tr>
</tbody></table>
</div>
<h3 id="getl2systemcontractsupgradeblocknumber"><a class="header" href="#getl2systemcontractsupgradeblocknumber">getL2SystemContractsUpgradeBlockNumber</a></h3>
<p>It is a <em>deprecated</em> method, please use <code>getL2SystemContractsUpgradeBatchNumber</code> instead.</p>
<p>It is equal to 0 in the following two cases:</p>
<ul>
<li>No upgrade transaction has ever been processed.</li>
<li>The upgrade transaction has been processed and the batch with such transaction has been
executed (i.e. finalized).</li>
</ul>
<pre><code class="language-solidity">function getL2SystemContractsUpgradeBlockNumber()
  external
  view
  returns (uint256);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint256</code></td><td>The L2 batch number in which the upgrade transaction was processed.</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="imailbox"><a class="header" href="#imailbox">IMailbox</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/l1-contracts/state-transition/chain-interfaces/IMailbox.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
<a href="contracts/l1-contracts/state-transition/chain-interfaces/IMailbox.sol//contracts/l1-contracts/state-transition/chain-interfaces/IMessageVerification.sol/interface.IMessageVerification.html">IMessageVerification</a>, <a href="contracts/l1-contracts/state-transition/chain-interfaces/IMailbox.sol//contracts/l1-contracts/state-transition/chain-interfaces/IMailboxImpl.sol/interface.IMailboxImpl.html">IMailboxImpl</a></p>
<p><strong>Title:</strong>
The interface of the ZKsync Mailbox contract that provides interfaces for L1 &lt;-&gt; L2 interaction.</p>
<p><strong>Author:</strong>
Matter Labs</p>
<p><strong>Note:</strong>
security-contact: security@matterlabs.dev</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="itransactionfilterer"><a class="header" href="#itransactionfilterer">ITransactionFilterer</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/l1-contracts/state-transition/chain-interfaces/ITransactionFilterer.sol">Git Source</a></p>
<p><strong>Title:</strong>
The interface of the L1 -&gt; L2 transaction filterer.</p>
<p><strong>Author:</strong>
Matter Labs</p>
<p><strong>Note:</strong>
security-contact: security@matterlabs.dev</p>
<h2 id="functions-38"><a class="header" href="#functions-38">Functions</a></h2>
<h3 id="istransactionallowed"><a class="header" href="#istransactionallowed">isTransactionAllowed</a></h3>
<p>Check if the transaction is allowed</p>
<pre><code class="language-solidity">function isTransactionAllowed(
  address sender,
  address contractL2,
  uint256 mintValue,
  uint256 l2Value,
  bytes memory l2Calldata,
  address refundRecipient
) external view returns (bool);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>sender</code></td><td><code>address</code></td><td>The sender of the transaction</td></tr>
<tr><td><code>contractL2</code></td><td><code>address</code></td><td>The L2 receiver address</td></tr>
<tr><td><code>mintValue</code></td><td><code>uint256</code></td><td>The value of the L1 transaction</td></tr>
<tr><td><code>l2Value</code></td><td><code>uint256</code></td><td>The msg.value of the L2 transaction</td></tr>
<tr><td><code>l2Calldata</code></td><td><code>bytes</code></td><td>The calldata of the L2 transaction</td></tr>
<tr><td><code>refundRecipient</code></td><td><code>address</code></td><td>The address to refund the excess value</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>bool</code></td><td>Whether the transaction is allowed</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="iverifier"><a class="header" href="#iverifier">IVerifier</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/l1-contracts/state-transition/chain-interfaces/IVerifier.sol">Git Source</a></p>
<p><strong>Title:</strong>
The interface of the Verifier contract, responsible for the zero knowledge proof verification.</p>
<p><strong>Author:</strong>
Matter Labs</p>
<p><strong>Note:</strong>
security-contact: security@matterlabs.dev</p>
<h2 id="functions-39"><a class="header" href="#functions-39">Functions</a></h2>
<h3 id="verify"><a class="header" href="#verify">verify</a></h3>
<p>Verifies a zk-SNARK proof.</p>
<pre><code class="language-solidity">function verify(uint256[] calldata _publicInputs, uint256[] calldata _proof)
  external
  view
  returns (bool);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>bool</code></td><td>A boolean value indicating whether the zk-SNARK proof is valid. Note: The function may revert execution instead of returning false in some cases.</td></tr>
</tbody></table>
</div>
<h3 id="verificationkeyhash"><a class="header" href="#verificationkeyhash">verificationKeyHash</a></h3>
<p>Calculates a keccak256 hash of the runtime loaded verification keys.</p>
<pre><code class="language-solidity">function verificationKeyHash() external view returns (bytes32);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>bytes32</code></td><td>vkHash The keccak256 hash of the loaded verification keys.</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="iverifierv2"><a class="header" href="#iverifierv2">IVerifierV2</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/l1-contracts/state-transition/chain-interfaces/IVerifierV2.sol">Git Source</a></p>
<p><strong>Title:</strong>
The interface of the Verifier contract, responsible for the zero knowledge proof verification.</p>
<p><strong>Author:</strong>
Matter Labs</p>
<p><strong>Note:</strong>
security-contact: security@matterlabs.dev</p>
<h2 id="functions-40"><a class="header" href="#functions-40">Functions</a></h2>
<h3 id="verify-1"><a class="header" href="#verify-1">verify</a></h3>
<p>Verifies a zk-SNARK proof.</p>
<pre><code class="language-solidity">function verify(uint256[] calldata _publicInputs, uint256[] calldata _proof)
  external
  view
  returns (bool);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>bool</code></td><td>A boolean value indicating whether the zk-SNARK proof is valid. Note: The function may revert execution instead of returning false in some cases.</td></tr>
</tbody></table>
</div>
<h3 id="verificationkeyhash-1"><a class="header" href="#verificationkeyhash-1">verificationKeyHash</a></h3>
<p>Calculates a keccak256 hash of the runtime loaded verification keys.</p>
<pre><code class="language-solidity">function verificationKeyHash() external view returns (bytes32);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>bytes32</code></td><td>vkHash The keccak256 hash of the loaded verification keys.</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="izkchain"><a class="header" href="#izkchain">IZKChain</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/l1-contracts/state-transition/chain-interfaces/IZKChain.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
<a href="contracts/l1-contracts/state-transition/chain-interfaces/IZKChain.sol//contracts/l1-contracts/state-transition/chain-interfaces/IAdmin.sol/interface.IAdmin.html">IAdmin</a>, <a href="contracts/l1-contracts/state-transition/chain-interfaces/IZKChain.sol//contracts/l1-contracts/state-transition/chain-interfaces/IExecutor.sol/interface.IExecutor.html">IExecutor</a>, <a href="contracts/l1-contracts/state-transition/chain-interfaces/IZKChain.sol//contracts/l1-contracts/state-transition/chain-interfaces/IGetters.sol/interface.IGetters.html">IGetters</a>, <a href="contracts/l1-contracts/state-transition/chain-interfaces/IZKChain.sol//contracts/system-contracts/interfaces/IMailbox.sol/interface.IMailbox.html">IMailbox</a></p>
<h2 id="events-25"><a class="header" href="#events-25">Events</a></h2>
<h3 id="proposetransparentupgrade"><a class="header" href="#proposetransparentupgrade">ProposeTransparentUpgrade</a></h3>
<pre><code class="language-solidity">event ProposeTransparentUpgrade(
  Diamond.DiamondCutData diamondCut,
  uint256 indexed proposalId,
  bytes32 proposalSalt
);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="izkchainbase"><a class="header" href="#izkchainbase">IZKChainBase</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/l1-contracts/state-transition/chain-interfaces/IZKChainBase.sol">Git Source</a></p>
<p><strong>Title:</strong>
The interface of the ZKsync contract, responsible for the main ZKsync logic.</p>
<p><strong>Author:</strong>
Matter Labs</p>
<p><strong>Note:</strong>
security-contact: security@matterlabs.dev</p>
<h2 id="functions-41"><a class="header" href="#functions-41">Functions</a></h2>
<h3 id="getname-1"><a class="header" href="#getname-1">getName</a></h3>
<pre><code class="language-solidity">function getName() external view returns (string memory);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>string</code></td><td>Returns facet name.</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="imailboximpl"><a class="header" href="#imailboximpl">IMailboxImpl</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/l1-contracts/state-transition/chain-interfaces/IMailboxImpl.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
<a href="contracts/l1-contracts/state-transition/chain-interfaces/IMailboxImpl.sol//contracts/l1-contracts/state-transition/chain-interfaces/IZKChainBase.sol/interface.IZKChainBase.html">IZKChainBase</a></p>
<p><strong>Title:</strong>
The interface of the ZKsync Mailbox contract that provides functions for L1 &lt;-&gt; L2 interaction.</p>
<p><strong>Author:</strong>
Matter Labs</p>
<p><strong>Note:</strong>
security-contact: security@matterlabs.dev</p>
<h2 id="functions-42"><a class="header" href="#functions-42">Functions</a></h2>
<h3 id="provel2messageinclusion-1"><a class="header" href="#provel2messageinclusion-1">proveL2MessageInclusion</a></h3>
<p>Prove that a specific arbitrary-length message was sent in a specific L2 batch number.</p>
<pre><code class="language-solidity">function proveL2MessageInclusion(
  uint256 _batchNumber,
  uint256 _index,
  L2Message calldata _message,
  bytes32[] calldata _proof
) external view returns (bool);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_batchNumber</code></td><td><code>uint256</code></td><td>The executed L2 batch number in which the message appeared.</td></tr>
<tr><td><code>_index</code></td><td><code>uint256</code></td><td>The position in the L2 logs Merkle tree of the l2Log that was sent with the message.</td></tr>
<tr><td><code>_message</code></td><td><code>L2Message</code></td><td>Information about the sent message: sender address, the message itself, tx index in the L2 batch where the message was sent.</td></tr>
<tr><td><code>_proof</code></td><td><code>bytes32[]</code></td><td>Merkle proof for inclusion of L2 log that was sent with the message.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>bool</code></td><td>Boolean specifying whether the proof is valid.</td></tr>
</tbody></table>
</div>
<h3 id="provel2loginclusion-1"><a class="header" href="#provel2loginclusion-1">proveL2LogInclusion</a></h3>
<p>Prove that a specific L2 log was sent in a specific L2 batch.</p>
<pre><code class="language-solidity">function proveL2LogInclusion(
  uint256 _batchNumber,
  uint256 _index,
  L2Log calldata _log,
  bytes32[] calldata _proof
) external view returns (bool);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_batchNumber</code></td><td><code>uint256</code></td><td>The executed L2 batch number in which the log appeared.</td></tr>
<tr><td><code>_index</code></td><td><code>uint256</code></td><td>The position of the l2log in the L2 logs Merkle tree.</td></tr>
<tr><td><code>_log</code></td><td><code>L2Log</code></td><td>Information about the sent log.</td></tr>
<tr><td><code>_proof</code></td><td><code>bytes32[]</code></td><td>Merkle proof for inclusion of the L2 log.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>bool</code></td><td>Whether the proof is correct and L2 log is included in batch.</td></tr>
</tbody></table>
</div>
<h3 id="provel1tol2transactionstatus-1"><a class="header" href="#provel1tol2transactionstatus-1">proveL1ToL2TransactionStatus</a></h3>
<p>Prove that the L1 -&gt; L2 transaction was processed with the specified status.</p>
<pre><code class="language-solidity">function proveL1ToL2TransactionStatus(
  bytes32 _l2TxHash,
  uint256 _l2BatchNumber,
  uint256 _l2MessageIndex,
  uint16 _l2TxNumberInBatch,
  bytes32[] calldata _merkleProof,
  TxStatus _status
) external view returns (bool);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_l2TxHash</code></td><td><code>bytes32</code></td><td>The L2 canonical transaction hash.</td></tr>
<tr><td><code>_l2BatchNumber</code></td><td><code>uint256</code></td><td>The L2 batch number where the transaction was processed.</td></tr>
<tr><td><code>_l2MessageIndex</code></td><td><code>uint256</code></td><td>The position in the L2 logs Merkle tree of the l2Log that was sent with the message.</td></tr>
<tr><td><code>_l2TxNumberInBatch</code></td><td><code>uint16</code></td><td>The L2 transaction number in the batch, in which the log was sent.</td></tr>
<tr><td><code>_merkleProof</code></td><td><code>bytes32[]</code></td><td>The Merkle proof of the processing L1 -&gt; L2 transaction.</td></tr>
<tr><td><code>_status</code></td><td><code>TxStatus</code></td><td>The execution status of the L1 -&gt; L2 transaction (true - success &amp; 0 - fail).</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>bool</code></td><td>Whether the proof is correct and the transaction was actually executed with provided status. NOTE: It may return <code>false</code> for incorrect proof, but it doesn't mean that the L1 -&gt; L2 transaction has an opposite status!</td></tr>
</tbody></table>
</div>
<h3 id="finalizeethwithdrawal"><a class="header" href="#finalizeethwithdrawal">finalizeEthWithdrawal</a></h3>
<p>Finalize the withdrawal and release funds.</p>
<pre><code class="language-solidity">function finalizeEthWithdrawal(
  uint256 _l2BatchNumber,
  uint256 _l2MessageIndex,
  uint16 _l2TxNumberInBatch,
  bytes calldata _message,
  bytes32[] calldata _merkleProof
) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_l2BatchNumber</code></td><td><code>uint256</code></td><td>The L2 batch number where the withdrawal was processed.</td></tr>
<tr><td><code>_l2MessageIndex</code></td><td><code>uint256</code></td><td>The position in the L2 logs Merkle tree of the l2Log that was sent with the message.</td></tr>
<tr><td><code>_l2TxNumberInBatch</code></td><td><code>uint16</code></td><td>The L2 transaction number in a batch, in which the log was sent.</td></tr>
<tr><td><code>_message</code></td><td><code>bytes</code></td><td>The L2 withdraw data, stored in an L2 -&gt; L1 message.</td></tr>
<tr><td><code>_merkleProof</code></td><td><code>bytes32[]</code></td><td>The Merkle proof of the inclusion L2 -&gt; L1 message about withdrawal initialization.</td></tr>
</tbody></table>
</div>
<h3 id="requestl2transaction"><a class="header" href="#requestl2transaction">requestL2Transaction</a></h3>
<p>Request execution of L2 transaction from L1.</p>
<p>If the L2 deposit finalization transaction fails, the <code>_refundRecipient</code> will receive the <code>_l2Value</code>.
Please note, the contract may change the refund recipient's address to eliminate sending funds to addresses out of control.</p>
<ul>
<li>If <code>_refundRecipient</code> is a contract on L1, the refund will be sent to the aliased <code>_refundRecipient</code>.</li>
<li>If <code>_refundRecipient</code> is set to <code>address(0)</code> and the sender has NO deployed bytecode on L1, the refund will be sent to the <code>msg.sender</code> address.</li>
<li>If <code>_refundRecipient</code> is set to <code>address(0)</code> and the sender has deployed bytecode on L1, the refund will be sent to the aliased <code>msg.sender</code> address.</li>
</ul>
<p>The address aliasing of L1 contracts as refund recipient on L2 is necessary to guarantee that the funds are controllable,
since address aliasing to the from address for the L2 tx will be applied if the L1 <code>msg.sender</code> is a contract.
Without address aliasing for L1 contracts as refund recipients they would not be able to make proper L2 tx requests
through the Mailbox to use or withdraw the funds from L2, and the funds would be lost.</p>
<pre><code class="language-solidity">function requestL2Transaction(
  address _contractL2,
  uint256 _l2Value,
  bytes calldata _calldata,
  uint256 _l2GasLimit,
  uint256 _l2GasPerPubdataByteLimit,
  bytes[] calldata _factoryDeps,
  address _refundRecipient
) external payable returns (bytes32 canonicalTxHash);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_contractL2</code></td><td><code>address</code></td><td>The L2 receiver address.</td></tr>
<tr><td><code>_l2Value</code></td><td><code>uint256</code></td><td><code>msg.value</code> of L2 transaction.</td></tr>
<tr><td><code>_calldata</code></td><td><code>bytes</code></td><td>The input of the L2 transaction.</td></tr>
<tr><td><code>_l2GasLimit</code></td><td><code>uint256</code></td><td>Maximum amount of L2 gas that transaction can consume during execution on L2.</td></tr>
<tr><td><code>_l2GasPerPubdataByteLimit</code></td><td><code>uint256</code></td><td>The maximum amount L2 gas that the operator may charge the user for single byte of pubdata.</td></tr>
<tr><td><code>_factoryDeps</code></td><td><code>bytes[]</code></td><td>An array of L2 bytecodes that will be marked as known on L2.</td></tr>
<tr><td><code>_refundRecipient</code></td><td><code>address</code></td><td>The address on L2 that will receive the refund for the transaction.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>canonicalTxHash</code></td><td><code>bytes32</code></td><td>The hash of the requested L2 transaction. This hash can be used to follow the transaction status.</td></tr>
</tbody></table>
</div>
<h3 id="bridgehubrequestl2transaction"><a class="header" href="#bridgehubrequestl2transaction">bridgehubRequestL2Transaction</a></h3>
<p>Request execution of L2 transaction through the Bridgehub.</p>
<p>Only accessible from L1, this is getting checked in the Bridgehub.</p>
<pre><code class="language-solidity">function bridgehubRequestL2Transaction(BridgehubL2TransactionRequest calldata _request)
  external
  returns (bytes32 canonicalTxHash);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_request</code></td><td><code>BridgehubL2TransactionRequest</code></td><td>the request for the L2 transaction.</td></tr>
</tbody></table>
</div>
<h3 id="bridgehubrequestl2transactionongateway"><a class="header" href="#bridgehubrequestl2transactionongateway">bridgehubRequestL2TransactionOnGateway</a></h3>
<p>The chain's mailbox receives the tx from the Bridgehub on Gateway.</p>
<pre><code class="language-solidity">function bridgehubRequestL2TransactionOnGateway(
  bytes32 _canonicalTxHash,
  uint64 _expirationTimestamp
) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_canonicalTxHash</code></td><td><code>bytes32</code></td><td>the canonical transaction hash.</td></tr>
<tr><td><code>_expirationTimestamp</code></td><td><code>uint64</code></td><td>the expiration timestamp for the transaction.</td></tr>
</tbody></table>
</div>
<h3 id="requestl2servicetransaction"><a class="header" href="#requestl2servicetransaction">requestL2ServiceTransaction</a></h3>
<p>Request execution of service L2 transaction from L1.</p>
<p>Used for chain configuration. Can be called only by DiamondProxy itself.</p>
<pre><code class="language-solidity">function requestL2ServiceTransaction(
  address _contractL2,
  bytes calldata _l2Calldata
) external returns (bytes32 canonicalTxHash);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_contractL2</code></td><td><code>address</code></td><td>The L2 receiver address.</td></tr>
<tr><td><code>_l2Calldata</code></td><td><code>bytes</code></td><td>The input of the L2 transaction.</td></tr>
</tbody></table>
</div>
<h3 id="requestl2transactiontogatewaymailbox"><a class="header" href="#requestl2transactiontogatewaymailbox">requestL2TransactionToGatewayMailbox</a></h3>
<p>On L1 we have to forward to the Gateway's mailbox which sends to the Bridgehub on the Gateway.</p>
<pre><code class="language-solidity">function requestL2TransactionToGatewayMailbox(
  uint256 _chainId,
  bytes32 _canonicalTxHash,
  uint64 _expirationTimestamp
) external returns (bytes32 canonicalTxHash);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_chainId</code></td><td><code>uint256</code></td><td>the chainId of the chain.</td></tr>
<tr><td><code>_canonicalTxHash</code></td><td><code>bytes32</code></td><td>the canonical transaction hash.</td></tr>
<tr><td><code>_expirationTimestamp</code></td><td><code>uint64</code></td><td>the expiration timestamp.</td></tr>
</tbody></table>
</div>
<h3 id="l2transactionbasecost-1"><a class="header" href="#l2transactionbasecost-1">l2TransactionBaseCost</a></h3>
<p>Estimates the cost in Ether of requesting execution of an L2 transaction from L1.</p>
<pre><code class="language-solidity">function l2TransactionBaseCost(
  uint256 _gasPrice,
  uint256 _l2GasLimit,
  uint256 _l2GasPerPubdataByteLimit
) external view returns (uint256);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_gasPrice</code></td><td><code>uint256</code></td><td>expected L1 gas price at which the user requests the transaction execution.</td></tr>
<tr><td><code>_l2GasLimit</code></td><td><code>uint256</code></td><td>Maximum amount of L2 gas that transaction can consume during execution on L2.</td></tr>
<tr><td><code>_l2GasPerPubdataByteLimit</code></td><td><code>uint256</code></td><td>The maximum amount of L2 gas that the operator may charge the user for a single byte of pubdata.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint256</code></td><td>The estimated ETH spent on L2 gas for the transaction.</td></tr>
</tbody></table>
</div>
<h3 id="provel2leafinclusion"><a class="header" href="#provel2leafinclusion">proveL2LeafInclusion</a></h3>
<p>Proves that a certain leaf was included as part of the log merkle tree.</p>
<p>Warning: this function does not enforce any additional checks on the structure
of the leaf. This means that it can accept intermediate nodes of the Merkle tree as a <code>_leaf</code> as
well as the default "empty" leaves. It is the responsibility of the caller to ensure that the
<code>_leaf</code> is a hash of a valid leaf.</p>
<pre><code class="language-solidity">function proveL2LeafInclusion(
  uint256 _batchNumber,
  uint256 _leafProofMask,
  bytes32 _leaf,
  bytes32[] calldata _proof
) external view returns (bool);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_batchNumber</code></td><td><code>uint256</code></td><td>The batch number of the leaf to be proven.</td></tr>
<tr><td><code>_leafProofMask</code></td><td><code>uint256</code></td><td>The leaf proof mask.</td></tr>
<tr><td><code>_leaf</code></td><td><code>bytes32</code></td><td>The leaf to be proven.</td></tr>
<tr><td><code>_proof</code></td><td><code>bytes32[]</code></td><td>The proof.</td></tr>
</tbody></table>
</div>
<h2 id="events-26"><a class="header" href="#events-26">Events</a></h2>
<h3 id="newpriorityrequest"><a class="header" href="#newpriorityrequest">NewPriorityRequest</a></h3>
<p>New priority request event. Emitted when a request is placed into the priority queue.</p>
<pre><code class="language-solidity">event NewPriorityRequest(
  uint256 txId,
  bytes32 txHash,
  uint64 expirationTimestamp,
  L2CanonicalTransaction transaction,
  bytes[] factoryDeps
);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>txId</code></td><td><code>uint256</code></td><td>Serial number of the priority operation.</td></tr>
<tr><td><code>txHash</code></td><td><code>bytes32</code></td><td>keccak256 hash of encoded transaction representation.</td></tr>
<tr><td><code>expirationTimestamp</code></td><td><code>uint64</code></td><td>Timestamp up to which priority request should be processed.</td></tr>
<tr><td><code>transaction</code></td><td><code>L2CanonicalTransaction</code></td><td>The whole transaction structure that is requested to be executed on L2.</td></tr>
<tr><td><code>factoryDeps</code></td><td><code>bytes[]</code></td><td>An array of bytecodes that were shown in the L1 public data. Will be marked as known bytecodes in L2.</td></tr>
</tbody></table>
</div>
<h3 id="newrelayedprioritytransaction"><a class="header" href="#newrelayedprioritytransaction">NewRelayedPriorityTransaction</a></h3>
<p>New relayed priority request event. It is emitted on a chain that is deployed
on top of the gateway when it receives a request relayed via the Bridgehub.</p>
<p>IMPORTANT: this event most likely will be removed in the future, so
no one should rely on it for indexing purposes.</p>
<pre><code class="language-solidity">event NewRelayedPriorityTransaction(
  uint256 txId, bytes32 txHash, uint64 expirationTimestamp
);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>txId</code></td><td><code>uint256</code></td><td>Serial number of the priority operation.</td></tr>
<tr><td><code>txHash</code></td><td><code>bytes32</code></td><td>keccak256 hash of encoded transaction representation.</td></tr>
<tr><td><code>expirationTimestamp</code></td><td><code>uint64</code></td><td>Timestamp up to which priority request should be processed.</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="imessageverification"><a class="header" href="#imessageverification">IMessageVerification</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/l1-contracts/state-transition/chain-interfaces/IMessageVerification.sol">Git Source</a></p>
<p><strong>Title:</strong>
The interface of the ZKsync MessageVerification contract that can be used to prove L2 message inclusion.</p>
<p><strong>Author:</strong>
Matter Labs</p>
<p><strong>Note:</strong>
security-contact: security@matterlabs.dev</p>
<h2 id="functions-43"><a class="header" href="#functions-43">Functions</a></h2>
<h3 id="provel2messageinclusionshared"><a class="header" href="#provel2messageinclusionshared">proveL2MessageInclusionShared</a></h3>
<p>Prove that a specific arbitrary-length message was sent in a specific L2 batch/block number.</p>
<pre><code class="language-solidity">function proveL2MessageInclusionShared(
  uint256 _chainId,
  uint256 _blockOrBatchNumber,
  uint256 _index,
  L2Message calldata _message,
  bytes32[] calldata _proof
) external view returns (bool);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_chainId</code></td><td><code>uint256</code></td><td>The chain id of the L2 where the message comes from.</td></tr>
<tr><td><code>_blockOrBatchNumber</code></td><td><code>uint256</code></td><td>The executed L2 batch/block number in which the message appeared.</td></tr>
<tr><td><code>_index</code></td><td><code>uint256</code></td><td>The position in the L2 logs Merkle tree of the l2Log that was sent with the message.</td></tr>
<tr><td><code>_message</code></td><td><code>L2Message</code></td><td>Information about the sent message: sender address, the message itself, tx index in the L2 batch where the message was sent.</td></tr>
<tr><td><code>_proof</code></td><td><code>bytes32[]</code></td><td>Merkle proof for inclusion of L2 log that was sent with the message.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>bool</code></td><td>Boolean specifying whether the proof is valid.</td></tr>
</tbody></table>
</div>
<h3 id="provel2loginclusionshared"><a class="header" href="#provel2loginclusionshared">proveL2LogInclusionShared</a></h3>
<p>Prove that a specific L2 log was sent in a specific L2 batch.</p>
<pre><code class="language-solidity">function proveL2LogInclusionShared(
  uint256 _chainId,
  uint256 _blockOrBatchNumber,
  uint256 _index,
  L2Log calldata _log,
  bytes32[] calldata _proof
) external view returns (bool);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_chainId</code></td><td><code>uint256</code></td><td>The chain id of the L2 where the log comes from.</td></tr>
<tr><td><code>_blockOrBatchNumber</code></td><td><code>uint256</code></td><td>The executed L2 batch/block number in which the log appeared.</td></tr>
<tr><td><code>_index</code></td><td><code>uint256</code></td><td>The position of the l2log in the L2 logs Merkle tree.</td></tr>
<tr><td><code>_log</code></td><td><code>L2Log</code></td><td>Information about the sent log.</td></tr>
<tr><td><code>_proof</code></td><td><code>bytes32[]</code></td><td>Merkle proof for inclusion of the L2 log.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>bool</code></td><td>Whether the proof is correct and L2 log is included in batch.</td></tr>
</tbody></table>
</div>
<h3 id="provel2leafinclusionshared"><a class="header" href="#provel2leafinclusionshared">proveL2LeafInclusionShared</a></h3>
<p>Proves that a certain leaf was included as part of the log merkle tree.</p>
<p>Warning: this function does not enforce any additional checks on the structure
of the leaf. This means that it can accept intermediate nodes of the Merkle tree as a <code>_leaf</code> as
well as the default "empty" leaves. It is the responsibility of the caller to ensure that the
<code>_leaf</code> is a hash of a valid leaf.</p>
<pre><code class="language-solidity">function proveL2LeafInclusionShared(
  uint256 _chainId,
  uint256 _blockOrBatchNumber,
  uint256 _leafProofMask,
  bytes32 _leaf,
  bytes32[] calldata _proof
) external view returns (bool);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_chainId</code></td><td><code>uint256</code></td><td>The chain id of the L2 where the leaf comes from.</td></tr>
<tr><td><code>_blockOrBatchNumber</code></td><td><code>uint256</code></td><td>The batch/block number of the leaf to be proven.</td></tr>
<tr><td><code>_leafProofMask</code></td><td><code>uint256</code></td><td>The leaf proof mask.</td></tr>
<tr><td><code>_leaf</code></td><td><code>bytes32</code></td><td>The leaf to be proven.</td></tr>
<tr><td><code>_proof</code></td><td><code>bytes32[]</code></td><td>The proof.</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="contents-11"><a class="header" href="#contents-11">Contents</a></h1>
<ul>
<li><a href="contracts/l1-contracts/state-transition/l2-deps/IComplexUpgrader.sol/interface.IComplexUpgrader.html">IComplexUpgrader</a></li>
<li><a href="contracts/l1-contracts/state-transition/l2-deps/IL2GatewayUpgrade.sol/interface.IL2GatewayUpgrade.html">IL2GatewayUpgrade</a></li>
<li><a href="contracts/l1-contracts/state-transition/l2-deps/IL2GenesisUpgrade.sol/struct.ForceDeployment.html">ForceDeployment</a></li>
<li><a href="contracts/l1-contracts/state-transition/l2-deps/IL2GenesisUpgrade.sol/struct.ZKChainSpecificForceDeploymentsData.html">ZKChainSpecificForceDeploymentsData</a></li>
<li><a href="contracts/l1-contracts/state-transition/l2-deps/IL2GenesisUpgrade.sol/struct.FixedForceDeploymentsData.html">FixedForceDeploymentsData</a></li>
<li><a href="contracts/l1-contracts/state-transition/l2-deps/IL2GenesisUpgrade.sol/interface.IL2GenesisUpgrade.html">IL2GenesisUpgrade</a></li>
<li><a href="contracts/l1-contracts/state-transition/l2-deps/ISystemContext.sol/interface.ISystemContext.html">ISystemContext</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="icomplexupgrader"><a class="header" href="#icomplexupgrader">IComplexUpgrader</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/l1-contracts/state-transition/l2-deps/IComplexUpgrader.sol">Git Source</a></p>
<p><strong>Author:</strong>
Matter Labs</p>
<p><strong>Note:</strong>
security-contact: security@matterlabs.dev</p>
<h2 id="functions-44"><a class="header" href="#functions-44">Functions</a></h2>
<h3 id="forcedeployandupgrade"><a class="header" href="#forcedeployandupgrade">forceDeployAndUpgrade</a></h3>
<pre><code class="language-solidity">function forceDeployAndUpgrade(
  IL2ContractDeployer.ForceDeployment[] calldata _forceDeployments,
  address _delegateTo,
  bytes calldata _calldata
) external payable;
</code></pre>
<h3 id="upgrade"><a class="header" href="#upgrade">upgrade</a></h3>
<pre><code class="language-solidity">function upgrade(address _delegateTo, bytes calldata _calldata)
  external
  payable;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="il2gatewayupgrade"><a class="header" href="#il2gatewayupgrade">IL2GatewayUpgrade</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/l1-contracts/state-transition/l2-deps/IL2GatewayUpgrade.sol">Git Source</a></p>
<h2 id="functions-45"><a class="header" href="#functions-45">Functions</a></h2>
<h3 id="upgrade-1"><a class="header" href="#upgrade-1">upgrade</a></h3>
<pre><code class="language-solidity">function upgrade(
  IL2ContractDeployer.ForceDeployment[] calldata _forceDeployments,
  address _ctmDeployer,
  bytes calldata _fixedForceDeploymentsData,
  bytes calldata _additionalForceDeploymentsData
) external payable;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="il2genesisupgrade"><a class="header" href="#il2genesisupgrade">IL2GenesisUpgrade</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/l1-contracts/state-transition/l2-deps/IL2GenesisUpgrade.sol">Git Source</a></p>
<p><strong>Author:</strong>
Matter Labs</p>
<p><strong>Note:</strong>
security-contact: security@matterlabs.dev</p>
<h2 id="functions-46"><a class="header" href="#functions-46">Functions</a></h2>
<h3 id="genesisupgrade-2"><a class="header" href="#genesisupgrade-2">genesisUpgrade</a></h3>
<pre><code class="language-solidity">function genesisUpgrade(
  uint256 _chainId,
  address _ctmDeployer,
  bytes calldata _fixedForceDeploymentsData,
  bytes calldata _additionalForceDeploymentsData
) external payable;
</code></pre>
<h2 id="events-27"><a class="header" href="#events-27">Events</a></h2>
<h3 id="upgradecomplete"><a class="header" href="#upgradecomplete">UpgradeComplete</a></h3>
<pre><code class="language-solidity">event UpgradeComplete(uint256 _chainId);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="isystemcontext"><a class="header" href="#isystemcontext">ISystemContext</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/l1-contracts/state-transition/l2-deps/ISystemContext.sol">Git Source</a></p>
<p><strong>Author:</strong>
Matter Labs</p>
<p><strong>Note:</strong>
security-contact: security@matterlabs.dev</p>
<h2 id="functions-47"><a class="header" href="#functions-47">Functions</a></h2>
<h3 id="setchainid"><a class="header" href="#setchainid">setChainId</a></h3>
<pre><code class="language-solidity">function setChainId(uint256 _newChainId) external;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="contents-12"><a class="header" href="#contents-12">Contents</a></h1>
<ul>
<li><a href="contracts/l1-contracts/vendor/AddressAliasHelper.sol/library.AddressAliasHelper.html">AddressAliasHelper</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="addressaliashelper"><a class="header" href="#addressaliashelper">AddressAliasHelper</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/l1-contracts/vendor/AddressAliasHelper.sol">Git Source</a></p>
<h2 id="state-variables-1"><a class="header" href="#state-variables-1">State Variables</a></h2>
<h3 id="offset"><a class="header" href="#offset">offset</a></h3>
<pre><code class="language-solidity">uint160 private constant offset =
  uint160(0x1111000000000000000000000000000000001111)
</code></pre>
<h2 id="functions-48"><a class="header" href="#functions-48">Functions</a></h2>
<h3 id="applyl1tol2alias"><a class="header" href="#applyl1tol2alias">applyL1ToL2Alias</a></h3>
<p>Utility function converts the address that submitted a tx
to the inbox on L1 to the msg.sender viewed on L2</p>
<pre><code class="language-solidity">function applyL1ToL2Alias(address l1Address)
  internal
  pure
  returns (address l2Address);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>l1Address</code></td><td><code>address</code></td><td>the address in the L1 that triggered the tx to L2</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>l2Address</code></td><td><code>address</code></td><td>L2 address as viewed in msg.sender</td></tr>
</tbody></table>
</div>
<h3 id="undol1tol2alias"><a class="header" href="#undol1tol2alias">undoL1ToL2Alias</a></h3>
<p>Utility function that converts the msg.sender viewed on L2 to the
address that submitted a tx to the inbox on L1</p>
<pre><code class="language-solidity">function undoL1ToL2Alias(address l2Address)
  internal
  pure
  returns (address l1Address);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>l2Address</code></td><td><code>address</code></td><td>L2 address as viewed in msg.sender</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>l1Address</code></td><td><code>address</code></td><td>the address in the L1 that triggered the tx to L2</td></tr>
</tbody></table>
</div>
<h3 id="actualrefundrecipient"><a class="header" href="#actualrefundrecipient">actualRefundRecipient</a></h3>
<p>Utility function used to calculate the correct refund recipient</p>
<pre><code class="language-solidity">function actualRefundRecipient(
  address _refundRecipient,
  address _originalCaller
) internal view returns (address _recipient);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_refundRecipient</code></td><td><code>address</code></td><td>the address that should receive the refund</td></tr>
<tr><td><code>_originalCaller</code></td><td><code>address</code></td><td>the address that triggered the tx to L2</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_recipient</code></td><td><code>address</code></td><td>the corrected address that should receive the refund</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="contents-13"><a class="header" href="#contents-13">Contents</a></h1>
<ul>
<li><a href="contracts/l2-contracts//contracts/l2-contracts/data-availability">data-availability</a></li>
<li><a href="contracts/l2-contracts//contracts/l2-contracts/errors">errors</a></li>
<li><a href="contracts/l2-contracts//contracts/l2-contracts/interfaces">interfaces</a></li>
<li><a href="contracts/l2-contracts//contracts/l2-contracts/vendor">vendor</a></li>
<li><a href="contracts/l2-contracts/L2ContractHelper.sol/interface.IL1Messenger.html">IL1Messenger</a></li>
<li><a href="contracts/l2-contracts/L2ContractHelper.sol/interface.IContractDeployer.html">IContractDeployer</a></li>
<li><a href="contracts/l2-contracts/L2ContractHelper.sol/interface.IBaseToken.html">IBaseToken</a></li>
<li><a href="contracts/l2-contracts/L2ContractHelper.sol/interface.ICompressor.html">ICompressor</a></li>
<li><a href="contracts/l2-contracts/L2ContractHelper.sol/interface.IPubdataChunkPublisher.html">IPubdataChunkPublisher</a></li>
<li><a href="contracts/l2-contracts/L2ContractHelper.sol/library.L2ContractHelper.html">L2ContractHelper</a></li>
<li><a href="contracts/l2-contracts/L2ContractHelper.sol/struct.Transaction.html">Transaction</a></li>
<li><a href="contracts/l2-contracts/L2ContractHelper.sol/constants.L2ContractHelper.html">L2ContractHelper constants</a></li>
<li><a href="contracts/l2-contracts/SystemContractsCaller.sol/enum.CalldataForwardingMode.html">CalldataForwardingMode</a></li>
<li><a href="contracts/l2-contracts/SystemContractsCaller.sol/error.U32CastOverflow.html">U32CastOverflow</a></li>
<li><a href="contracts/l2-contracts/SystemContractsCaller.sol/library.Utils.html">Utils</a></li>
<li><a href="contracts/l2-contracts/SystemContractsCaller.sol/library.SystemContractsCaller.html">SystemContractsCaller</a></li>
<li><a href="contracts/l2-contracts/SystemContractsCaller.sol/constants.SystemContractsCaller.html">SystemContractsCaller constants</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="contents-14"><a class="header" href="#contents-14">Contents</a></h1>
<ul>
<li><a href="contracts/l2-contracts/interfaces/IConsensusRegistry.sol/interface.IConsensusRegistry.html">IConsensusRegistry</a></li>
<li><a href="contracts/l2-contracts/interfaces/IContractDeployer.sol/struct.ForceDeployment.html">ForceDeployment</a></li>
<li><a href="contracts/l2-contracts/interfaces/IContractDeployer.sol/interface.IContractDeployer.html">IContractDeployer</a></li>
<li><a href="contracts/l2-contracts/interfaces/IL2DAValidator.sol/interface.IL2DAValidator.html">IL2DAValidator</a></li>
<li><a href="contracts/l2-contracts/interfaces/IPaymaster.sol/enum.ExecutionResult.html">ExecutionResult</a></li>
<li><a href="contracts/l2-contracts/interfaces/IPaymaster.sol/interface.IPaymaster.html">IPaymaster</a></li>
<li><a href="contracts/l2-contracts/interfaces/IPaymaster.sol/constants.IPaymaster.html">IPaymaster constants</a></li>
<li><a href="contracts/l2-contracts/interfaces/IPaymasterFlow.sol/interface.IPaymasterFlow.html">IPaymasterFlow</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="iconsensusregistry"><a class="header" href="#iconsensusregistry">IConsensusRegistry</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/l2-contracts/interfaces/IConsensusRegistry.sol">Git Source</a></p>
<p><strong>Title:</strong>
ConsensusRegistry contract interface</p>
<p><strong>Author:</strong>
Matter Labs</p>
<p><strong>Note:</strong>
security-contact: security@matterlabs.dev</p>
<h2 id="functions-49"><a class="header" href="#functions-49">Functions</a></h2>
<h3 id="add"><a class="header" href="#add">add</a></h3>
<p>Adds a new validator to the registry.</p>
<p>Fails if validator owner already exists.</p>
<p>Fails if a validator with the same public key already exists.</p>
<pre><code class="language-solidity">function add(
  address _validatorOwner,
  bool _validatorIsLeader,
  uint32 _validatorWeight,
  BLS12_381PublicKey calldata _validatorPubKey,
  BLS12_381Signature calldata _validatorPoP
) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_validatorOwner</code></td><td><code>address</code></td><td>The address of the validator's owner.</td></tr>
<tr><td><code>_validatorIsLeader</code></td><td><code>bool</code></td><td>Flag indicating if the validator is a leader.</td></tr>
<tr><td><code>_validatorWeight</code></td><td><code>uint32</code></td><td>The voting weight of the validator.</td></tr>
<tr><td><code>_validatorPubKey</code></td><td><code>BLS12_381PublicKey</code></td><td>The BLS12-381 public key of the validator.</td></tr>
<tr><td><code>_validatorPoP</code></td><td><code>BLS12_381Signature</code></td><td>The proof-of-possession (PoP) of the validator's public key.</td></tr>
</tbody></table>
</div>
<h3 id="remove"><a class="header" href="#remove">remove</a></h3>
<p>Removes a validator from the registry.</p>
<p>Only callable by the contract owner.</p>
<p>Verifies that the validator owner exists in the registry.</p>
<pre><code class="language-solidity">function remove(address _validatorOwner) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_validatorOwner</code></td><td><code>address</code></td><td>The address of the owner of the validator to be removed.</td></tr>
</tbody></table>
</div>
<h3 id="changevalidatoractive"><a class="header" href="#changevalidatoractive">changeValidatorActive</a></h3>
<p>Changes the active status of a validator, determining whether it can participate in committees.</p>
<p>Only callable by the contract owner or the validator owner.</p>
<p>Verifies that the validator owner exists in the registry.</p>
<pre><code class="language-solidity">function changeValidatorActive(address _validatorOwner, bool _isActive)
  external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_validatorOwner</code></td><td><code>address</code></td><td>The address of the owner of the validator whose active status will be changed.</td></tr>
<tr><td><code>_isActive</code></td><td><code>bool</code></td><td>The new active status to assign to the validator.</td></tr>
</tbody></table>
</div>
<h3 id="changevalidatorleader"><a class="header" href="#changevalidatorleader">changeValidatorLeader</a></h3>
<p>Changes the validator's leader status in the registry.</p>
<p>Only callable by the contract owner.</p>
<p>Verifies that the validator owner exists in the registry.</p>
<pre><code class="language-solidity">function changeValidatorLeader(address _validatorOwner, bool _isLeader)
  external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_validatorOwner</code></td><td><code>address</code></td><td>The address of the owner of the validator whose leader status will be changed.</td></tr>
<tr><td><code>_isLeader</code></td><td><code>bool</code></td><td>The new leader status to assign to the validator.</td></tr>
</tbody></table>
</div>
<h3 id="changevalidatorweight"><a class="header" href="#changevalidatorweight">changeValidatorWeight</a></h3>
<p>Changes the validator weight of a validator in the registry.</p>
<p>Only callable by the contract owner.</p>
<p>Verifies that the validator owner exists in the registry.</p>
<pre><code class="language-solidity">function changeValidatorWeight(address _validatorOwner, uint32 _weight)
  external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_validatorOwner</code></td><td><code>address</code></td><td>The address of the owner of the validator whose weight will be changed.</td></tr>
<tr><td><code>_weight</code></td><td><code>uint32</code></td><td>The new validator weight to assign to the validator.</td></tr>
</tbody></table>
</div>
<h3 id="changevalidatorkey"><a class="header" href="#changevalidatorkey">changeValidatorKey</a></h3>
<p>Changes the validator's public key and proof-of-possession in the registry.</p>
<p>Only callable by the contract owner or the validator owner.</p>
<p>Verifies that the validator owner exists in the registry.</p>
<pre><code class="language-solidity">function changeValidatorKey(
  address _validatorOwner,
  BLS12_381PublicKey calldata _pubKey,
  BLS12_381Signature calldata _pop
) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_validatorOwner</code></td><td><code>address</code></td><td>The address of the owner of the validator whose key and PoP will be changed.</td></tr>
<tr><td><code>_pubKey</code></td><td><code>BLS12_381PublicKey</code></td><td>The new BLS12-381 public key to assign to the validator.</td></tr>
<tr><td><code>_pop</code></td><td><code>BLS12_381Signature</code></td><td>The new proof-of-possession (PoP) to assign to the validator.</td></tr>
</tbody></table>
</div>
<h3 id="commitvalidatorcommittee"><a class="header" href="#commitvalidatorcommittee">commitValidatorCommittee</a></h3>
<p>Adds a new commit to the validator committee using the current block number plus delay.</p>
<p>The committee will become active after committeeActivationDelay blocks.</p>
<p>Only callable by the contract owner.</p>
<p>Reverts if validatorsCommitBlock is still in the future.</p>
<pre><code class="language-solidity">function commitValidatorCommittee() external;
</code></pre>
<h3 id="getvalidatorcommittee"><a class="header" href="#getvalidatorcommittee">getValidatorCommittee</a></h3>
<p>Returns an array of <code>ValidatorAttr</code> structs representing the current validator committee and the current leader selection configuration.</p>
<p>Collects active and non-removed validators based on the latest commit to the committee.</p>
<pre><code class="language-solidity">function getValidatorCommittee()
  external
  view
  returns (CommitteeValidator[] memory, LeaderSelectionAttr memory);
</code></pre>
<h3 id="getnextvalidatorcommittee"><a class="header" href="#getnextvalidatorcommittee">getNextValidatorCommittee</a></h3>
<p>Returns an array of <code>ValidatorAttr</code> structs representing the pending validator committee and the pending leader selection configuration.</p>
<p>Collects active and non-removed validators that will form the next committee after the current commit becomes active.</p>
<p>Reverts if there is no pending committee (when block.number &gt;= validatorsCommitBlock).</p>
<pre><code class="language-solidity">function getNextValidatorCommittee()
  external
  view
  returns (CommitteeValidator[] memory, LeaderSelectionAttr memory);
</code></pre>
<h3 id="setcommitteeactivationdelay"><a class="header" href="#setcommitteeactivationdelay">setCommitteeActivationDelay</a></h3>
<p>Updates the delay for committee activation</p>
<p>Only callable by the contract owner</p>
<pre><code class="language-solidity">function setCommitteeActivationDelay(uint256 _delay) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_delay</code></td><td><code>uint256</code></td><td>The new delay in blocks</td></tr>
</tbody></table>
</div>
<h3 id="updateleaderselection"><a class="header" href="#updateleaderselection">updateLeaderSelection</a></h3>
<p>Updates the leader selection configuration</p>
<p>Only callable by the contract owner</p>
<pre><code class="language-solidity">function updateLeaderSelection(uint64 _frequency, bool _weighted) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_frequency</code></td><td><code>uint64</code></td><td>The number of views between leader changes. If it is 0 then the leader never rotates.</td></tr>
<tr><td><code>_weighted</code></td><td><code>bool</code></td><td>Whether leaders are selected proportionally to their weight. If false, then the leader is selected round-robin.</td></tr>
</tbody></table>
</div>
<h2 id="events-28"><a class="header" href="#events-28">Events</a></h2>
<h3 id="validatoradded"><a class="header" href="#validatoradded">ValidatorAdded</a></h3>
<pre><code class="language-solidity">event ValidatorAdded(
  address indexed validatorOwner,
  uint32 validatorWeight,
  BLS12_381PublicKey validatorPubKey,
  BLS12_381Signature validatorPoP
);
</code></pre>
<h3 id="validatorremoved"><a class="header" href="#validatorremoved">ValidatorRemoved</a></h3>
<pre><code class="language-solidity">event ValidatorRemoved(address indexed validatorOwner);
</code></pre>
<h3 id="validatordeleted"><a class="header" href="#validatordeleted">ValidatorDeleted</a></h3>
<pre><code class="language-solidity">event ValidatorDeleted(address indexed validatorOwner);
</code></pre>
<h3 id="validatoractivestatuschanged"><a class="header" href="#validatoractivestatuschanged">ValidatorActiveStatusChanged</a></h3>
<pre><code class="language-solidity">event ValidatorActiveStatusChanged(
  address indexed validatorOwner, bool isActive
);
</code></pre>
<h3 id="validatorleaderstatuschanged"><a class="header" href="#validatorleaderstatuschanged">ValidatorLeaderStatusChanged</a></h3>
<pre><code class="language-solidity">event ValidatorLeaderStatusChanged(
  address indexed validatorOwner, bool isLeader
);
</code></pre>
<h3 id="validatorweightchanged"><a class="header" href="#validatorweightchanged">ValidatorWeightChanged</a></h3>
<pre><code class="language-solidity">event ValidatorWeightChanged(
  address indexed validatorOwner, uint32 newWeight
);
</code></pre>
<h3 id="validatorkeychanged"><a class="header" href="#validatorkeychanged">ValidatorKeyChanged</a></h3>
<pre><code class="language-solidity">event ValidatorKeyChanged(
  address indexed validatorOwner,
  BLS12_381PublicKey newPubKey,
  BLS12_381Signature newPoP
);
</code></pre>
<h3 id="validatorscommitted"><a class="header" href="#validatorscommitted">ValidatorsCommitted</a></h3>
<pre><code class="language-solidity">event ValidatorsCommitted(
  uint32 validatorsCommit, uint256 validatorsCommitBlock
);
</code></pre>
<h3 id="committeeactivationdelaychanged"><a class="header" href="#committeeactivationdelaychanged">CommitteeActivationDelayChanged</a></h3>
<pre><code class="language-solidity">event CommitteeActivationDelayChanged(uint256 newDelay);
</code></pre>
<h3 id="leaderselectionchanged"><a class="header" href="#leaderselectionchanged">LeaderSelectionChanged</a></h3>
<pre><code class="language-solidity">event LeaderSelectionChanged(LeaderSelectionAttr newLeaderSelection);
</code></pre>
<h2 id="errors"><a class="header" href="#errors">Errors</a></h2>
<h3 id="unauthorizedonlyownerorvalidatorowner"><a class="header" href="#unauthorizedonlyownerorvalidatorowner">UnauthorizedOnlyOwnerOrValidatorOwner</a></h3>
<pre><code class="language-solidity">error UnauthorizedOnlyOwnerOrValidatorOwner();
</code></pre>
<h3 id="validatorownerexists"><a class="header" href="#validatorownerexists">ValidatorOwnerExists</a></h3>
<pre><code class="language-solidity">error ValidatorOwnerExists();
</code></pre>
<h3 id="validatorownerdoesnotexist"><a class="header" href="#validatorownerdoesnotexist">ValidatorOwnerDoesNotExist</a></h3>
<pre><code class="language-solidity">error ValidatorOwnerDoesNotExist();
</code></pre>
<h3 id="validatorownernotfound"><a class="header" href="#validatorownernotfound">ValidatorOwnerNotFound</a></h3>
<pre><code class="language-solidity">error ValidatorOwnerNotFound();
</code></pre>
<h3 id="validatorpubkeyexists"><a class="header" href="#validatorpubkeyexists">ValidatorPubKeyExists</a></h3>
<pre><code class="language-solidity">error ValidatorPubKeyExists();
</code></pre>
<h3 id="invalidinputvalidatorowneraddress"><a class="header" href="#invalidinputvalidatorowneraddress">InvalidInputValidatorOwnerAddress</a></h3>
<pre><code class="language-solidity">error InvalidInputValidatorOwnerAddress();
</code></pre>
<h3 id="invalidinputbls12_381publickey"><a class="header" href="#invalidinputbls12_381publickey">InvalidInputBLS12_381PublicKey</a></h3>
<pre><code class="language-solidity">error InvalidInputBLS12_381PublicKey();
</code></pre>
<h3 id="invalidinputbls12_381signature"><a class="header" href="#invalidinputbls12_381signature">InvalidInputBLS12_381Signature</a></h3>
<pre><code class="language-solidity">error InvalidInputBLS12_381Signature();
</code></pre>
<h3 id="nopendingcommittee"><a class="header" href="#nopendingcommittee">NoPendingCommittee</a></h3>
<pre><code class="language-solidity">error NoPendingCommittee();
</code></pre>
<h3 id="previouscommitstillpending"><a class="header" href="#previouscommitstillpending">PreviousCommitStillPending</a></h3>
<pre><code class="language-solidity">error PreviousCommitStillPending();
</code></pre>
<h3 id="noactiveleader"><a class="header" href="#noactiveleader">NoActiveLeader</a></h3>
<pre><code class="language-solidity">error NoActiveLeader();
</code></pre>
<h2 id="structs-6"><a class="header" href="#structs-6">Structs</a></h2>
<h3 id="validator"><a class="header" href="#validator">Validator</a></h3>
<p>Represents a validator in the consensus protocol.</p>
<pre><code class="language-solidity">struct Validator {
  uint32 ownerIdx;
  uint32 lastSnapshotCommit;
  uint32 previousSnapshotCommit;
  ValidatorAttr latest;
  ValidatorAttr snapshot;
  ValidatorAttr previousSnapshot;
}
</code></pre>
<p><strong>Properties</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>ownerIdx</code></td><td><code>uint32</code></td><td>Index of the validator owner within the array of validator owners.</td></tr>
<tr><td><code>lastSnapshotCommit</code></td><td><code>uint32</code></td><td>The <code>validatorsCommit</code> value when the last snapshot of this validator was made.</td></tr>
<tr><td><code>previousSnapshotCommit</code></td><td><code>uint32</code></td><td>The <code>validatorsCommit</code> value when the previous snapshot of this validator was made.</td></tr>
<tr><td><code>latest</code></td><td><code>ValidatorAttr</code></td><td>Validator attributes to read if <code>validatorsCommit</code> &gt; <code>validator.lastSnapshotCommit</code>.</td></tr>
<tr><td><code>snapshot</code></td><td><code>ValidatorAttr</code></td><td>Validator attributes to read if <code>validatorsCommit</code> &gt; <code>validator.previousSnapshot</code>.</td></tr>
<tr><td><code>previousSnapshot</code></td><td><code>ValidatorAttr</code></td><td>Validator attributes to read for older commits.</td></tr>
</tbody></table>
</div>
<h3 id="validatorattr"><a class="header" href="#validatorattr">ValidatorAttr</a></h3>
<p>Represents the attributes of a validator.</p>
<pre><code class="language-solidity">struct ValidatorAttr {
  bool active;
  bool removed;
  bool leader;
  uint32 weight;
  BLS12_381PublicKey pubKey;
  BLS12_381Signature proofOfPossession;
}
</code></pre>
<p><strong>Properties</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>active</code></td><td><code>bool</code></td><td>A flag stating if the validator is active.</td></tr>
<tr><td><code>removed</code></td><td><code>bool</code></td><td>A flag stating if the validator has been removed (and is pending a deletion).</td></tr>
<tr><td><code>leader</code></td><td><code>bool</code></td><td>A flag stating if the validator is eligible to be a leader.</td></tr>
<tr><td><code>weight</code></td><td><code>uint32</code></td><td>Validator's voting weight.</td></tr>
<tr><td><code>pubKey</code></td><td><code>BLS12_381PublicKey</code></td><td>Validator's BLS12-381 public key.</td></tr>
<tr><td><code>proofOfPossession</code></td><td><code>BLS12_381Signature</code></td><td>Validator's Proof-of-possession (a signature over the public key).</td></tr>
</tbody></table>
</div>
<h3 id="leaderselection"><a class="header" href="#leaderselection">LeaderSelection</a></h3>
<p>Represents the leader selection process in the consensus protocol.</p>
<pre><code class="language-solidity">struct LeaderSelection {
  uint32 lastSnapshotCommit;
  uint32 previousSnapshotCommit;
  LeaderSelectionAttr latest;
  LeaderSelectionAttr snapshot;
  LeaderSelectionAttr previousSnapshot;
}
</code></pre>
<p><strong>Properties</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>lastSnapshotCommit</code></td><td><code>uint32</code></td><td>The <code>validatorsCommit</code> value when the last snapshot was made.</td></tr>
<tr><td><code>previousSnapshotCommit</code></td><td><code>uint32</code></td><td>The <code>validatorsCommit</code> value when the previous snapshot was made.</td></tr>
<tr><td><code>latest</code></td><td><code>LeaderSelectionAttr</code></td><td>LeaderSelectionAttr to read if <code>validatorsCommit</code> &gt; <code>lastSnapshotCommit</code>.</td></tr>
<tr><td><code>snapshot</code></td><td><code>LeaderSelectionAttr</code></td><td>LeaderSelectionAttr to read if <code>validatorsCommit</code> &gt; <code>previousSnapshot</code>.</td></tr>
<tr><td><code>previousSnapshot</code></td><td><code>LeaderSelectionAttr</code></td><td>LeaderSelectionAttr to read for older commits.</td></tr>
</tbody></table>
</div>
<h3 id="leaderselectionattr"><a class="header" href="#leaderselectionattr">LeaderSelectionAttr</a></h3>
<p>Attributes for the validator leader selection process.</p>
<pre><code class="language-solidity">struct LeaderSelectionAttr {
  uint64 frequency;
  bool weighted;
}
</code></pre>
<p><strong>Properties</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>frequency</code></td><td><code>uint64</code></td><td>The number of views between leader changes. If it is 0 then the leader never rotates.</td></tr>
<tr><td><code>weighted</code></td><td><code>bool</code></td><td>Whether leaders are selectedproportionally to their weight. If false, then the leader is selected round-robin.</td></tr>
</tbody></table>
</div>
<h3 id="committeevalidator"><a class="header" href="#committeevalidator">CommitteeValidator</a></h3>
<p>Represents a validator within a committee.</p>
<pre><code class="language-solidity">struct CommitteeValidator {
  bool leader;
  uint32 weight;
  BLS12_381PublicKey pubKey;
  BLS12_381Signature proofOfPossession;
}
</code></pre>
<p><strong>Properties</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>leader</code></td><td><code>bool</code></td><td>A flag stating if the validator is eligible to be a leader.</td></tr>
<tr><td><code>weight</code></td><td><code>uint32</code></td><td>Validator's voting weight.</td></tr>
<tr><td><code>pubKey</code></td><td><code>BLS12_381PublicKey</code></td><td>Validator's BLS12-381 public key.</td></tr>
<tr><td><code>proofOfPossession</code></td><td><code>BLS12_381Signature</code></td><td>Validator's Proof-of-possession (a signature over the public key).</td></tr>
</tbody></table>
</div>
<h3 id="bls12_381publickey"><a class="header" href="#bls12_381publickey">BLS12_381PublicKey</a></h3>
<p>Represents BLS12_381 public key.</p>
<pre><code class="language-solidity">struct BLS12_381PublicKey {
  bytes32 a;
  bytes32 b;
  bytes32 c;
}
</code></pre>
<p><strong>Properties</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>a</code></td><td><code>bytes32</code></td><td>First component of the BLS12-381 public key.</td></tr>
<tr><td><code>b</code></td><td><code>bytes32</code></td><td>Second component of the BLS12-381 public key.</td></tr>
<tr><td><code>c</code></td><td><code>bytes32</code></td><td>Third component of the BLS12-381 public key.</td></tr>
</tbody></table>
</div>
<h3 id="bls12_381signature"><a class="header" href="#bls12_381signature">BLS12_381Signature</a></h3>
<p>Represents BLS12_381 signature.</p>
<pre><code class="language-solidity">struct BLS12_381Signature {
  bytes32 a;
  bytes16 b;
}
</code></pre>
<p><strong>Properties</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>a</code></td><td><code>bytes32</code></td><td>First component of the BLS12-381 signature.</td></tr>
<tr><td><code>b</code></td><td><code>bytes16</code></td><td>Second component of the BLS12-381 signature.</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="il2davalidator"><a class="header" href="#il2davalidator">IL2DAValidator</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/l2-contracts/interfaces/IL2DAValidator.sol">Git Source</a></p>
<h2 id="functions-50"><a class="header" href="#functions-50">Functions</a></h2>
<h3 id="validatepubdata"><a class="header" href="#validatepubdata">validatePubdata</a></h3>
<pre><code class="language-solidity">function validatePubdata(
  // The rolling hash of the user L2-&gt;L1 logs.
  bytes32 _chainedLogsHash,
  // The root hash of the user L2-&gt;L1 logs.
  bytes32 _logsRootHash,
  // The chained hash of the L2-&gt;L1 messages
  bytes32 _chainedMessagesHash,
  // The chained hash of uncompressed bytecodes sent to L1
  bytes32 _chainedBytecodesHash,
  // Same operator input
  bytes calldata _totalL2ToL1PubdataAndStateDiffs
) external returns (bytes32 outputHash);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="ipaymaster"><a class="header" href="#ipaymaster">IPaymaster</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/l2-contracts/interfaces/IPaymaster.sol">Git Source</a></p>
<h2 id="functions-51"><a class="header" href="#functions-51">Functions</a></h2>
<h3 id="validateandpayforpaymastertransaction"><a class="header" href="#validateandpayforpaymastertransaction">validateAndPayForPaymasterTransaction</a></h3>
<p>Called by the bootloader to verify that the paymaster agrees to pay for the
fee for the transaction. This transaction should also send the necessary amount of funds onto the bootloader
address.</p>
<p>The developer should strive to preserve as many steps as possible both for valid
and invalid transactions as this very method is also used during the gas fee estimation
(without some of the necessary data, e.g. signature).</p>
<pre><code class="language-solidity">function validateAndPayForPaymasterTransaction(
  bytes32 _txHash,
  bytes32 _suggestedSignedHash,
  Transaction calldata _transaction
) external payable returns (bytes4 magic, bytes memory context);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_txHash</code></td><td><code>bytes32</code></td><td>The hash of the transaction</td></tr>
<tr><td><code>_suggestedSignedHash</code></td><td><code>bytes32</code></td><td>The hash of the transaction that is signed by an EOA</td></tr>
<tr><td><code>_transaction</code></td><td><code>Transaction</code></td><td>The transaction itself.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>magic</code></td><td><code>bytes4</code></td><td>The value that should be equal to the signature of the validateAndPayForPaymasterTransaction if the paymaster agrees to pay for the transaction.</td></tr>
<tr><td><code>context</code></td><td><code>bytes</code></td><td>The "context" of the transaction: an array of bytes of length at most 1024 bytes, which will be passed to the <code>postTransaction</code> method of the account.</td></tr>
</tbody></table>
</div>
<h3 id="posttransaction"><a class="header" href="#posttransaction">postTransaction</a></h3>
<p>Called by the bootloader after the execution of the transaction. Please note that
there is no guarantee that this method will be called at all. Unlike the original EIP4337,
this method won't be called if the transaction execution results in out-of-gas.</p>
<p>The exact amount refunded depends on the gas spent by the "postOp" itself and so the developers should
take that into account.</p>
<pre><code class="language-solidity">function postTransaction(
  bytes calldata _context,
  Transaction calldata _transaction,
  bytes32 _txHash,
  bytes32 _suggestedSignedHash,
  ExecutionResult _txResult,
  uint256 _maxRefundedGas
) external payable;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_context</code></td><td><code>bytes</code></td><td></td></tr>
<tr><td><code>_transaction</code></td><td><code>Transaction</code></td><td></td></tr>
<tr><td><code>_txHash</code></td><td><code>bytes32</code></td><td></td></tr>
<tr><td><code>_suggestedSignedHash</code></td><td><code>bytes32</code></td><td></td></tr>
<tr><td><code>_txResult</code></td><td><code>ExecutionResult</code></td><td></td></tr>
<tr><td><code>_maxRefundedGas</code></td><td><code>uint256</code></td><td></td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="constants-3"><a class="header" href="#constants-3">Constants</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/l2-contracts/interfaces/IPaymaster.sol">Git Source</a></p>
<h3 id="paymaster_validation_success_magic"><a class="header" href="#paymaster_validation_success_magic">PAYMASTER_VALIDATION_SUCCESS_MAGIC</a></h3>
<pre><code class="language-solidity">bytes4 constant PAYMASTER_VALIDATION_SUCCESS_MAGIC =
IPaymaster.validateAndPayForPaymasterTransaction.selector
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="ipaymasterflow"><a class="header" href="#ipaymasterflow">IPaymasterFlow</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/l2-contracts/interfaces/IPaymasterFlow.sol">Git Source</a></p>
<p><strong>Author:</strong>
Matter Labs</p>
<p>This is NOT an interface to be implemented
by contracts. It is just used for encoding.</p>
<p>The interface that is used for encoding/decoding of
different types of paymaster flows.</p>
<p><strong>Note:</strong>
security-contact: security@matterlabs.dev</p>
<h2 id="functions-52"><a class="header" href="#functions-52">Functions</a></h2>
<h3 id="general"><a class="header" href="#general">general</a></h3>
<pre><code class="language-solidity">function general(bytes calldata input) external;
</code></pre>
<h3 id="approvalbased"><a class="header" href="#approvalbased">approvalBased</a></h3>
<pre><code class="language-solidity">function approvalBased(
  address _token,
  uint256 _minAllowance,
  bytes calldata _innerInput
) external;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="contents-15"><a class="header" href="#contents-15">Contents</a></h1>
<ul>
<li><a href="contracts/l2-contracts/vendor/AddressAliasHelper.sol/library.AddressAliasHelper.html">AddressAliasHelper</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="addressaliashelper-1"><a class="header" href="#addressaliashelper-1">AddressAliasHelper</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/l2-contracts/vendor/AddressAliasHelper.sol">Git Source</a></p>
<h2 id="state-variables-2"><a class="header" href="#state-variables-2">State Variables</a></h2>
<h3 id="offset-1"><a class="header" href="#offset-1">offset</a></h3>
<pre><code class="language-solidity">uint160 internal constant offset =
  uint160(0x1111000000000000000000000000000000001111)
</code></pre>
<h2 id="functions-53"><a class="header" href="#functions-53">Functions</a></h2>
<h3 id="applyl1tol2alias-1"><a class="header" href="#applyl1tol2alias-1">applyL1ToL2Alias</a></h3>
<p>Utility function converts the address that submitted a tx
to the inbox on L1 to the msg.sender viewed on L2</p>
<pre><code class="language-solidity">function applyL1ToL2Alias(address l1Address)
  internal
  pure
  returns (address l2Address);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>l1Address</code></td><td><code>address</code></td><td>the address in the L1 that triggered the tx to L2</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>l2Address</code></td><td><code>address</code></td><td>L2 address as viewed in msg.sender</td></tr>
</tbody></table>
</div>
<h3 id="undol1tol2alias-1"><a class="header" href="#undol1tol2alias-1">undoL1ToL2Alias</a></h3>
<p>Utility function that converts the msg.sender viewed on L2 to the
address that submitted a tx to the inbox on L1</p>
<pre><code class="language-solidity">function undoL1ToL2Alias(address l2Address)
  internal
  pure
  returns (address l1Address);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>l2Address</code></td><td><code>address</code></td><td>L2 address as viewed in msg.sender</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>l1Address</code></td><td><code>address</code></td><td>the address in the L1 that triggered the tx to L2</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="contents-16"><a class="header" href="#contents-16">Contents</a></h1>
<ul>
<li><a href="contracts/system-contracts//contracts/system-contracts/interfaces">interfaces</a></li>
<li><a href="contracts/system-contracts//contracts/system-contracts/libraries">libraries</a></li>
<li><a href="contracts/system-contracts/Constants.sol/enum.SystemLogKey.html">SystemLogKey</a></li>
<li><a href="contracts/system-contracts/Constants.sol/constants.Constants.html">Constants</a></li>
<li><a href="contracts/system-contracts/SystemContractErrors.sol/error.AddressHasNoCode.html">AddressHasNoCode</a></li>
<li><a href="contracts/system-contracts/SystemContractErrors.sol/error.CallerMustBeBootloader.html">CallerMustBeBootloader</a></li>
<li><a href="contracts/system-contracts/SystemContractErrors.sol/error.CallerMustBeEvmContract.html">CallerMustBeEvmContract</a></li>
<li><a href="contracts/system-contracts/SystemContractErrors.sol/error.CallerMustBeSystemContract.html">CallerMustBeSystemContract</a></li>
<li><a href="contracts/system-contracts/SystemContractErrors.sol/error.CompressionValueAddError.html">CompressionValueAddError</a></li>
<li><a href="contracts/system-contracts/SystemContractErrors.sol/error.CompressionValueTransformError.html">CompressionValueTransformError</a></li>
<li><a href="contracts/system-contracts/SystemContractErrors.sol/error.CompressionValueSubError.html">CompressionValueSubError</a></li>
<li><a href="contracts/system-contracts/SystemContractErrors.sol/error.CompressorInitialWritesProcessedNotEqual.html">CompressorInitialWritesProcessedNotEqual</a></li>
<li><a href="contracts/system-contracts/SystemContractErrors.sol/error.CompressorEnumIndexNotEqual.html">CompressorEnumIndexNotEqual</a></li>
<li><a href="contracts/system-contracts/SystemContractErrors.sol/error.DerivedKeyNotEqualToCompressedValue.html">DerivedKeyNotEqualToCompressedValue</a></li>
<li><a href="contracts/system-contracts/SystemContractErrors.sol/error.DictionaryDividedByEightNotGreaterThanEncodedDividedByTwo.html">DictionaryDividedByEightNotGreaterThanEncodedDividedByTwo</a></li>
<li><a href="contracts/system-contracts/SystemContractErrors.sol/error.EmptyBytes32.html">EmptyBytes32</a></li>
<li><a href="contracts/system-contracts/SystemContractErrors.sol/error.EncodedAndRealBytecodeChunkNotEqual.html">EncodedAndRealBytecodeChunkNotEqual</a></li>
<li><a href="contracts/system-contracts/SystemContractErrors.sol/error.EncodedLengthNotFourTimesSmallerThanOriginal.html">EncodedLengthNotFourTimesSmallerThanOriginal</a></li>
<li><a href="contracts/system-contracts/SystemContractErrors.sol/error.EVMBytecodeHash.html">EVMBytecodeHash</a></li>
<li><a href="contracts/system-contracts/SystemContractErrors.sol/error.EVMBytecodeHashUnknown.html">EVMBytecodeHashUnknown</a></li>
<li><a href="contracts/system-contracts/SystemContractErrors.sol/error.EVMEmulationNotSupported.html">EVMEmulationNotSupported</a></li>
<li><a href="contracts/system-contracts/SystemContractErrors.sol/error.FailedToChargeGas.html">FailedToChargeGas</a></li>
<li><a href="contracts/system-contracts/SystemContractErrors.sol/error.FailedToPayOperator.html">FailedToPayOperator</a></li>
<li><a href="contracts/system-contracts/SystemContractErrors.sol/error.HashIsNonZero.html">HashIsNonZero</a></li>
<li><a href="contracts/system-contracts/SystemContractErrors.sol/error.HashMismatch.html">HashMismatch</a></li>
<li><a href="contracts/system-contracts/SystemContractErrors.sol/error.IndexOutOfBounds.html">IndexOutOfBounds</a></li>
<li><a href="contracts/system-contracts/SystemContractErrors.sol/error.IndexSizeError.html">IndexSizeError</a></li>
<li><a href="contracts/system-contracts/SystemContractErrors.sol/error.InsufficientFunds.html">InsufficientFunds</a></li>
<li><a href="contracts/system-contracts/SystemContractErrors.sol/error.InvalidCall.html">InvalidCall</a></li>
<li><a href="contracts/system-contracts/SystemContractErrors.sol/error.InvalidCodeHash.html">InvalidCodeHash</a></li>
<li><a href="contracts/system-contracts/SystemContractErrors.sol/error.InvalidInput.html">InvalidInput</a></li>
<li><a href="contracts/system-contracts/SystemContractErrors.sol/error.InvalidNonceOrderingChange.html">InvalidNonceOrderingChange</a></li>
<li><a href="contracts/system-contracts/SystemContractErrors.sol/error.InvalidSig.html">InvalidSig</a></li>
<li><a href="contracts/system-contracts/SystemContractErrors.sol/error.Keccak256InvalidReturnData.html">Keccak256InvalidReturnData</a></li>
<li><a href="contracts/system-contracts/SystemContractErrors.sol/error.MalformedBytecode.html">MalformedBytecode</a></li>
<li><a href="contracts/system-contracts/SystemContractErrors.sol/error.NonceAlreadyUsed.html">NonceAlreadyUsed</a></li>
<li><a href="contracts/system-contracts/SystemContractErrors.sol/error.NonceIncreaseError.html">NonceIncreaseError</a></li>
<li><a href="contracts/system-contracts/SystemContractErrors.sol/error.NonceNotUsed.html">NonceNotUsed</a></li>
<li><a href="contracts/system-contracts/SystemContractErrors.sol/error.NonEmptyAccount.html">NonEmptyAccount</a></li>
<li><a href="contracts/system-contracts/SystemContractErrors.sol/error.NonEmptyMsgValue.html">NonEmptyMsgValue</a></li>
<li><a href="contracts/system-contracts/SystemContractErrors.sol/error.NotAllowedToDeployInKernelSpace.html">NotAllowedToDeployInKernelSpace</a></li>
<li><a href="contracts/system-contracts/SystemContractErrors.sol/error.Overflow.html">Overflow</a></li>
<li><a href="contracts/system-contracts/SystemContractErrors.sol/error.ReconstructionMismatch.html">ReconstructionMismatch</a></li>
<li><a href="contracts/system-contracts/SystemContractErrors.sol/error.ShaInvalidReturnData.html">ShaInvalidReturnData</a></li>
<li><a href="contracts/system-contracts/SystemContractErrors.sol/error.StateDiffLengthMismatch.html">StateDiffLengthMismatch</a></li>
<li><a href="contracts/system-contracts/SystemContractErrors.sol/error.SystemCallFlagRequired.html">SystemCallFlagRequired</a></li>
<li><a href="contracts/system-contracts/SystemContractErrors.sol/error.TooMuchPubdata.html">TooMuchPubdata</a></li>
<li><a href="contracts/system-contracts/SystemContractErrors.sol/error.Unauthorized.html">Unauthorized</a></li>
<li><a href="contracts/system-contracts/SystemContractErrors.sol/error.UnknownCodeHash.html">UnknownCodeHash</a></li>
<li><a href="contracts/system-contracts/SystemContractErrors.sol/error.UnsupportedOperation.html">UnsupportedOperation</a></li>
<li><a href="contracts/system-contracts/SystemContractErrors.sol/error.UnsupportedPaymasterFlow.html">UnsupportedPaymasterFlow</a></li>
<li><a href="contracts/system-contracts/SystemContractErrors.sol/error.UnsupportedTxType.html">UnsupportedTxType</a></li>
<li><a href="contracts/system-contracts/SystemContractErrors.sol/error.ValueMismatch.html">ValueMismatch</a></li>
<li><a href="contracts/system-contracts/SystemContractErrors.sol/error.ZeroNonceError.html">ZeroNonceError</a></li>
<li><a href="contracts/system-contracts/SystemContractErrors.sol/error.SloadContractBytecodeUnknown.html">SloadContractBytecodeUnknown</a></li>
<li><a href="contracts/system-contracts/SystemContractErrors.sol/error.PreviousBytecodeUnknown.html">PreviousBytecodeUnknown</a></li>
<li><a href="contracts/system-contracts/SystemContractErrors.sol/error.InvalidChainId.html">InvalidChainId</a></li>
<li><a href="contracts/system-contracts/SystemContractErrors.sol/error.UpgradeTransactionMustBeFirst.html">UpgradeTransactionMustBeFirst</a></li>
<li><a href="contracts/system-contracts/SystemContractErrors.sol/error.L2BlockNumberZero.html">L2BlockNumberZero</a></li>
<li><a href="contracts/system-contracts/SystemContractErrors.sol/error.PreviousL2BlockHashIsIncorrect.html">PreviousL2BlockHashIsIncorrect</a></li>
<li><a href="contracts/system-contracts/SystemContractErrors.sol/error.CannotInitializeFirstVirtualBlock.html">CannotInitializeFirstVirtualBlock</a></li>
<li><a href="contracts/system-contracts/SystemContractErrors.sol/error.L2BlockAndBatchTimestampMismatch.html">L2BlockAndBatchTimestampMismatch</a></li>
<li><a href="contracts/system-contracts/SystemContractErrors.sol/error.InconsistentNewBatchTimestamp.html">InconsistentNewBatchTimestamp</a></li>
<li><a href="contracts/system-contracts/SystemContractErrors.sol/error.NoVirtualBlocks.html">NoVirtualBlocks</a></li>
<li><a href="contracts/system-contracts/SystemContractErrors.sol/error.CannotReuseL2BlockNumberFromPreviousBatch.html">CannotReuseL2BlockNumberFromPreviousBatch</a></li>
<li><a href="contracts/system-contracts/SystemContractErrors.sol/error.IncorrectSameL2BlockTimestamp.html">IncorrectSameL2BlockTimestamp</a></li>
<li><a href="contracts/system-contracts/SystemContractErrors.sol/error.IncorrectSameL2BlockPrevBlockHash.html">IncorrectSameL2BlockPrevBlockHash</a></li>
<li><a href="contracts/system-contracts/SystemContractErrors.sol/error.IncorrectVirtualBlockInsideMiniblock.html">IncorrectVirtualBlockInsideMiniblock</a></li>
<li><a href="contracts/system-contracts/SystemContractErrors.sol/error.IncorrectL2BlockHash.html">IncorrectL2BlockHash</a></li>
<li><a href="contracts/system-contracts/SystemContractErrors.sol/error.NonMonotonicL2BlockTimestamp.html">NonMonotonicL2BlockTimestamp</a></li>
<li><a href="contracts/system-contracts/SystemContractErrors.sol/error.CurrentBatchNumberMustBeGreaterThanZero.html">CurrentBatchNumberMustBeGreaterThanZero</a></li>
<li><a href="contracts/system-contracts/SystemContractErrors.sol/error.TimestampsShouldBeIncremental.html">TimestampsShouldBeIncremental</a></li>
<li><a href="contracts/system-contracts/SystemContractErrors.sol/error.ProvidedBatchNumberIsNotCorrect.html">ProvidedBatchNumberIsNotCorrect</a></li>
<li><a href="contracts/system-contracts/SystemContractErrors.sol/error.CodeOracleCallFailed.html">CodeOracleCallFailed</a></li>
<li><a href="contracts/system-contracts/SystemContractErrors.sol/error.ReturnedBytecodeDoesNotMatchExpectedHash.html">ReturnedBytecodeDoesNotMatchExpectedHash</a></li>
<li><a href="contracts/system-contracts/SystemContractErrors.sol/error.SecondCallShouldHaveCostLessGas.html">SecondCallShouldHaveCostLessGas</a></li>
<li><a href="contracts/system-contracts/SystemContractErrors.sol/error.ThirdCallShouldHaveSameGasCostAsSecondCall.html">ThirdCallShouldHaveSameGasCostAsSecondCall</a></li>
<li><a href="contracts/system-contracts/SystemContractErrors.sol/error.CallToKeccakShouldHaveSucceeded.html">CallToKeccakShouldHaveSucceeded</a></li>
<li><a href="contracts/system-contracts/SystemContractErrors.sol/error.KeccakReturnDataSizeShouldBe32Bytes.html">KeccakReturnDataSizeShouldBe32Bytes</a></li>
<li><a href="contracts/system-contracts/SystemContractErrors.sol/error.KeccakResultIsNotCorrect.html">KeccakResultIsNotCorrect</a></li>
<li><a href="contracts/system-contracts/SystemContractErrors.sol/error.KeccakShouldStartWorkingAgain.html">KeccakShouldStartWorkingAgain</a></li>
<li><a href="contracts/system-contracts/SystemContractErrors.sol/error.KeccakMismatchBetweenNumberOfInputsAndOutputs.html">KeccakMismatchBetweenNumberOfInputsAndOutputs</a></li>
<li><a href="contracts/system-contracts/SystemContractErrors.sol/error.KeccakHashWasNotCalculatedCorrectly.html">KeccakHashWasNotCalculatedCorrectly</a></li>
<li><a href="contracts/system-contracts/SystemContractErrors.sol/error.TransactionFailed.html">TransactionFailed</a></li>
<li><a href="contracts/system-contracts/SystemContractErrors.sol/error.NotEnoughGas.html">NotEnoughGas</a></li>
<li><a href="contracts/system-contracts/SystemContractErrors.sol/error.TooMuchGas.html">TooMuchGas</a></li>
<li><a href="contracts/system-contracts/SystemContractErrors.sol/error.InvalidNewL2BlockNumber.html">InvalidNewL2BlockNumber</a></li>
<li><a href="contracts/system-contracts/SystemContractErrors.sol/error.InvalidNonceKey.html">InvalidNonceKey</a></li>
<li><a href="contracts/system-contracts/SystemContractErrors.sol/enum.CodeHashReason.html">CodeHashReason</a></li>
<li><a href="contracts/system-contracts/SystemContractErrors.sol/enum.SigField.html">SigField</a></li>
<li><a href="contracts/system-contracts/SystemContractErrors.sol/enum.PubdataField.html">PubdataField</a></li>
<li><a href="contracts/system-contracts/SystemContractErrors.sol/enum.BytecodeError.html">BytecodeError</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="contents-17"><a class="header" href="#contents-17">Contents</a></h1>
<ul>
<li><a href="contracts/system-contracts/interfaces/IAccount.sol/interface.IAccount.html">IAccount</a></li>
<li><a href="contracts/system-contracts/interfaces/IAccount.sol/constants.IAccount.html">IAccount constants</a></li>
<li><a href="contracts/system-contracts/interfaces/IAccountCodeStorage.sol/interface.IAccountCodeStorage.html">IAccountCodeStorage</a></li>
<li><a href="contracts/system-contracts/interfaces/IBaseToken.sol/interface.IBaseToken.html">IBaseToken</a></li>
<li><a href="contracts/system-contracts/interfaces/IBootloaderUtilities.sol/interface.IBootloaderUtilities.html">IBootloaderUtilities</a></li>
<li><a href="contracts/system-contracts/interfaces/IBridgedStandardERC20.sol/interface.IBridgedStandardERC20.html">IBridgedStandardERC20</a></li>
<li><a href="contracts/system-contracts/interfaces/IBridgehub.sol/interface.IBridgehub.html">IBridgehub</a></li>
<li><a href="contracts/system-contracts/interfaces/IComplexUpgrader.sol/interface.IComplexUpgrader.html">IComplexUpgrader</a></li>
<li><a href="contracts/system-contracts/interfaces/ICompressor.sol/interface.ICompressor.html">ICompressor</a></li>
<li><a href="contracts/system-contracts/interfaces/ICompressor.sol/constants.ICompressor.html">ICompressor constants</a></li>
<li><a href="contracts/system-contracts/interfaces/IContractDeployer.sol/struct.ForceDeployment.html">ForceDeployment</a></li>
<li><a href="contracts/system-contracts/interfaces/IContractDeployer.sol/interface.IContractDeployer.html">IContractDeployer</a></li>
<li><a href="contracts/system-contracts/interfaces/ICreate2Factory.sol/interface.ICreate2Factory.html">ICreate2Factory</a></li>
<li><a href="contracts/system-contracts/interfaces/IEvmHashesStorage.sol/interface.IEvmHashesStorage.html">IEvmHashesStorage</a></li>
<li><a href="contracts/system-contracts/interfaces/IImmutableSimulator.sol/struct.ImmutableData.html">ImmutableData</a></li>
<li><a href="contracts/system-contracts/interfaces/IImmutableSimulator.sol/interface.IImmutableSimulator.html">IImmutableSimulator</a></li>
<li><a href="contracts/system-contracts/interfaces/IKnownCodesStorage.sol/interface.IKnownCodesStorage.html">IKnownCodesStorage</a></li>
<li><a href="contracts/system-contracts/interfaces/IL1Messenger.sol/struct.L2ToL1Log.html">L2ToL1Log</a></li>
<li><a href="contracts/system-contracts/interfaces/IL1Messenger.sol/interface.IL1Messenger.html">IL1Messenger</a></li>
<li><a href="contracts/system-contracts/interfaces/IL1Messenger.sol/constants.IL1Messenger.html">IL1Messenger constants</a></li>
<li><a href="contracts/system-contracts/interfaces/IL2AssetRouter.sol/interface.IL2AssetRouter.html">IL2AssetRouter</a></li>
<li><a href="contracts/system-contracts/interfaces/IL2DAValidator.sol/interface.IL2DAValidator.html">IL2DAValidator</a></li>
<li><a href="contracts/system-contracts/interfaces/IL2GenesisUpgrade.sol/struct.ZKChainSpecificForceDeploymentsData.html">ZKChainSpecificForceDeploymentsData</a></li>
<li><a href="contracts/system-contracts/interfaces/IL2GenesisUpgrade.sol/struct.FixedForceDeploymentsData.html">FixedForceDeploymentsData</a></li>
<li><a href="contracts/system-contracts/interfaces/IL2GenesisUpgrade.sol/interface.IL2GenesisUpgrade.html">IL2GenesisUpgrade</a></li>
<li><a href="contracts/system-contracts/interfaces/IL2NativeTokenVault.sol/interface.IL2NativeTokenVault.html">IL2NativeTokenVault</a></li>
<li><a href="contracts/system-contracts/interfaces/IL2SharedBridgeLegacy.sol/interface.IL2SharedBridgeLegacy.html">IL2SharedBridgeLegacy</a></li>
<li><a href="contracts/system-contracts/interfaces/IL2StandardToken.sol/interface.IL2StandardToken.html">IL2StandardToken</a></li>
<li><a href="contracts/system-contracts/interfaces/IL2WrappedBaseToken.sol/interface.IL2WrappedBaseToken.html">IL2WrappedBaseToken</a></li>
<li><a href="contracts/system-contracts/interfaces/IMailbox.sol/interface.IMailbox.html">IMailbox</a></li>
<li><a href="contracts/system-contracts/interfaces/IMessageRoot.sol/interface.IMessageRoot.html">IMessageRoot</a></li>
<li><a href="contracts/system-contracts/interfaces/INonceHolder.sol/interface.INonceHolder.html">INonceHolder</a></li>
<li><a href="contracts/system-contracts/interfaces/IPaymaster.sol/enum.ExecutionResult.html">ExecutionResult</a></li>
<li><a href="contracts/system-contracts/interfaces/IPaymaster.sol/interface.IPaymaster.html">IPaymaster</a></li>
<li><a href="contracts/system-contracts/interfaces/IPaymaster.sol/constants.IPaymaster.html">IPaymaster constants</a></li>
<li><a href="contracts/system-contracts/interfaces/IPaymasterFlow.sol/interface.IPaymasterFlow.html">IPaymasterFlow</a></li>
<li><a href="contracts/system-contracts/interfaces/IPubdataChunkPublisher.sol/interface.IPubdataChunkPublisher.html">IPubdataChunkPublisher</a></li>
<li><a href="contracts/system-contracts/interfaces/ISystemContext.sol/interface.ISystemContext.html">ISystemContext</a></li>
<li><a href="contracts/system-contracts/interfaces/ISystemContextDeprecated.sol/interface.ISystemContextDeprecated.html">ISystemContextDeprecated</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="iaccount"><a class="header" href="#iaccount">IAccount</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/interfaces/IAccount.sol">Git Source</a></p>
<p><strong>Author:</strong>
Matter Labs</p>
<p><strong>Note:</strong>
security-contact: security@matterlabs.dev</p>
<h2 id="functions-54"><a class="header" href="#functions-54">Functions</a></h2>
<h3 id="validatetransaction"><a class="header" href="#validatetransaction">validateTransaction</a></h3>
<p>Called by the bootloader to validate that an account agrees to process the transaction
(and potentially pay for it).</p>
<p>The developer should strive to preserve as many steps as possible both for valid
and invalid transactions as this very method is also used during the gas fee estimation
(without some of the necessary data, e.g. signature).</p>
<pre><code class="language-solidity">function validateTransaction(
  bytes32 _txHash,
  bytes32 _suggestedSignedHash,
  Transaction calldata _transaction
) external payable returns (bytes4 magic);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_txHash</code></td><td><code>bytes32</code></td><td>The hash of the transaction to be used in the explorer</td></tr>
<tr><td><code>_suggestedSignedHash</code></td><td><code>bytes32</code></td><td>The hash of the transaction is signed by EOAs</td></tr>
<tr><td><code>_transaction</code></td><td><code>Transaction</code></td><td>The transaction itself</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>magic</code></td><td><code>bytes4</code></td><td>The magic value that should be equal to the signature of this function if the user agrees to proceed with the transaction.</td></tr>
</tbody></table>
</div>
<h3 id="executetransaction"><a class="header" href="#executetransaction">executeTransaction</a></h3>
<pre><code class="language-solidity">function executeTransaction(
  bytes32 _txHash,
  bytes32 _suggestedSignedHash,
  Transaction calldata _transaction
) external payable;
</code></pre>
<h3 id="executetransactionfromoutside"><a class="header" href="#executetransactionfromoutside">executeTransactionFromOutside</a></h3>
<pre><code class="language-solidity">function executeTransactionFromOutside(Transaction calldata _transaction)
  external
  payable;
</code></pre>
<h3 id="payfortransaction"><a class="header" href="#payfortransaction">payForTransaction</a></h3>
<pre><code class="language-solidity">function payForTransaction(
  bytes32 _txHash,
  bytes32 _suggestedSignedHash,
  Transaction calldata _transaction
) external payable;
</code></pre>
<h3 id="prepareforpaymaster"><a class="header" href="#prepareforpaymaster">prepareForPaymaster</a></h3>
<pre><code class="language-solidity">function prepareForPaymaster(
  bytes32 _txHash,
  bytes32 _possibleSignedHash,
  Transaction calldata _transaction
) external payable;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="constants-4"><a class="header" href="#constants-4">Constants</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/interfaces/IAccount.sol">Git Source</a></p>
<h3 id="account_validation_success_magic"><a class="header" href="#account_validation_success_magic">ACCOUNT_VALIDATION_SUCCESS_MAGIC</a></h3>
<pre><code class="language-solidity">bytes4 constant ACCOUNT_VALIDATION_SUCCESS_MAGIC =
IAccount.validateTransaction.selector
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="iaccountcodestorage"><a class="header" href="#iaccountcodestorage">IAccountCodeStorage</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/interfaces/IAccountCodeStorage.sol">Git Source</a></p>
<p><strong>Author:</strong>
Matter Labs</p>
<p><strong>Note:</strong>
security-contact: security@matterlabs.dev</p>
<h2 id="functions-55"><a class="header" href="#functions-55">Functions</a></h2>
<h3 id="storeaccountconstructingcodehash"><a class="header" href="#storeaccountconstructingcodehash">storeAccountConstructingCodeHash</a></h3>
<pre><code class="language-solidity">function storeAccountConstructingCodeHash(address _address, bytes32 _hash)
  external;
</code></pre>
<h3 id="storeaccountconstructedcodehash"><a class="header" href="#storeaccountconstructedcodehash">storeAccountConstructedCodeHash</a></h3>
<pre><code class="language-solidity">function storeAccountConstructedCodeHash(address _address, bytes32 _hash)
  external;
</code></pre>
<h3 id="markaccountcodehashasconstructed"><a class="header" href="#markaccountcodehashasconstructed">markAccountCodeHashAsConstructed</a></h3>
<pre><code class="language-solidity">function markAccountCodeHashAsConstructed(address _address) external;
</code></pre>
<h3 id="getrawcodehash"><a class="header" href="#getrawcodehash">getRawCodeHash</a></h3>
<pre><code class="language-solidity">function getRawCodeHash(address _address)
  external
  view
  returns (bytes32 codeHash);
</code></pre>
<h3 id="getcodehash"><a class="header" href="#getcodehash">getCodeHash</a></h3>
<pre><code class="language-solidity">function getCodeHash(uint256 _input) external view returns (bytes32 codeHash);
</code></pre>
<h3 id="getcodesize"><a class="header" href="#getcodesize">getCodeSize</a></h3>
<pre><code class="language-solidity">function getCodeSize(uint256 _input) external view returns (uint256 codeSize);
</code></pre>
<h3 id="isaccountevm"><a class="header" href="#isaccountevm">isAccountEVM</a></h3>
<pre><code class="language-solidity">function isAccountEVM(address _addr) external view returns (bool);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="ibasetoken"><a class="header" href="#ibasetoken">IBaseToken</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/interfaces/IBaseToken.sol">Git Source</a></p>
<p><strong>Author:</strong>
Matter Labs</p>
<p><strong>Note:</strong>
security-contact: security@matterlabs.dev</p>
<h2 id="functions-56"><a class="header" href="#functions-56">Functions</a></h2>
<h3 id="balanceof"><a class="header" href="#balanceof">balanceOf</a></h3>
<pre><code class="language-solidity">function balanceOf(uint256) external view returns (uint256);
</code></pre>
<h3 id="transferfromto"><a class="header" href="#transferfromto">transferFromTo</a></h3>
<pre><code class="language-solidity">function transferFromTo(address _from, address _to, uint256 _amount) external;
</code></pre>
<h3 id="totalsupply"><a class="header" href="#totalsupply">totalSupply</a></h3>
<pre><code class="language-solidity">function totalSupply() external view returns (uint256);
</code></pre>
<h3 id="mint"><a class="header" href="#mint">mint</a></h3>
<pre><code class="language-solidity">function mint(address _account, uint256 _amount) external;
</code></pre>
<h3 id="withdraw-4"><a class="header" href="#withdraw-4">withdraw</a></h3>
<pre><code class="language-solidity">function withdraw(address _l1Receiver) external payable;
</code></pre>
<h3 id="withdrawwithmessage"><a class="header" href="#withdrawwithmessage">withdrawWithMessage</a></h3>
<pre><code class="language-solidity">function withdrawWithMessage(
  address _l1Receiver,
  bytes calldata _additionalData
) external payable;
</code></pre>
<h2 id="events-29"><a class="header" href="#events-29">Events</a></h2>
<h3 id="mint-1"><a class="header" href="#mint-1">Mint</a></h3>
<pre><code class="language-solidity">event Mint(address indexed account, uint256 amount);
</code></pre>
<h3 id="transfer"><a class="header" href="#transfer">Transfer</a></h3>
<pre><code class="language-solidity">event Transfer(address indexed from, address indexed to, uint256 value);
</code></pre>
<h3 id="withdrawal"><a class="header" href="#withdrawal">Withdrawal</a></h3>
<pre><code class="language-solidity">event Withdrawal(
  address indexed _l2Sender, address indexed _l1Receiver, uint256 _amount
);
</code></pre>
<h3 id="withdrawalwithmessage"><a class="header" href="#withdrawalwithmessage">WithdrawalWithMessage</a></h3>
<pre><code class="language-solidity">event WithdrawalWithMessage(
  address indexed _l2Sender,
  address indexed _l1Receiver,
  uint256 _amount,
  bytes _additionalData
);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="ibootloaderutilities"><a class="header" href="#ibootloaderutilities">IBootloaderUtilities</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/interfaces/IBootloaderUtilities.sol">Git Source</a></p>
<p><strong>Author:</strong>
Matter Labs</p>
<p><strong>Note:</strong>
security-contact: security@matterlabs.dev</p>
<h2 id="functions-57"><a class="header" href="#functions-57">Functions</a></h2>
<h3 id="gettransactionhashes"><a class="header" href="#gettransactionhashes">getTransactionHashes</a></h3>
<pre><code class="language-solidity">function getTransactionHashes(Transaction calldata _transaction)
  external
  view
  returns (bytes32 txHash, bytes32 signedTxHash);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="ibridgehub-1"><a class="header" href="#ibridgehub-1">IBridgehub</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/interfaces/IBridgehub.sol">Git Source</a></p>
<p><strong>Author:</strong>
Matter Labs</p>
<p><strong>Note:</strong>
security-contact: security@matterlabs.dev</p>
<h2 id="functions-58"><a class="header" href="#functions-58">Functions</a></h2>
<h3 id="setaddresses-1"><a class="header" href="#setaddresses-1">setAddresses</a></h3>
<pre><code class="language-solidity">function setAddresses(
  address _assetRouter,
  address _ctmDeployer,
  address _messageRoot,
  address _chainAssetHandler
) external;
</code></pre>
<h3 id="setchainassethandler-1"><a class="header" href="#setchainassethandler-1">setChainAssetHandler</a></h3>
<pre><code class="language-solidity">function setChainAssetHandler(address _chainAssetHandler) external;
</code></pre>
<h3 id="owner-1"><a class="header" href="#owner-1">owner</a></h3>
<pre><code class="language-solidity">function owner() external view returns (address);
</code></pre>
<h3 id="l1ctmdeployer-1"><a class="header" href="#l1ctmdeployer-1">l1CtmDeployer</a></h3>
<pre><code class="language-solidity">function l1CtmDeployer() external returns (address);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="icomplexupgrader-1"><a class="header" href="#icomplexupgrader-1">IComplexUpgrader</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/interfaces/IComplexUpgrader.sol">Git Source</a></p>
<p><strong>Author:</strong>
Matter Labs</p>
<p>The interface for the ComplexUpgrader contract.</p>
<p><strong>Note:</strong>
security-contact: security@matterlabs.dev</p>
<h2 id="functions-59"><a class="header" href="#functions-59">Functions</a></h2>
<h3 id="forcedeployandupgrade-1"><a class="header" href="#forcedeployandupgrade-1">forceDeployAndUpgrade</a></h3>
<pre><code class="language-solidity">function forceDeployAndUpgrade(
  ForceDeployment[] calldata _forceDeployments,
  address _delegateTo,
  bytes calldata _calldata
) external payable;
</code></pre>
<h3 id="upgrade-2"><a class="header" href="#upgrade-2">upgrade</a></h3>
<pre><code class="language-solidity">function upgrade(address _delegateTo, bytes calldata _calldata)
  external
  payable;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="icompressor"><a class="header" href="#icompressor">ICompressor</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/interfaces/ICompressor.sol">Git Source</a></p>
<p><strong>Author:</strong>
Matter Labs</p>
<p>The interface for the Compressor contract, responsible for verifying the correctness of
the compression of the state diffs and bytecodes.</p>
<p><strong>Note:</strong>
security-contact: security@matterlabs.dev</p>
<h2 id="functions-60"><a class="header" href="#functions-60">Functions</a></h2>
<h3 id="publishcompressedbytecode"><a class="header" href="#publishcompressedbytecode">publishCompressedBytecode</a></h3>
<pre><code class="language-solidity">function publishCompressedBytecode(
  bytes calldata _bytecode,
  bytes calldata _rawCompressedData
) external returns (bytes32 bytecodeHash);
</code></pre>
<h3 id="verifycompressedstatediffs"><a class="header" href="#verifycompressedstatediffs">verifyCompressedStateDiffs</a></h3>
<pre><code class="language-solidity">function verifyCompressedStateDiffs(
  uint256 _numberOfStateDiffs,
  uint256 _enumerationIndexSize,
  bytes calldata _stateDiffs,
  bytes calldata _compressedStateDiffs
) external returns (bytes32 stateDiffHash);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="constants-5"><a class="header" href="#constants-5">Constants</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/interfaces/ICompressor.sol">Git Source</a></p>
<h3 id="operation_bitmask"><a class="header" href="#operation_bitmask">OPERATION_BITMASK</a></h3>
<pre><code class="language-solidity">uint8 constant OPERATION_BITMASK = 7
</code></pre>
<h3 id="length_bits_offset"><a class="header" href="#length_bits_offset">LENGTH_BITS_OFFSET</a></h3>
<pre><code class="language-solidity">uint8 constant LENGTH_BITS_OFFSET = 3
</code></pre>
<h3 id="max_enumeration_index_size"><a class="header" href="#max_enumeration_index_size">MAX_ENUMERATION_INDEX_SIZE</a></h3>
<pre><code class="language-solidity">uint8 constant MAX_ENUMERATION_INDEX_SIZE = 8
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="icontractdeployer"><a class="header" href="#icontractdeployer">IContractDeployer</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/interfaces/IContractDeployer.sol">Git Source</a></p>
<p><strong>Author:</strong>
Matter Labs</p>
<p>Interface of the contract deployer contract -- a system contract responsible for deploying other contracts.</p>
<p><strong>Note:</strong>
security-contact: security@matterlabs.dev</p>
<h2 id="functions-61"><a class="header" href="#functions-61">Functions</a></h2>
<h3 id="allowedbytecodetypestodeploy-1"><a class="header" href="#allowedbytecodetypestodeploy-1">allowedBytecodeTypesToDeploy</a></h3>
<p>Returns what types of bytecode are allowed to be deployed on this chain.</p>
<pre><code class="language-solidity">function allowedBytecodeTypesToDeploy()
  external
  view
  returns (AllowedBytecodeTypes mode);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>mode</code></td><td><code>AllowedBytecodeTypes</code></td><td>The allowed bytecode types mode.</td></tr>
</tbody></table>
</div>
<h3 id="getnewaddresscreate2"><a class="header" href="#getnewaddresscreate2">getNewAddressCreate2</a></h3>
<p>Calculates the address of a deployed contract via create2</p>
<pre><code class="language-solidity">function getNewAddressCreate2(
  address _sender,
  bytes32 _bytecodeHash,
  bytes32 _salt,
  bytes calldata _input
) external view returns (address newAddress);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_sender</code></td><td><code>address</code></td><td>The account that deploys the contract.</td></tr>
<tr><td><code>_bytecodeHash</code></td><td><code>bytes32</code></td><td>The correctly formatted hash of the bytecode.</td></tr>
<tr><td><code>_salt</code></td><td><code>bytes32</code></td><td>The create2 salt.</td></tr>
<tr><td><code>_input</code></td><td><code>bytes</code></td><td>The constructor data.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>newAddress</code></td><td><code>address</code></td><td>The derived address of the account.</td></tr>
</tbody></table>
</div>
<h3 id="getnewaddresscreate"><a class="header" href="#getnewaddresscreate">getNewAddressCreate</a></h3>
<p>Calculates the address of a deployed contract via create</p>
<pre><code class="language-solidity">function getNewAddressCreate(address _sender, uint256 _senderNonce)
  external
  pure
  returns (address newAddress);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_sender</code></td><td><code>address</code></td><td>The account that deploys the contract.</td></tr>
<tr><td><code>_senderNonce</code></td><td><code>uint256</code></td><td>The deploy nonce of the sender's account.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>newAddress</code></td><td><code>address</code></td><td>The derived address of the contract.</td></tr>
</tbody></table>
</div>
<h3 id="create2-1"><a class="header" href="#create2-1">create2</a></h3>
<p>Deploys a contract with similar address derivation rules to the EVM's <code>CREATE2</code> opcode.</p>
<pre><code class="language-solidity">function create2(bytes32 _salt, bytes32 _bytecodeHash, bytes calldata _input)
  external
  payable
  returns (address newAddress);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_salt</code></td><td><code>bytes32</code></td><td>The CREATE2 salt</td></tr>
<tr><td><code>_bytecodeHash</code></td><td><code>bytes32</code></td><td>The correctly formatted hash of the bytecode.</td></tr>
<tr><td><code>_input</code></td><td><code>bytes</code></td><td>The constructor calldata</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>newAddress</code></td><td><code>address</code></td><td>The derived address of the contract.</td></tr>
</tbody></table>
</div>
<h3 id="create2account"><a class="header" href="#create2account">create2Account</a></h3>
<p>Deploys a contract account with similar address derivation rules to the EVM's <code>CREATE2</code> opcode.</p>
<p>this method may be callable only in system mode,
that is checked in the <code>createAccount</code> by <code>onlySystemCall</code> modifier.</p>
<pre><code class="language-solidity">function create2Account(
  bytes32 _salt,
  bytes32 _bytecodeHash,
  bytes calldata _input,
  AccountAbstractionVersion _aaVersion
) external payable returns (address newAddress);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_salt</code></td><td><code>bytes32</code></td><td>The CREATE2 salt</td></tr>
<tr><td><code>_bytecodeHash</code></td><td><code>bytes32</code></td><td>The correctly formatted hash of the bytecode.</td></tr>
<tr><td><code>_input</code></td><td><code>bytes</code></td><td>The constructor calldata.</td></tr>
<tr><td><code>_aaVersion</code></td><td><code>AccountAbstractionVersion</code></td><td>The account abstraction version to use.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>newAddress</code></td><td><code>address</code></td><td>The derived address of the contract.</td></tr>
</tbody></table>
</div>
<h3 id="create"><a class="header" href="#create">create</a></h3>
<p>Deploys a contract with similar address derivation rules to the EVM's <code>CREATE</code> opcode.</p>
<p>Although this method accepts salt as one of its parameters.
It is not used anywhere and is needed simply for the consistency for the compiler
Note: this method may be callable only in system mode,
that is checked in the <code>createAccount</code> by <code>onlySystemCall</code> modifier.</p>
<pre><code class="language-solidity">function create(bytes32 _salt, bytes32 _bytecodeHash, bytes calldata _input)
  external
  payable
  returns (address newAddress);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_salt</code></td><td><code>bytes32</code></td><td>A 32-byte salt.</td></tr>
<tr><td><code>_bytecodeHash</code></td><td><code>bytes32</code></td><td>The correctly formatted hash of the bytecode.</td></tr>
<tr><td><code>_input</code></td><td><code>bytes</code></td><td>The constructor calldata</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>newAddress</code></td><td><code>address</code></td><td>The derived address of the contract.</td></tr>
</tbody></table>
</div>
<h3 id="createaccount"><a class="header" href="#createaccount">createAccount</a></h3>
<p>Deploys a contract account with similar address derivation rules to the EVM's <code>CREATE</code> opcode.</p>
<p>This method also accepts salt as one of its parameters.
It is not used anywhere and it needed simply for the consistency for the compiler</p>
<pre><code class="language-solidity">function createAccount(
  bytes32, // salt
  bytes32 _bytecodeHash,
  bytes calldata _input,
  AccountAbstractionVersion _aaVersion
) external payable returns (address newAddress);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>bytes32</code></td><td></td></tr>
<tr><td><code>_bytecodeHash</code></td><td><code>bytes32</code></td><td>The correctly formatted hash of the bytecode.</td></tr>
<tr><td><code>_input</code></td><td><code>bytes</code></td><td>The constructor calldata.</td></tr>
<tr><td><code>_aaVersion</code></td><td><code>AccountAbstractionVersion</code></td><td>The account abstraction version to use.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>newAddress</code></td><td><code>address</code></td><td>The derived address of the contract.</td></tr>
</tbody></table>
</div>
<h3 id="getaccountinfo"><a class="header" href="#getaccountinfo">getAccountInfo</a></h3>
<p>Returns information about a certain account.</p>
<pre><code class="language-solidity">function getAccountInfo(address _address)
  external
  view
  returns (AccountInfo memory info);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_address</code></td><td><code>address</code></td><td>The address of the account.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>info</code></td><td><code>AccountInfo</code></td><td>The information about the account (AA version and nonce ordering).</td></tr>
</tbody></table>
</div>
<h3 id="extendedaccountversion"><a class="header" href="#extendedaccountversion">extendedAccountVersion</a></h3>
<p>Returns the account abstraction version if <code>_address</code> is a deployed contract.
Returns the latest supported account abstraction version if <code>_address</code> is an EOA.</p>
<pre><code class="language-solidity">function extendedAccountVersion(address _address)
  external
  view
  returns (AccountAbstractionVersion);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_address</code></td><td><code>address</code></td><td>The address of the account.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>AccountAbstractionVersion</code></td><td>The account abstraction version of the account. In particular, <code>Version1</code> for EOAs, <code>None</code> for non-account contracts. .</td></tr>
</tbody></table>
</div>
<h3 id="updateaccountversion"><a class="header" href="#updateaccountversion">updateAccountVersion</a></h3>
<p>Update the used version of the account.</p>
<p>Note that it allows changes from account to non-account and vice versa.</p>
<pre><code class="language-solidity">function updateAccountVersion(AccountAbstractionVersion _version) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_version</code></td><td><code>AccountAbstractionVersion</code></td><td>The new version of the AA protocol to use.</td></tr>
</tbody></table>
</div>
<h3 id="updatenonceordering"><a class="header" href="#updatenonceordering">updateNonceOrdering</a></h3>
<p>Updates the nonce ordering of the account. Since only <code>KeyedSequential</code> ordering
is supported, currently this method always reverts.</p>
<pre><code class="language-solidity">function updateNonceOrdering(AccountNonceOrdering) external;
</code></pre>
<h3 id="forcedeployonaddresses-1"><a class="header" href="#forcedeployonaddresses-1">forceDeployOnAddresses</a></h3>
<p>This method is to be used only during an upgrade to set bytecodes on specific addresses.</p>
<p>We do not require <code>onlySystemCall</code> here, since the method is accessible only
by <code>FORCE_DEPLOYER</code>.</p>
<pre><code class="language-solidity">function forceDeployOnAddresses(ForceDeployment[] calldata _deployments)
  external
  payable;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_deployments</code></td><td><code>ForceDeployment[]</code></td><td>The list of forced deployments to be done.</td></tr>
</tbody></table>
</div>
<h3 id="createevm"><a class="header" href="#createevm">createEVM</a></h3>
<p>Deploys an EVM contract using address derivation of EVM's <code>CREATE</code> opcode.</p>
<p>Note: this method may be callable only in system mode.</p>
<pre><code class="language-solidity">function createEVM(bytes calldata _initCode)
  external
  payable
  returns (uint256 evmGasUsed, address newAddress);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_initCode</code></td><td><code>bytes</code></td><td>The init code for the contract.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>evmGasUsed</code></td><td><code>uint256</code></td><td>The amount of EVM gas used.</td></tr>
<tr><td><code>newAddress</code></td><td><code>address</code></td><td>The address of created contract.</td></tr>
</tbody></table>
</div>
<h3 id="create2evm"><a class="header" href="#create2evm">create2EVM</a></h3>
<p>Deploys an EVM contract using address derivation of EVM's <code>CREATE2</code> opcode.</p>
<p>Note: this method may be callable only in system mode.</p>
<pre><code class="language-solidity">function create2EVM(bytes32 _salt, bytes calldata _initCode)
  external
  payable
  returns (uint256 evmGasUsed, address newAddress);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_salt</code></td><td><code>bytes32</code></td><td>The CREATE2 salt.</td></tr>
<tr><td><code>_initCode</code></td><td><code>bytes</code></td><td>The init code for the contract.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>evmGasUsed</code></td><td><code>uint256</code></td><td>The amount of EVM gas used.</td></tr>
<tr><td><code>newAddress</code></td><td><code>address</code></td><td>The address of created contract.</td></tr>
</tbody></table>
</div>
<h3 id="setallowedbytecodetypestodeploy-1"><a class="header" href="#setallowedbytecodetypestodeploy-1">setAllowedBytecodeTypesToDeploy</a></h3>
<p>Changes what types of bytecodes are allowed to be deployed on the chain.</p>
<pre><code class="language-solidity">function setAllowedBytecodeTypesToDeploy(AllowedBytecodeTypes newAllowedBytecodeTypes)
  external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>newAllowedBytecodeTypes</code></td><td><code>AllowedBytecodeTypes</code></td><td>The new allowed bytecode types mode.</td></tr>
</tbody></table>
</div>
<h2 id="events-30"><a class="header" href="#events-30">Events</a></h2>
<h3 id="contractdeployed"><a class="header" href="#contractdeployed">ContractDeployed</a></h3>
<p>Emitted when a contract is deployed.</p>
<pre><code class="language-solidity">event ContractDeployed(
  address indexed deployerAddress,
  bytes32 indexed bytecodeHash,
  address indexed contractAddress
);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>deployerAddress</code></td><td><code>address</code></td><td>The address of the deployer.</td></tr>
<tr><td><code>bytecodeHash</code></td><td><code>bytes32</code></td><td>The formatted hash of the bytecode that was deployed.</td></tr>
<tr><td><code>contractAddress</code></td><td><code>address</code></td><td>The address of the newly deployed contract.</td></tr>
</tbody></table>
</div>
<h3 id="accountnonceorderingupdated"><a class="header" href="#accountnonceorderingupdated">AccountNonceOrderingUpdated</a></h3>
<p>Emitted when account's nonce ordering is updated.
Since currently only <code>KeyedSequential</code> ordering is supported and updating is not possible,
the event is not emitted and is reserved for future use when updating becomes possible.</p>
<pre><code class="language-solidity">event AccountNonceOrderingUpdated(
  address indexed accountAddress, AccountNonceOrdering nonceOrdering
);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>accountAddress</code></td><td><code>address</code></td><td>The address of the account.</td></tr>
<tr><td><code>nonceOrdering</code></td><td><code>AccountNonceOrdering</code></td><td>The new nonce ordering of the account.</td></tr>
</tbody></table>
</div>
<h3 id="accountversionupdated"><a class="header" href="#accountversionupdated">AccountVersionUpdated</a></h3>
<p>Emitted when account's AA version is updated.</p>
<pre><code class="language-solidity">event AccountVersionUpdated(
  address indexed accountAddress, AccountAbstractionVersion aaVersion
);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>accountAddress</code></td><td><code>address</code></td><td>The address of the contract.</td></tr>
<tr><td><code>aaVersion</code></td><td><code>AccountAbstractionVersion</code></td><td>The new AA version of the contract.</td></tr>
</tbody></table>
</div>
<h3 id="allowedbytecodetypesmodeupdated"><a class="header" href="#allowedbytecodetypesmodeupdated">AllowedBytecodeTypesModeUpdated</a></h3>
<p>Emitted when the allowed bytecode types mode is updated (e.g. from <code>EraVm</code> to <code>EraVmAndEVM</code>).</p>
<pre><code class="language-solidity">event AllowedBytecodeTypesModeUpdated(AllowedBytecodeTypes mode);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>mode</code></td><td><code>AllowedBytecodeTypes</code></td><td>The new allowed bytecode types mode.</td></tr>
</tbody></table>
</div>
<h2 id="structs-7"><a class="header" href="#structs-7">Structs</a></h2>
<h3 id="accountinfo"><a class="header" href="#accountinfo">AccountInfo</a></h3>
<p>Information about an account contract.</p>
<p>For EOA and simple contracts (i.e. not accounts) this has default value,
which corresponds to <code>AccountAbstractionVersion.None</code>.and <code>AccountNonceOrdering.KeyedSequential</code>.</p>
<pre><code class="language-solidity">struct AccountInfo {
  AccountAbstractionVersion supportedAAVersion;
  AccountNonceOrdering nonceOrdering;
}
</code></pre>
<h2 id="enums-1"><a class="header" href="#enums-1">Enums</a></h2>
<h3 id="accountabstractionversion"><a class="header" href="#accountabstractionversion">AccountAbstractionVersion</a></h3>
<p>Defines the version of the account abstraction protocol
that a contract claims to follow.</p>
<ul>
<li><code>None</code> means that the account is just a contract and it should never be interacted
with as a custom account</li>
<li><code>Version1</code> means that the account follows the first version of the account abstraction protocol</li>
</ul>
<pre><code class="language-solidity">enum AccountAbstractionVersion {
  None,
  Version1
}
</code></pre>
<h3 id="accountnonceordering"><a class="header" href="#accountnonceordering">AccountNonceOrdering</a></h3>
<p>Defines the nonce ordering used by the account</p>
<ul>
<li><code>KeyedSequential</code> means that it is expected that the nonces are monotonic and increment by 1
at a time for each key (nonces are split 192:64 bits into nonceKey:nonceValue parts, as proposed by EIP-4337).</li>
<li><code>Arbitrary</code> ordering is deprecated.</li>
</ul>
<p>This ordering is more of a suggestion to the operator on how the AA expects its transactions
to be processed and is not considered as a system invariant.</p>
<pre><code class="language-solidity">enum AccountNonceOrdering {
  KeyedSequential,
  __DEPRECATED_Arbitrary
}
</code></pre>
<h3 id="allowedbytecodetypes"><a class="header" href="#allowedbytecodetypes">AllowedBytecodeTypes</a></h3>
<p>Defines what types of bytecode are allowed to be deployed on this chain</p>
<ul>
<li><code>EraVm</code> means that only native contracts can be deployed</li>
<li><code>EraVmAndEVM</code> means that native contracts and EVM contracts can be deployed</li>
</ul>
<pre><code class="language-solidity">enum AllowedBytecodeTypes {
  EraVm,
  EraVmAndEVM
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="icreate2factory"><a class="header" href="#icreate2factory">ICreate2Factory</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/interfaces/ICreate2Factory.sol">Git Source</a></p>
<p><strong>Author:</strong>
Matter Labs</p>
<p>The contract that can be used for deterministic contract deployment.</p>
<p><strong>Note:</strong>
security-contact: security@matterlabs.dev</p>
<h2 id="functions-62"><a class="header" href="#functions-62">Functions</a></h2>
<h3 id="create2-2"><a class="header" href="#create2-2">create2</a></h3>
<p>Function that calls the <code>create2</code> method of the <code>ContractDeployer</code> contract.</p>
<p>This function accepts the same parameters as the <code>create2</code> function of the ContractDeployer system contract,
so that we could efficiently relay the calldata.</p>
<pre><code class="language-solidity">function create2(
  bytes32, // _salt
  bytes32, // _bytecodeHash
  bytes calldata // _input
)
  external
  payable
  returns (address);
</code></pre>
<h3 id="create2account-1"><a class="header" href="#create2account-1">create2Account</a></h3>
<p>Function that calls the <code>create2Account</code> method of the <code>ContractDeployer</code> contract.</p>
<p>This function accepts the same parameters as the <code>create2Account</code> function of the ContractDeployer system contract,
so that we could efficiently relay the calldata.</p>
<pre><code class="language-solidity">function create2Account(
  bytes32, // _salt
  bytes32, // _bytecodeHash
  bytes calldata, // _input
  IContractDeployer.AccountAbstractionVersion // _aaVersion
) external payable returns (address);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="iimmutablesimulator"><a class="header" href="#iimmutablesimulator">IImmutableSimulator</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/interfaces/IImmutableSimulator.sol">Git Source</a></p>
<p><strong>Author:</strong>
Matter Labs</p>
<p><strong>Note:</strong>
security-contact: security@matterlabs.dev</p>
<h2 id="functions-63"><a class="header" href="#functions-63">Functions</a></h2>
<h3 id="getimmutable"><a class="header" href="#getimmutable">getImmutable</a></h3>
<pre><code class="language-solidity">function getImmutable(address _dest, uint256 _index)
  external
  view
  returns (bytes32);
</code></pre>
<h3 id="setimmutables"><a class="header" href="#setimmutables">setImmutables</a></h3>
<pre><code class="language-solidity">function setImmutables(address _dest, ImmutableData[] calldata _immutables)
  external;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="iknowncodesstorage"><a class="header" href="#iknowncodesstorage">IKnownCodesStorage</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/interfaces/IKnownCodesStorage.sol">Git Source</a></p>
<p><strong>Author:</strong>
Matter Labs</p>
<p>The interface for the KnownCodesStorage contract, which is responsible
for storing the hashes of the bytecodes that have been published to the network.</p>
<p><strong>Note:</strong>
security-contact: security@matterlabs.dev</p>
<h2 id="functions-64"><a class="header" href="#functions-64">Functions</a></h2>
<h3 id="markfactorydeps"><a class="header" href="#markfactorydeps">markFactoryDeps</a></h3>
<pre><code class="language-solidity">function markFactoryDeps(bool _shouldSendToL1, bytes32[] calldata _hashes)
  external;
</code></pre>
<h3 id="markbytecodeaspublished"><a class="header" href="#markbytecodeaspublished">markBytecodeAsPublished</a></h3>
<pre><code class="language-solidity">function markBytecodeAsPublished(bytes32 _bytecodeHash) external;
</code></pre>
<h3 id="getmarker"><a class="header" href="#getmarker">getMarker</a></h3>
<pre><code class="language-solidity">function getMarker(bytes32 _hash) external view returns (uint256);
</code></pre>
<h3 id="publishevmbytecode"><a class="header" href="#publishevmbytecode">publishEVMBytecode</a></h3>
<pre><code class="language-solidity">function publishEVMBytecode(uint256 evmBytecodeLen, bytes calldata bytecode)
  external
  payable
  returns (bytes32);
</code></pre>
<h2 id="events-31"><a class="header" href="#events-31">Events</a></h2>
<h3 id="markedasknown"><a class="header" href="#markedasknown">MarkedAsKnown</a></h3>
<pre><code class="language-solidity">event MarkedAsKnown(
  bytes32 indexed bytecodeHash, bool indexed sendBytecodeToL1
);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="il1messenger"><a class="header" href="#il1messenger">IL1Messenger</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/interfaces/IL1Messenger.sol">Git Source</a></p>
<p><strong>Author:</strong>
Matter Labs</p>
<p>The interface of the L1 Messenger contract, responsible for sending messages to L1.</p>
<p><strong>Note:</strong>
security-contact: security@matterlabs.dev</p>
<h2 id="functions-65"><a class="header" href="#functions-65">Functions</a></h2>
<h3 id="sendtol1-1"><a class="header" href="#sendtol1-1">sendToL1</a></h3>
<pre><code class="language-solidity">function sendToL1(bytes calldata _message) external returns (bytes32);
</code></pre>
<h3 id="sendl2tol1log-1"><a class="header" href="#sendl2tol1log-1">sendL2ToL1Log</a></h3>
<pre><code class="language-solidity">function sendL2ToL1Log(bool _isService, bytes32 _key, bytes32 _value)
  external
  returns (uint256 logIdInMerkleTree);
</code></pre>
<h3 id="requestbytecodel1publication-1"><a class="header" href="#requestbytecodel1publication-1">requestBytecodeL1Publication</a></h3>
<pre><code class="language-solidity">function requestBytecodeL1Publication(bytes32 _bytecodeHash) external;
</code></pre>
<h2 id="events-32"><a class="header" href="#events-32">Events</a></h2>
<h3 id="l1messagesent-1"><a class="header" href="#l1messagesent-1">L1MessageSent</a></h3>
<pre><code class="language-solidity">event L1MessageSent(
  address indexed _sender, bytes32 indexed _hash, bytes _message
);
</code></pre>
<h3 id="l2tol1logsent"><a class="header" href="#l2tol1logsent">L2ToL1LogSent</a></h3>
<pre><code class="language-solidity">event L2ToL1LogSent(L2ToL1Log _l2log);
</code></pre>
<h3 id="bytecodel1publicationrequested"><a class="header" href="#bytecodel1publicationrequested">BytecodeL1PublicationRequested</a></h3>
<pre><code class="language-solidity">event BytecodeL1PublicationRequested(bytes32 _bytecodeHash);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="constants-6"><a class="header" href="#constants-6">Constants</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/interfaces/IL1Messenger.sol">Git Source</a></p>
<h3 id="l2_to_l1_log_serialize_size"><a class="header" href="#l2_to_l1_log_serialize_size">L2_TO_L1_LOG_SERIALIZE_SIZE</a></h3>
<p>Bytes in raw L2 to L1 log</p>
<p>Equal to the bytes size of the tuple - (uint8 ShardId, bool isService, uint16 txNumberInBlock, address sender, bytes32 key, bytes32 value)</p>
<pre><code class="language-solidity">uint256 constant L2_TO_L1_LOG_SERIALIZE_SIZE = 88
</code></pre>
<h3 id="l2_l1_logs_tree_default_leaf_hash"><a class="header" href="#l2_l1_logs_tree_default_leaf_hash">L2_L1_LOGS_TREE_DEFAULT_LEAF_HASH</a></h3>
<p>The value of default leaf hash for L2 to L1 logs Merkle tree</p>
<p>An incomplete fixed-size tree is filled with this value to be a full binary tree</p>
<p>Actually equal to the <code>keccak256(new bytes(L2_TO_L1_LOG_SERIALIZE_SIZE))</code></p>
<pre><code class="language-solidity">bytes32 constant L2_L1_LOGS_TREE_DEFAULT_LEAF_HASH =
0x72abee45b59e344af8a6e520241c4744aff26ed411f4c4b00f8af09adada43ba
</code></pre>
<h3 id="state_diff_compression_version_number"><a class="header" href="#state_diff_compression_version_number">STATE_DIFF_COMPRESSION_VERSION_NUMBER</a></h3>
<p>The current version of state diff compression being used.</p>
<pre><code class="language-solidity">uint256 constant STATE_DIFF_COMPRESSION_VERSION_NUMBER = 1
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="il2davalidator-1"><a class="header" href="#il2davalidator-1">IL2DAValidator</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/interfaces/IL2DAValidator.sol">Git Source</a></p>
<p><strong>Author:</strong>
Matter Labs</p>
<p><strong>Note:</strong>
security-contact: security@matterlabs.dev</p>
<h2 id="functions-66"><a class="header" href="#functions-66">Functions</a></h2>
<h3 id="validatepubdata-1"><a class="header" href="#validatepubdata-1">validatePubdata</a></h3>
<pre><code class="language-solidity">function validatePubdata(
  // The rolling hash of the user L2-&gt;L1 logs.
  bytes32 _chainedLogsHash,
  // The root hash of the user L2-&gt;L1 logs.
  bytes32 _logsRootHash,
  // The chained hash of the L2-&gt;L1 messages
  bytes32 _chainedMessagesHash,
  // The chained hash of uncompressed bytecodes sent to L1
  bytes32 _chainedBytecodesHash,
  // Same operator input
  bytes calldata _totalL2ToL1PubdataAndStateDiffs
) external returns (bytes32 outputHash);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="il2genesisupgrade-1"><a class="header" href="#il2genesisupgrade-1">IL2GenesisUpgrade</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/interfaces/IL2GenesisUpgrade.sol">Git Source</a></p>
<p><strong>Author:</strong>
Matter Labs</p>
<p><strong>Note:</strong>
security-contact: security@matterlabs.dev</p>
<h2 id="functions-67"><a class="header" href="#functions-67">Functions</a></h2>
<h3 id="genesisupgrade-3"><a class="header" href="#genesisupgrade-3">genesisUpgrade</a></h3>
<pre><code class="language-solidity">function genesisUpgrade(
  uint256 _chainId,
  address _ctmDeployer,
  bytes calldata _fixedForceDeploymentsData,
  bytes calldata _additionalForceDeploymentsData
) external payable;
</code></pre>
<h2 id="events-33"><a class="header" href="#events-33">Events</a></h2>
<h3 id="upgradecomplete-1"><a class="header" href="#upgradecomplete-1">UpgradeComplete</a></h3>
<pre><code class="language-solidity">event UpgradeComplete(uint256 _chainId);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="il2sharedbridgelegacy-1"><a class="header" href="#il2sharedbridgelegacy-1">IL2SharedBridgeLegacy</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/interfaces/IL2SharedBridgeLegacy.sol">Git Source</a></p>
<p><strong>Author:</strong>
Matter Labs</p>
<p><strong>Note:</strong>
security-contact: security@matterlabs.dev</p>
<h2 id="functions-68"><a class="header" href="#functions-68">Functions</a></h2>
<h3 id="l2tokenbeacon-2"><a class="header" href="#l2tokenbeacon-2">l2TokenBeacon</a></h3>
<pre><code class="language-solidity">function l2TokenBeacon() external view returns (UpgradeableBeacon);
</code></pre>
<h3 id="withdraw-5"><a class="header" href="#withdraw-5">withdraw</a></h3>
<pre><code class="language-solidity">function withdraw(address _l1Receiver, address _l2Token, uint256 _amount)
  external;
</code></pre>
<h3 id="l1tokenaddress-1"><a class="header" href="#l1tokenaddress-1">l1TokenAddress</a></h3>
<pre><code class="language-solidity">function l1TokenAddress(address _l2Token) external view returns (address);
</code></pre>
<h3 id="l2tokenaddress-3"><a class="header" href="#l2tokenaddress-3">l2TokenAddress</a></h3>
<pre><code class="language-solidity">function l2TokenAddress(address _l1Token) external view returns (address);
</code></pre>
<h3 id="l1bridge-1"><a class="header" href="#l1bridge-1">l1Bridge</a></h3>
<pre><code class="language-solidity">function l1Bridge() external view returns (address);
</code></pre>
<h3 id="l1sharedbridge-1"><a class="header" href="#l1sharedbridge-1">l1SharedBridge</a></h3>
<pre><code class="language-solidity">function l1SharedBridge() external view returns (address);
</code></pre>
<h3 id="deploybeaconproxy-1"><a class="header" href="#deploybeaconproxy-1">deployBeaconProxy</a></h3>
<pre><code class="language-solidity">function deployBeaconProxy(bytes32 _salt) external returns (address);
</code></pre>
<h3 id="sendmessagetol1-2"><a class="header" href="#sendmessagetol1-2">sendMessageToL1</a></h3>
<pre><code class="language-solidity">function sendMessageToL1(bytes calldata _message) external;
</code></pre>
<h2 id="events-34"><a class="header" href="#events-34">Events</a></h2>
<h3 id="finalizedeposit-6"><a class="header" href="#finalizedeposit-6">FinalizeDeposit</a></h3>
<pre><code class="language-solidity">event FinalizeDeposit(
  address indexed l1Sender,
  address indexed l2Receiver,
  address indexed l2Token,
  uint256 amount
);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="il2standardtoken"><a class="header" href="#il2standardtoken">IL2StandardToken</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/interfaces/IL2StandardToken.sol">Git Source</a></p>
<p><strong>Author:</strong>
Matter Labs</p>
<p><strong>Note:</strong>
security-contact: security@matterlabs.dev</p>
<h2 id="functions-69"><a class="header" href="#functions-69">Functions</a></h2>
<h3 id="bridgemint-5"><a class="header" href="#bridgemint-5">bridgeMint</a></h3>
<pre><code class="language-solidity">function bridgeMint(address _account, uint256 _amount) external;
</code></pre>
<h3 id="bridgeburn-4"><a class="header" href="#bridgeburn-4">bridgeBurn</a></h3>
<pre><code class="language-solidity">function bridgeBurn(address _account, uint256 _amount) external;
</code></pre>
<h3 id="l1address-1"><a class="header" href="#l1address-1">l1Address</a></h3>
<pre><code class="language-solidity">function l1Address() external view returns (address);
</code></pre>
<h3 id="l2bridge-2"><a class="header" href="#l2bridge-2">l2Bridge</a></h3>
<pre><code class="language-solidity">function l2Bridge() external view returns (address);
</code></pre>
<h2 id="events-35"><a class="header" href="#events-35">Events</a></h2>
<h3 id="bridgemint-6"><a class="header" href="#bridgemint-6">BridgeMint</a></h3>
<pre><code class="language-solidity">event BridgeMint(address indexed _account, uint256 _amount);
</code></pre>
<h3 id="bridgeburn-5"><a class="header" href="#bridgeburn-5">BridgeBurn</a></h3>
<pre><code class="language-solidity">event BridgeBurn(address indexed _account, uint256 _amount);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="il2wrappedbasetoken-1"><a class="header" href="#il2wrappedbasetoken-1">IL2WrappedBaseToken</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/interfaces/IL2WrappedBaseToken.sol">Git Source</a></p>
<p><strong>Author:</strong>
Matter Labs</p>
<p><strong>Note:</strong>
security-contact: security@matterlabs.dev</p>
<h2 id="functions-70"><a class="header" href="#functions-70">Functions</a></h2>
<h3 id="initializev3"><a class="header" href="#initializev3">initializeV3</a></h3>
<p>Initializes a contract token for later use. Expected to be used in the proxy.</p>
<p>This function is used to integrate the previously deployed WETH token with the bridge.</p>
<p>Sets up <code>name</code>/<code>symbol</code>/<code>decimals</code> getters.</p>
<pre><code class="language-solidity">function initializeV3(
  string calldata name_,
  string calldata symbol_,
  address _l2Bridge,
  address _l1Address,
  bytes32 _baseTokenAssetId
) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>name_</code></td><td><code>string</code></td><td>The name of the token.</td></tr>
<tr><td><code>symbol_</code></td><td><code>string</code></td><td>The symbol of the token.</td></tr>
<tr><td><code>_l2Bridge</code></td><td><code>address</code></td><td>Address of the L2 bridge</td></tr>
<tr><td><code>_l1Address</code></td><td><code>address</code></td><td>Address of the L1 token that can be deposited to mint this L2 WETH. Note: The decimals are hardcoded to 18, the same as on Ether.</td></tr>
<tr><td><code>_baseTokenAssetId</code></td><td><code>bytes32</code></td><td></td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="imailbox-1"><a class="header" href="#imailbox-1">IMailbox</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/interfaces/IMailbox.sol">Git Source</a></p>
<p><strong>Author:</strong>
Matter Labs</p>
<p><strong>Note:</strong>
security-contact: security@matterlabs.dev</p>
<h2 id="functions-71"><a class="header" href="#functions-71">Functions</a></h2>
<h3 id="finalizeethwithdrawal-1"><a class="header" href="#finalizeethwithdrawal-1">finalizeEthWithdrawal</a></h3>
<pre><code class="language-solidity">function finalizeEthWithdrawal(
  uint256 _l2BatchNumber,
  uint256 _l2MessageIndex,
  uint16 _l2TxNumberInBlock,
  bytes calldata _message,
  bytes32[] calldata _merkleProof
) external;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="imessageroot-1"><a class="header" href="#imessageroot-1">IMessageRoot</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/interfaces/IMessageRoot.sol">Git Source</a></p>
<p><strong>Author:</strong>
Matter Labs</p>
<p>MessageRoot contract is responsible for storing and aggregating the roots of the batches from different chains into the MessageRoot.</p>
<p><strong>Note:</strong>
security-contact: security@matterlabs.dev</p>
<h2 id="functions-72"><a class="header" href="#functions-72">Functions</a></h2>
<h3 id="getaggregatedroot"><a class="header" href="#getaggregatedroot">getAggregatedRoot</a></h3>
<p>The aggregated root of the batches from different chains.</p>
<pre><code class="language-solidity">function getAggregatedRoot() external view returns (bytes32 aggregatedRoot);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>aggregatedRoot</code></td><td><code>bytes32</code></td><td>of the batches from different chains.</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="inonceholder"><a class="header" href="#inonceholder">INonceHolder</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/interfaces/INonceHolder.sol">Git Source</a></p>
<p><strong>Author:</strong>
Matter Labs</p>
<p>Interface of the nonce holder contract -- a contract used by the system to ensure
that there is always a unique identifier for a transaction with a particular account (we call it nonce).
In other words, the pair of (address, nonce) should always be unique.</p>
<p>Custom accounts should use methods of this contract to store nonces or other possible unique identifiers
for the transaction.</p>
<p><strong>Note:</strong>
security-contact: security@matterlabs.dev</p>
<h2 id="functions-73"><a class="header" href="#functions-73">Functions</a></h2>
<h3 id="getminnonce"><a class="header" href="#getminnonce">getMinNonce</a></h3>
<p>Returns the current minimal nonce for account.</p>
<pre><code class="language-solidity">function getMinNonce(address _address) external view returns (uint256);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_address</code></td><td><code>address</code></td><td>The account to return the minimal nonce for</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint256</code></td><td>The current minimal nonce for this account.</td></tr>
</tbody></table>
</div>
<h3 id="getkeyednonce"><a class="header" href="#getkeyednonce">getKeyedNonce</a></h3>
<p>Returns the current keyed nonce for account given its nonce key.</p>
<pre><code class="language-solidity">function getKeyedNonce(address _address, uint192 _key)
  external
  view
  returns (uint256);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_address</code></td><td><code>address</code></td><td>The account to return the nonce for.</td></tr>
<tr><td><code>_key</code></td><td><code>uint192</code></td><td>The key of the nonce to return.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint256</code></td><td>The current keyed nonce with the given key for this account. Returns the full nonce (including the provided key), not just the nonce value.</td></tr>
</tbody></table>
</div>
<h3 id="getrawnonce"><a class="header" href="#getrawnonce">getRawNonce</a></h3>
<p>Returns the raw version of the current minimal nonce</p>
<p>It is equal to minNonce + 2^128 * deployment nonce.</p>
<pre><code class="language-solidity">function getRawNonce(address _address) external view returns (uint256);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_address</code></td><td><code>address</code></td><td>The account to return the raw nonce for</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint256</code></td><td>The raw nonce for this account.</td></tr>
</tbody></table>
</div>
<h3 id="increaseminnonce"><a class="header" href="#increaseminnonce">increaseMinNonce</a></h3>
<p>Increases the minimal nonce for the msg.sender and returns the previous one.</p>
<pre><code class="language-solidity">function increaseMinNonce(uint256 _value) external returns (uint256);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_value</code></td><td><code>uint256</code></td><td>The number by which to increase the minimal nonce for msg.sender.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint256</code></td><td>oldMinNonce The value of the minimal nonce for msg.sender before the increase.</td></tr>
</tbody></table>
</div>
<h3 id="setvalueundernonce"><a class="header" href="#setvalueundernonce">setValueUnderNonce</a></h3>
<p>Sets the nonce value <code>key</code> as used.</p>
<pre><code class="language-solidity">function setValueUnderNonce(uint256 _key, uint256 _value) external;
</code></pre>
<h3 id="getvalueundernonce"><a class="header" href="#getvalueundernonce">getValueUnderNonce</a></h3>
<p>Gets the value stored inside a custom nonce.</p>
<pre><code class="language-solidity">function getValueUnderNonce(uint256 _key) external view returns (uint256);
</code></pre>
<h3 id="incrementminnonceifequals"><a class="header" href="#incrementminnonceifequals">incrementMinNonceIfEquals</a></h3>
<p>A convenience method to increment the minimal nonce if it is equal
to the <code>_expectedNonce</code>.</p>
<p>This function only increments <code>minNonce</code> for nonces with nonceKey == 0.
AAs that try to use this method with a keyed nonce will revert.
For keyed nonces, <code>incrementMinNonceIfEqualsKeyed</code> should be used.
This is to prevent DefaultAccount and other deployed AAs from
unintentionally allowing keyed nonces to be used.</p>
<pre><code class="language-solidity">function incrementMinNonceIfEquals(uint256 _expectedNonce) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_expectedNonce</code></td><td><code>uint256</code></td><td>The expected minimal nonce for the account.</td></tr>
</tbody></table>
</div>
<h3 id="incrementminnonceifequalskeyed"><a class="header" href="#incrementminnonceifequalskeyed">incrementMinNonceIfEqualsKeyed</a></h3>
<p>A convenience method to increment the minimal nonce if it is equal
to the <code>_expectedNonce</code>. This is a keyed counterpart to <code>incrementMinNonceIfEquals</code>.</p>
<p>Reverts for nonces with nonceKey == 0.</p>
<pre><code class="language-solidity">function incrementMinNonceIfEqualsKeyed(uint256 _expectedNonce) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_expectedNonce</code></td><td><code>uint256</code></td><td>The expected minimal nonce for the account.</td></tr>
</tbody></table>
</div>
<h3 id="getdeploymentnonce"><a class="header" href="#getdeploymentnonce">getDeploymentNonce</a></h3>
<p>Returns the deployment nonce for the accounts used for CREATE opcode.</p>
<pre><code class="language-solidity">function getDeploymentNonce(address _address) external view returns (uint256);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_address</code></td><td><code>address</code></td><td>The address to return the deploy nonce of.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint256</code></td><td>deploymentNonce The deployment nonce of the account.</td></tr>
</tbody></table>
</div>
<h3 id="incrementdeploymentnonce"><a class="header" href="#incrementdeploymentnonce">incrementDeploymentNonce</a></h3>
<p>Increments the deployment nonce for the account and returns the previous one.</p>
<pre><code class="language-solidity">function incrementDeploymentNonce(address _address) external returns (uint256);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_address</code></td><td><code>address</code></td><td>The address of the account which to return the deploy nonce for.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint256</code></td><td>prevDeploymentNonce The deployment nonce at the time this function is called.</td></tr>
</tbody></table>
</div>
<h3 id="validatenonceusage"><a class="header" href="#validatenonceusage">validateNonceUsage</a></h3>
<p>Checks and reverts based on whether the nonce is used (or not used).</p>
<p>This method should be used by the bootloader.</p>
<pre><code class="language-solidity">function validateNonceUsage(
  address _address,
  uint256 _key,
  bool _shouldBeUsed
) external view;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_address</code></td><td><code>address</code></td><td>The address the nonce of which is being checked.</td></tr>
<tr><td><code>_key</code></td><td><code>uint256</code></td><td>The nonce value which is tested.</td></tr>
<tr><td><code>_shouldBeUsed</code></td><td><code>bool</code></td><td>The flag for the method. If <code>true</code>, the method checks that whether this nonce is marked as used and reverts if this is not the case. If <code>false</code>, this method will check that the nonce has <em>not</em> been used yet, and revert otherwise.</td></tr>
</tbody></table>
</div>
<h3 id="isnonceused"><a class="header" href="#isnonceused">isNonceUsed</a></h3>
<p>Returns whether a nonce has been used for an account.</p>
<pre><code class="language-solidity">function isNonceUsed(address _address, uint256 _nonce)
  external
  view
  returns (bool);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_address</code></td><td><code>address</code></td><td>The address the nonce of which is being checked.</td></tr>
<tr><td><code>_nonce</code></td><td><code>uint256</code></td><td>The nonce value which is checked.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>bool</code></td><td><code>true</code> if the nonce has been used, <code>false</code> otherwise.</td></tr>
</tbody></table>
</div>
<h2 id="events-36"><a class="header" href="#events-36">Events</a></h2>
<h3 id="valuesetundernonce"><a class="header" href="#valuesetundernonce">ValueSetUnderNonce</a></h3>
<pre><code class="language-solidity">event ValueSetUnderNonce(
  address indexed accountAddress, uint256 indexed key, uint256 value
);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="ipaymaster-1"><a class="header" href="#ipaymaster-1">IPaymaster</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/interfaces/IPaymaster.sol">Git Source</a></p>
<p><strong>Author:</strong>
Matter Labs</p>
<p><strong>Note:</strong>
security-contact: security@matterlabs.dev</p>
<h2 id="functions-74"><a class="header" href="#functions-74">Functions</a></h2>
<h3 id="validateandpayforpaymastertransaction-1"><a class="header" href="#validateandpayforpaymastertransaction-1">validateAndPayForPaymasterTransaction</a></h3>
<p>Called by the bootloader to verify that the paymaster agrees to pay for the
fee for the transaction. This transaction should also send the necessary amount of funds onto the bootloader
address.</p>
<p>The developer should strive to preserve as many steps as possible both for valid
and invalid transactions as this very method is also used during the gas fee estimation
(without some of the necessary data, e.g. signature).</p>
<pre><code class="language-solidity">function validateAndPayForPaymasterTransaction(
  bytes32 _txHash,
  bytes32 _suggestedSignedHash,
  Transaction calldata _transaction
) external payable returns (bytes4 magic, bytes memory context);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_txHash</code></td><td><code>bytes32</code></td><td>The hash of the transaction</td></tr>
<tr><td><code>_suggestedSignedHash</code></td><td><code>bytes32</code></td><td>The hash of the transaction that is signed by an EOA</td></tr>
<tr><td><code>_transaction</code></td><td><code>Transaction</code></td><td>The transaction itself.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>magic</code></td><td><code>bytes4</code></td><td>The value that should be equal to the signature of the validateAndPayForPaymasterTransaction if the paymaster agrees to pay for the transaction.</td></tr>
<tr><td><code>context</code></td><td><code>bytes</code></td><td>The "context" of the transaction: an array of bytes of length at most 1024 bytes, which will be passed to the <code>postTransaction</code> method of the account.</td></tr>
</tbody></table>
</div>
<h3 id="posttransaction-1"><a class="header" href="#posttransaction-1">postTransaction</a></h3>
<p>Called by the bootloader after the execution of the transaction. Please note that
there is no guarantee that this method will be called at all. Unlike the original EIP4337,
this method won't be called if the transaction execution results in out-of-gas.</p>
<p>The exact amount refunded depends on the gas spent by the "postOp" itself and so the developers should
take that into account.</p>
<pre><code class="language-solidity">function postTransaction(
  bytes calldata _context,
  Transaction calldata _transaction,
  bytes32 _txHash,
  bytes32 _suggestedSignedHash,
  ExecutionResult _txResult,
  uint256 _maxRefundedGas
) external payable;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_context</code></td><td><code>bytes</code></td><td></td></tr>
<tr><td><code>_transaction</code></td><td><code>Transaction</code></td><td></td></tr>
<tr><td><code>_txHash</code></td><td><code>bytes32</code></td><td></td></tr>
<tr><td><code>_suggestedSignedHash</code></td><td><code>bytes32</code></td><td></td></tr>
<tr><td><code>_txResult</code></td><td><code>ExecutionResult</code></td><td></td></tr>
<tr><td><code>_maxRefundedGas</code></td><td><code>uint256</code></td><td></td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="constants-7"><a class="header" href="#constants-7">Constants</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/interfaces/IPaymaster.sol">Git Source</a></p>
<h3 id="paymaster_validation_success_magic-1"><a class="header" href="#paymaster_validation_success_magic-1">PAYMASTER_VALIDATION_SUCCESS_MAGIC</a></h3>
<pre><code class="language-solidity">bytes4 constant PAYMASTER_VALIDATION_SUCCESS_MAGIC =
IPaymaster.validateAndPayForPaymasterTransaction.selector
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="ipaymasterflow-1"><a class="header" href="#ipaymasterflow-1">IPaymasterFlow</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/interfaces/IPaymasterFlow.sol">Git Source</a></p>
<p><strong>Author:</strong>
Matter Labs</p>
<p>This is NOT an interface to be implemented
by contracts. It is just used for encoding.</p>
<p>The interface that is used for encoding/decoding of
different types of paymaster flows.</p>
<p><strong>Note:</strong>
security-contact: security@matterlabs.dev</p>
<h2 id="functions-75"><a class="header" href="#functions-75">Functions</a></h2>
<h3 id="general-1"><a class="header" href="#general-1">general</a></h3>
<pre><code class="language-solidity">function general(bytes calldata input) external;
</code></pre>
<h3 id="approvalbased-1"><a class="header" href="#approvalbased-1">approvalBased</a></h3>
<pre><code class="language-solidity">function approvalBased(
  address _token,
  uint256 _minAllowance,
  bytes calldata _innerInput
) external;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="ipubdatachunkpublisher"><a class="header" href="#ipubdatachunkpublisher">IPubdataChunkPublisher</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/interfaces/IPubdataChunkPublisher.sol">Git Source</a></p>
<p><strong>Author:</strong>
Matter Labs</p>
<p>Interface for contract responsible chunking pubdata into the appropriate size for EIP-4844 blobs.</p>
<p><strong>Note:</strong>
security-contact: security@matterlabs.dev</p>
<h2 id="functions-76"><a class="header" href="#functions-76">Functions</a></h2>
<h3 id="chunkpubdatatoblobs"><a class="header" href="#chunkpubdatatoblobs">chunkPubdataToBlobs</a></h3>
<p>Chunks pubdata into pieces that can fit into blobs.</p>
<p>Note: This is an early implementation, in the future we plan to support up to 16 blobs per l1 batch.</p>
<pre><code class="language-solidity">function chunkPubdataToBlobs(bytes calldata _pubdata)
  external
  view
  returns (bytes32[] memory blobLinearHashes);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_pubdata</code></td><td><code>bytes</code></td><td>The total l2 to l1 pubdata that will be sent via L1 blobs.</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="isystemcontext-1"><a class="header" href="#isystemcontext-1">ISystemContext</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/interfaces/ISystemContext.sol">Git Source</a></p>
<p><strong>Author:</strong>
Matter Labs</p>
<p>Contract that stores some of the context variables, that may be either
block-scoped, tx-scoped or system-wide.</p>
<p><strong>Note:</strong>
security-contact: security@matterlabs.dev</p>
<h2 id="functions-77"><a class="header" href="#functions-77">Functions</a></h2>
<h3 id="chainid"><a class="header" href="#chainid">chainId</a></h3>
<pre><code class="language-solidity">function chainId() external view returns (uint256);
</code></pre>
<h3 id="origin"><a class="header" href="#origin">origin</a></h3>
<pre><code class="language-solidity">function origin() external view returns (address);
</code></pre>
<h3 id="gasprice"><a class="header" href="#gasprice">gasPrice</a></h3>
<pre><code class="language-solidity">function gasPrice() external view returns (uint256);
</code></pre>
<h3 id="blockgaslimit"><a class="header" href="#blockgaslimit">blockGasLimit</a></h3>
<pre><code class="language-solidity">function blockGasLimit() external view returns (uint256);
</code></pre>
<h3 id="coinbase"><a class="header" href="#coinbase">coinbase</a></h3>
<pre><code class="language-solidity">function coinbase() external view returns (address);
</code></pre>
<h3 id="difficulty"><a class="header" href="#difficulty">difficulty</a></h3>
<pre><code class="language-solidity">function difficulty() external view returns (uint256);
</code></pre>
<h3 id="basefee"><a class="header" href="#basefee">baseFee</a></h3>
<pre><code class="language-solidity">function baseFee() external view returns (uint256);
</code></pre>
<h3 id="txnumberinblock"><a class="header" href="#txnumberinblock">txNumberInBlock</a></h3>
<pre><code class="language-solidity">function txNumberInBlock() external view returns (uint16);
</code></pre>
<h3 id="getblockhashevm"><a class="header" href="#getblockhashevm">getBlockHashEVM</a></h3>
<pre><code class="language-solidity">function getBlockHashEVM(uint256 _block) external view returns (bytes32);
</code></pre>
<h3 id="getbatchhash"><a class="header" href="#getbatchhash">getBatchHash</a></h3>
<pre><code class="language-solidity">function getBatchHash(uint256 _batchNumber)
  external
  view
  returns (bytes32 hash);
</code></pre>
<h3 id="getblocknumber"><a class="header" href="#getblocknumber">getBlockNumber</a></h3>
<pre><code class="language-solidity">function getBlockNumber() external view returns (uint128);
</code></pre>
<h3 id="getblocktimestamp"><a class="header" href="#getblocktimestamp">getBlockTimestamp</a></h3>
<pre><code class="language-solidity">function getBlockTimestamp() external view returns (uint128);
</code></pre>
<h3 id="getbatchnumberandtimestamp"><a class="header" href="#getbatchnumberandtimestamp">getBatchNumberAndTimestamp</a></h3>
<pre><code class="language-solidity">function getBatchNumberAndTimestamp()
  external
  view
  returns (uint128 blockNumber, uint128 blockTimestamp);
</code></pre>
<h3 id="getl2blocknumberandtimestamp"><a class="header" href="#getl2blocknumberandtimestamp">getL2BlockNumberAndTimestamp</a></h3>
<pre><code class="language-solidity">function getL2BlockNumberAndTimestamp()
  external
  view
  returns (uint128 blockNumber, uint128 blockTimestamp);
</code></pre>
<h3 id="gasperpubdatabyte"><a class="header" href="#gasperpubdatabyte">gasPerPubdataByte</a></h3>
<pre><code class="language-solidity">function gasPerPubdataByte() external view returns (uint256 gasPerPubdataByte);
</code></pre>
<h3 id="getcurrentpubdataspent"><a class="header" href="#getcurrentpubdataspent">getCurrentPubdataSpent</a></h3>
<pre><code class="language-solidity">function getCurrentPubdataSpent()
  external
  view
  returns (uint256 currentPubdataSpent);
</code></pre>
<h3 id="setchainid-1"><a class="header" href="#setchainid-1">setChainId</a></h3>
<pre><code class="language-solidity">function setChainId(uint256 _newChainId) external;
</code></pre>
<h2 id="structs-8"><a class="header" href="#structs-8">Structs</a></h2>
<h3 id="blockinfo"><a class="header" href="#blockinfo">BlockInfo</a></h3>
<pre><code class="language-solidity">struct BlockInfo {
  uint128 timestamp;
  uint128 number;
}
</code></pre>
<h3 id="virtualblockupgradeinfo"><a class="header" href="#virtualblockupgradeinfo">VirtualBlockUpgradeInfo</a></h3>
<p>A structure representing the timeline for the upgrade from the batch numbers to the L2 block numbers.</p>
<p>It will be used for the L1 batch -&gt; L2 block migration in Q3 2023 only.</p>
<pre><code class="language-solidity">struct VirtualBlockUpgradeInfo {
  /// @notice In order to maintain consistent results for `blockhash` requests, we'll
  /// have to remember the number of the batch when the upgrade to the virtual blocks has been done.
  /// The hashes for virtual blocks before the upgrade are identical to the hashes of the corresponding batches.
  uint128 virtualBlockStartBatch;
  /// @notice L2 block when the virtual blocks have caught up with the L2 blocks. Starting from this block,
  /// all the information returned to users for block.timestamp/number, etc should be the information about the L2 blocks and
  /// not virtual blocks.
  uint128 virtualBlockFinishL2Block;
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="isystemcontextdeprecated"><a class="header" href="#isystemcontextdeprecated">ISystemContextDeprecated</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/interfaces/ISystemContextDeprecated.sol">Git Source</a></p>
<p><strong>Author:</strong>
Matter Labs</p>
<p>The interface with deprecated functions of the SystemContext contract. It is aimed for backward compatibility.</p>
<p><strong>Note:</strong>
security-contact: security@matterlabs.dev</p>
<h2 id="functions-78"><a class="header" href="#functions-78">Functions</a></h2>
<h3 id="currentblockinfo"><a class="header" href="#currentblockinfo">currentBlockInfo</a></h3>
<pre><code class="language-solidity">function currentBlockInfo() external view returns (uint256);
</code></pre>
<h3 id="getblocknumberandtimestamp"><a class="header" href="#getblocknumberandtimestamp">getBlockNumberAndTimestamp</a></h3>
<pre><code class="language-solidity">function getBlockNumberAndTimestamp()
  external
  view
  returns (uint256 blockNumber, uint256 blockTimestamp);
</code></pre>
<h3 id="blockhash"><a class="header" href="#blockhash">blockHash</a></h3>
<pre><code class="language-solidity">function blockHash(uint256 _blockNumber) external view returns (bytes32 hash);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="ievmhashesstorage"><a class="header" href="#ievmhashesstorage">IEvmHashesStorage</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/interfaces/IEvmHashesStorage.sol">Git Source</a></p>
<p><strong>Author:</strong>
Matter Labs</p>
<p><strong>Note:</strong>
security-contact: security@matterlabs.de</p>
<h2 id="functions-79"><a class="header" href="#functions-79">Functions</a></h2>
<h3 id="storeevmcodehash"><a class="header" href="#storeevmcodehash">storeEvmCodeHash</a></h3>
<pre><code class="language-solidity">function storeEvmCodeHash(
  bytes32 versionedBytecodeHash,
  bytes32 evmBytecodeHash
) external;
</code></pre>
<h3 id="getevmcodehash"><a class="header" href="#getevmcodehash">getEvmCodeHash</a></h3>
<pre><code class="language-solidity">function getEvmCodeHash(bytes32 versionedBytecodeHash)
  external
  view
  returns (bytes32);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="ibridgedstandarderc20"><a class="header" href="#ibridgedstandarderc20">IBridgedStandardERC20</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/interfaces/IBridgedStandardERC20.sol">Git Source</a></p>
<p><strong>Author:</strong>
Matter Labs</p>
<p>The interface for the BridgedStandardERC20 contract</p>
<p><strong>Note:</strong>
security-contact: security@matterlabs.dev</p>
<h2 id="functions-80"><a class="header" href="#functions-80">Functions</a></h2>
<h3 id="reinitializetoken"><a class="header" href="#reinitializetoken">reinitializeToken</a></h3>
<p>A method to be called by the governor to update the token's metadata.</p>
<p>The _version must be exactly the version higher by 1 than the current version. This is needed
to ensure that the governor can not accidentally disable future reinitialization of the token.</p>
<pre><code class="language-solidity">function reinitializeToken(
  ERC20Getters calldata _availableGetters,
  string calldata _newName,
  string calldata _newSymbol,
  uint8 _version
) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_availableGetters</code></td><td><code>ERC20Getters</code></td><td>The getters that the token has.</td></tr>
<tr><td><code>_newName</code></td><td><code>string</code></td><td>The new name of the token.</td></tr>
<tr><td><code>_newSymbol</code></td><td><code>string</code></td><td>The new symbol of the token.</td></tr>
<tr><td><code>_version</code></td><td><code>uint8</code></td><td>The version of the token that will be initialized.</td></tr>
</tbody></table>
</div>
<h2 id="structs-9"><a class="header" href="#structs-9">Structs</a></h2>
<h3 id="erc20getters"><a class="header" href="#erc20getters">ERC20Getters</a></h3>
<p>Used to explicitly separate which getters the token has and which it does not.</p>
<p>Different tokens in L1 can implement or not implement getter function as <code>name</code>/<code>symbol</code>/<code>decimals</code>,</p>
<p>Our goal is to store all the getters that L1 token implements, and for others, we keep it as an unimplemented method.</p>
<p>Describes whether there is a specific getter in the token.</p>
<pre><code class="language-solidity">struct ERC20Getters {
  bool ignoreName;
  bool ignoreSymbol;
  bool ignoreDecimals;
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="il2assetrouter-1"><a class="header" href="#il2assetrouter-1">IL2AssetRouter</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/interfaces/IL2AssetRouter.sol">Git Source</a></p>
<p><strong>Author:</strong>
Matter Labs</p>
<p>The interface for the L2AssetRouter contract</p>
<p><strong>Note:</strong>
security-contact: security@matterlabs.dev</p>
<h2 id="functions-81"><a class="header" href="#functions-81">Functions</a></h2>
<h3 id="l2_legacy_shared_bridge"><a class="header" href="#l2_legacy_shared_bridge">L2_LEGACY_SHARED_BRIDGE</a></h3>
<pre><code class="language-solidity">function L2_LEGACY_SHARED_BRIDGE() external view returns (address);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="il2nativetokenvault-1"><a class="header" href="#il2nativetokenvault-1">IL2NativeTokenVault</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/interfaces/IL2NativeTokenVault.sol">Git Source</a></p>
<p><strong>Author:</strong>
Matter Labs</p>
<p>The interface for the L2NativeTokenVault contract</p>
<p><strong>Note:</strong>
security-contact: security@matterlabs.dev</p>
<h2 id="functions-82"><a class="header" href="#functions-82">Functions</a></h2>
<h3 id="tokenaddress-2"><a class="header" href="#tokenaddress-2">tokenAddress</a></h3>
<pre><code class="language-solidity">function tokenAddress(bytes32 _assetId) external view returns (address);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="errors-1"><a class="header" href="#errors-1">Errors</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="addresshasnocode"><a class="header" href="#addresshasnocode">AddressHasNoCode</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/SystemContractErrors.sol">Git Source</a></p>
<pre><code class="language-solidity">error AddressHasNoCode(address);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="callermustbebootloader"><a class="header" href="#callermustbebootloader">CallerMustBeBootloader</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/SystemContractErrors.sol">Git Source</a></p>
<pre><code class="language-solidity">error CallerMustBeBootloader();
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="callermustbeevmcontract"><a class="header" href="#callermustbeevmcontract">CallerMustBeEvmContract</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/SystemContractErrors.sol">Git Source</a></p>
<pre><code class="language-solidity">error CallerMustBeEvmContract();
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="callermustbesystemcontract"><a class="header" href="#callermustbesystemcontract">CallerMustBeSystemContract</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/SystemContractErrors.sol">Git Source</a></p>
<pre><code class="language-solidity">error CallerMustBeSystemContract();
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="compressionvalueadderror"><a class="header" href="#compressionvalueadderror">CompressionValueAddError</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/SystemContractErrors.sol">Git Source</a></p>
<pre><code class="language-solidity">error CompressionValueAddError(uint256 expected, uint256 actual);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="compressionvaluetransformerror"><a class="header" href="#compressionvaluetransformerror">CompressionValueTransformError</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/SystemContractErrors.sol">Git Source</a></p>
<pre><code class="language-solidity">error CompressionValueTransformError(uint256 expected, uint256 actual);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="compressionvaluesuberror"><a class="header" href="#compressionvaluesuberror">CompressionValueSubError</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/SystemContractErrors.sol">Git Source</a></p>
<pre><code class="language-solidity">error CompressionValueSubError(uint256 expected, uint256 actual);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="compressorinitialwritesprocessednotequal"><a class="header" href="#compressorinitialwritesprocessednotequal">CompressorInitialWritesProcessedNotEqual</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/SystemContractErrors.sol">Git Source</a></p>
<pre><code class="language-solidity">error CompressorInitialWritesProcessedNotEqual(
uint256 expected, uint256 actual
);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="compressorenumindexnotequal"><a class="header" href="#compressorenumindexnotequal">CompressorEnumIndexNotEqual</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/SystemContractErrors.sol">Git Source</a></p>
<pre><code class="language-solidity">error CompressorEnumIndexNotEqual(uint256 expected, uint256 actual);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="derivedkeynotequaltocompressedvalue"><a class="header" href="#derivedkeynotequaltocompressedvalue">DerivedKeyNotEqualToCompressedValue</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/SystemContractErrors.sol">Git Source</a></p>
<pre><code class="language-solidity">error DerivedKeyNotEqualToCompressedValue(bytes32 expected, bytes32 provided);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="dictionarydividedbyeightnotgreaterthanencodeddividedbytwo"><a class="header" href="#dictionarydividedbyeightnotgreaterthanencodeddividedbytwo">DictionaryDividedByEightNotGreaterThanEncodedDividedByTwo</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/SystemContractErrors.sol">Git Source</a></p>
<pre><code class="language-solidity">error DictionaryDividedByEightNotGreaterThanEncodedDividedByTwo();
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="emptybytes32"><a class="header" href="#emptybytes32">EmptyBytes32</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/SystemContractErrors.sol">Git Source</a></p>
<pre><code class="language-solidity">error EmptyBytes32();
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="encodedandrealbytecodechunknotequal"><a class="header" href="#encodedandrealbytecodechunknotequal">EncodedAndRealBytecodeChunkNotEqual</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/SystemContractErrors.sol">Git Source</a></p>
<pre><code class="language-solidity">error EncodedAndRealBytecodeChunkNotEqual(uint64 expected, uint64 provided);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="encodedlengthnotfourtimessmallerthanoriginal"><a class="header" href="#encodedlengthnotfourtimessmallerthanoriginal">EncodedLengthNotFourTimesSmallerThanOriginal</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/SystemContractErrors.sol">Git Source</a></p>
<pre><code class="language-solidity">error EncodedLengthNotFourTimesSmallerThanOriginal();
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="evmbytecodehash"><a class="header" href="#evmbytecodehash">EVMBytecodeHash</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/SystemContractErrors.sol">Git Source</a></p>
<pre><code class="language-solidity">error EVMBytecodeHash();
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="evmbytecodehashunknown"><a class="header" href="#evmbytecodehashunknown">EVMBytecodeHashUnknown</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/SystemContractErrors.sol">Git Source</a></p>
<pre><code class="language-solidity">error EVMBytecodeHashUnknown();
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="evmemulationnotsupported"><a class="header" href="#evmemulationnotsupported">EVMEmulationNotSupported</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/SystemContractErrors.sol">Git Source</a></p>
<pre><code class="language-solidity">error EVMEmulationNotSupported();
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="failedtochargegas"><a class="header" href="#failedtochargegas">FailedToChargeGas</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/SystemContractErrors.sol">Git Source</a></p>
<pre><code class="language-solidity">error FailedToChargeGas();
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="failedtopayoperator"><a class="header" href="#failedtopayoperator">FailedToPayOperator</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/SystemContractErrors.sol">Git Source</a></p>
<pre><code class="language-solidity">error FailedToPayOperator();
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="hashisnonzero"><a class="header" href="#hashisnonzero">HashIsNonZero</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/SystemContractErrors.sol">Git Source</a></p>
<pre><code class="language-solidity">error HashIsNonZero(bytes32);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="hashmismatch"><a class="header" href="#hashmismatch">HashMismatch</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/SystemContractErrors.sol">Git Source</a></p>
<pre><code class="language-solidity">error HashMismatch(bytes32 expected, bytes32 actual);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="indexoutofbounds"><a class="header" href="#indexoutofbounds">IndexOutOfBounds</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/SystemContractErrors.sol">Git Source</a></p>
<pre><code class="language-solidity">error IndexOutOfBounds();
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="indexsizeerror"><a class="header" href="#indexsizeerror">IndexSizeError</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/SystemContractErrors.sol">Git Source</a></p>
<pre><code class="language-solidity">error IndexSizeError();
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="insufficientfunds"><a class="header" href="#insufficientfunds">InsufficientFunds</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/SystemContractErrors.sol">Git Source</a></p>
<pre><code class="language-solidity">error InsufficientFunds(uint256 required, uint256 actual);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="invalidcall"><a class="header" href="#invalidcall">InvalidCall</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/SystemContractErrors.sol">Git Source</a></p>
<pre><code class="language-solidity">error InvalidCall();
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="invalidcodehash"><a class="header" href="#invalidcodehash">InvalidCodeHash</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/SystemContractErrors.sol">Git Source</a></p>
<pre><code class="language-solidity">error InvalidCodeHash(CodeHashReason);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="invalidinput"><a class="header" href="#invalidinput">InvalidInput</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/SystemContractErrors.sol">Git Source</a></p>
<pre><code class="language-solidity">error InvalidInput();
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="invalidnonceorderingchange"><a class="header" href="#invalidnonceorderingchange">InvalidNonceOrderingChange</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/SystemContractErrors.sol">Git Source</a></p>
<pre><code class="language-solidity">error InvalidNonceOrderingChange();
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="invalidsig"><a class="header" href="#invalidsig">InvalidSig</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/SystemContractErrors.sol">Git Source</a></p>
<pre><code class="language-solidity">error InvalidSig(SigField, uint256);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="keccak256invalidreturndata"><a class="header" href="#keccak256invalidreturndata">Keccak256InvalidReturnData</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/SystemContractErrors.sol">Git Source</a></p>
<pre><code class="language-solidity">error Keccak256InvalidReturnData();
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="malformedbytecode"><a class="header" href="#malformedbytecode">MalformedBytecode</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/SystemContractErrors.sol">Git Source</a></p>
<pre><code class="language-solidity">error MalformedBytecode(BytecodeError);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="noncealreadyused"><a class="header" href="#noncealreadyused">NonceAlreadyUsed</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/SystemContractErrors.sol">Git Source</a></p>
<pre><code class="language-solidity">error NonceAlreadyUsed(address account, uint256 nonce);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="nonceincreaseerror"><a class="header" href="#nonceincreaseerror">NonceIncreaseError</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/SystemContractErrors.sol">Git Source</a></p>
<pre><code class="language-solidity">error NonceIncreaseError(uint256 min, uint256 max, uint256 proposed);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="noncejumperror"><a class="header" href="#noncejumperror">NonceJumpError</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="noncenotused"><a class="header" href="#noncenotused">NonceNotUsed</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/SystemContractErrors.sol">Git Source</a></p>
<pre><code class="language-solidity">error NonceNotUsed(address account, uint256 nonce);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="nonemptyaccount"><a class="header" href="#nonemptyaccount">NonEmptyAccount</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/SystemContractErrors.sol">Git Source</a></p>
<pre><code class="language-solidity">error NonEmptyAccount();
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="nonemptymsgvalue"><a class="header" href="#nonemptymsgvalue">NonEmptyMsgValue</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/SystemContractErrors.sol">Git Source</a></p>
<pre><code class="language-solidity">error NonEmptyMsgValue();
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="notallowedtodeployinkernelspace"><a class="header" href="#notallowedtodeployinkernelspace">NotAllowedToDeployInKernelSpace</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/SystemContractErrors.sol">Git Source</a></p>
<pre><code class="language-solidity">error NotAllowedToDeployInKernelSpace();
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="overflow"><a class="header" href="#overflow">Overflow</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/SystemContractErrors.sol">Git Source</a></p>
<pre><code class="language-solidity">error Overflow();
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="reconstructionmismatch"><a class="header" href="#reconstructionmismatch">ReconstructionMismatch</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/SystemContractErrors.sol">Git Source</a></p>
<pre><code class="language-solidity">error ReconstructionMismatch(PubdataField, bytes32 expected, bytes32 actual);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="shainvalidreturndata"><a class="header" href="#shainvalidreturndata">ShaInvalidReturnData</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/SystemContractErrors.sol">Git Source</a></p>
<pre><code class="language-solidity">error ShaInvalidReturnData();
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="statedifflengthmismatch"><a class="header" href="#statedifflengthmismatch">StateDiffLengthMismatch</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/SystemContractErrors.sol">Git Source</a></p>
<pre><code class="language-solidity">error StateDiffLengthMismatch();
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="systemcallflagrequired"><a class="header" href="#systemcallflagrequired">SystemCallFlagRequired</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/SystemContractErrors.sol">Git Source</a></p>
<pre><code class="language-solidity">error SystemCallFlagRequired();
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="toomuchpubdata"><a class="header" href="#toomuchpubdata">TooMuchPubdata</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/SystemContractErrors.sol">Git Source</a></p>
<pre><code class="language-solidity">error TooMuchPubdata(uint256 limit, uint256 supplied);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="unauthorized"><a class="header" href="#unauthorized">Unauthorized</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/SystemContractErrors.sol">Git Source</a></p>
<pre><code class="language-solidity">error Unauthorized(address);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="unknowncodehash"><a class="header" href="#unknowncodehash">UnknownCodeHash</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/SystemContractErrors.sol">Git Source</a></p>
<pre><code class="language-solidity">error UnknownCodeHash(bytes32);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="unsupportedoperation"><a class="header" href="#unsupportedoperation">UnsupportedOperation</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/SystemContractErrors.sol">Git Source</a></p>
<pre><code class="language-solidity">error UnsupportedOperation();
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="unsupportedpaymasterflow"><a class="header" href="#unsupportedpaymasterflow">UnsupportedPaymasterFlow</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/SystemContractErrors.sol">Git Source</a></p>
<pre><code class="language-solidity">error UnsupportedPaymasterFlow();
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="unsupportedtxtype"><a class="header" href="#unsupportedtxtype">UnsupportedTxType</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/SystemContractErrors.sol">Git Source</a></p>
<pre><code class="language-solidity">error UnsupportedTxType(uint256);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="valuemismatch"><a class="header" href="#valuemismatch">ValueMismatch</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/SystemContractErrors.sol">Git Source</a></p>
<pre><code class="language-solidity">error ValueMismatch(uint256 expected, uint256 actual);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="zerononceerror"><a class="header" href="#zerononceerror">ZeroNonceError</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/SystemContractErrors.sol">Git Source</a></p>
<pre><code class="language-solidity">error ZeroNonceError();
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="sloadcontractbytecodeunknown"><a class="header" href="#sloadcontractbytecodeunknown">SloadContractBytecodeUnknown</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/SystemContractErrors.sol">Git Source</a></p>
<pre><code class="language-solidity">error SloadContractBytecodeUnknown();
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="previousbytecodeunknown"><a class="header" href="#previousbytecodeunknown">PreviousBytecodeUnknown</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/SystemContractErrors.sol">Git Source</a></p>
<pre><code class="language-solidity">error PreviousBytecodeUnknown();
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="invalidchainid"><a class="header" href="#invalidchainid">InvalidChainId</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/SystemContractErrors.sol">Git Source</a></p>
<pre><code class="language-solidity">error InvalidChainId();
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="upgradetransactionmustbefirst"><a class="header" href="#upgradetransactionmustbefirst">UpgradeTransactionMustBeFirst</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/SystemContractErrors.sol">Git Source</a></p>
<pre><code class="language-solidity">error UpgradeTransactionMustBeFirst();
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="l2blocknumberzero"><a class="header" href="#l2blocknumberzero">L2BlockNumberZero</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/SystemContractErrors.sol">Git Source</a></p>
<pre><code class="language-solidity">error L2BlockNumberZero();
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="previousl2blockhashisincorrect"><a class="header" href="#previousl2blockhashisincorrect">PreviousL2BlockHashIsIncorrect</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/SystemContractErrors.sol">Git Source</a></p>
<pre><code class="language-solidity">error PreviousL2BlockHashIsIncorrect(
bytes32 correctPrevBlockHash, bytes32 expectedPrevL2BlockHash
);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="cannotinitializefirstvirtualblock"><a class="header" href="#cannotinitializefirstvirtualblock">CannotInitializeFirstVirtualBlock</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/SystemContractErrors.sol">Git Source</a></p>
<pre><code class="language-solidity">error CannotInitializeFirstVirtualBlock();
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="l2blockandbatchtimestampmismatch"><a class="header" href="#l2blockandbatchtimestampmismatch">L2BlockAndBatchTimestampMismatch</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/SystemContractErrors.sol">Git Source</a></p>
<pre><code class="language-solidity">error L2BlockAndBatchTimestampMismatch(
uint128 l2BlockTimestamp, uint128 currentBatchTimestamp
);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="inconsistentnewbatchtimestamp"><a class="header" href="#inconsistentnewbatchtimestamp">InconsistentNewBatchTimestamp</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/SystemContractErrors.sol">Git Source</a></p>
<pre><code class="language-solidity">error InconsistentNewBatchTimestamp(
uint128 newBatchTimestamp, uint128 lastL2BlockTimestamp
);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="novirtualblocks"><a class="header" href="#novirtualblocks">NoVirtualBlocks</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/SystemContractErrors.sol">Git Source</a></p>
<pre><code class="language-solidity">error NoVirtualBlocks();
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="cannotreusel2blocknumberfrompreviousbatch"><a class="header" href="#cannotreusel2blocknumberfrompreviousbatch">CannotReuseL2BlockNumberFromPreviousBatch</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/SystemContractErrors.sol">Git Source</a></p>
<pre><code class="language-solidity">error CannotReuseL2BlockNumberFromPreviousBatch();
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="incorrectsamel2blocktimestamp"><a class="header" href="#incorrectsamel2blocktimestamp">IncorrectSameL2BlockTimestamp</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/SystemContractErrors.sol">Git Source</a></p>
<pre><code class="language-solidity">error IncorrectSameL2BlockTimestamp(
uint128 l2BlockTimestamp, uint128 currentL2BlockTimestamp
);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="incorrectsamel2blockprevblockhash"><a class="header" href="#incorrectsamel2blockprevblockhash">IncorrectSameL2BlockPrevBlockHash</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/SystemContractErrors.sol">Git Source</a></p>
<pre><code class="language-solidity">error IncorrectSameL2BlockPrevBlockHash(
bytes32 expectedPrevL2BlockHash, bytes32 latestL2blockHash
);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="incorrectvirtualblockinsideminiblock"><a class="header" href="#incorrectvirtualblockinsideminiblock">IncorrectVirtualBlockInsideMiniblock</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/SystemContractErrors.sol">Git Source</a></p>
<pre><code class="language-solidity">error IncorrectVirtualBlockInsideMiniblock();
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="incorrectl2blockhash"><a class="header" href="#incorrectl2blockhash">IncorrectL2BlockHash</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/SystemContractErrors.sol">Git Source</a></p>
<pre><code class="language-solidity">error IncorrectL2BlockHash(
bytes32 expectedPrevL2BlockHash, bytes32 pendingL2BlockHash
);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="nonmonotonicl2blocktimestamp"><a class="header" href="#nonmonotonicl2blocktimestamp">NonMonotonicL2BlockTimestamp</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/SystemContractErrors.sol">Git Source</a></p>
<pre><code class="language-solidity">error NonMonotonicL2BlockTimestamp(
uint128 l2BlockTimestamp, uint128 currentL2BlockTimestamp
);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="currentbatchnumbermustbegreaterthanzero"><a class="header" href="#currentbatchnumbermustbegreaterthanzero">CurrentBatchNumberMustBeGreaterThanZero</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/SystemContractErrors.sol">Git Source</a></p>
<pre><code class="language-solidity">error CurrentBatchNumberMustBeGreaterThanZero();
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="timestampsshouldbeincremental"><a class="header" href="#timestampsshouldbeincremental">TimestampsShouldBeIncremental</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/SystemContractErrors.sol">Git Source</a></p>
<pre><code class="language-solidity">error TimestampsShouldBeIncremental(
uint128 newTimestamp, uint128 previousBatchTimestamp
);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="providedbatchnumberisnotcorrect"><a class="header" href="#providedbatchnumberisnotcorrect">ProvidedBatchNumberIsNotCorrect</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/SystemContractErrors.sol">Git Source</a></p>
<pre><code class="language-solidity">error ProvidedBatchNumberIsNotCorrect(
uint128 previousBatchNumber, uint128 _expectedNewNumber
);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="codeoraclecallfailed"><a class="header" href="#codeoraclecallfailed">CodeOracleCallFailed</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/SystemContractErrors.sol">Git Source</a></p>
<pre><code class="language-solidity">error CodeOracleCallFailed();
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="returnedbytecodedoesnotmatchexpectedhash"><a class="header" href="#returnedbytecodedoesnotmatchexpectedhash">ReturnedBytecodeDoesNotMatchExpectedHash</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/SystemContractErrors.sol">Git Source</a></p>
<pre><code class="language-solidity">error ReturnedBytecodeDoesNotMatchExpectedHash(
bytes32 returnedBytecode, bytes32 expectedBytecodeHash
);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="secondcallshouldhavecostlessgas"><a class="header" href="#secondcallshouldhavecostlessgas">SecondCallShouldHaveCostLessGas</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/SystemContractErrors.sol">Git Source</a></p>
<pre><code class="language-solidity">error SecondCallShouldHaveCostLessGas(
uint256 secondCallCost, uint256 firstCallCost
);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="thirdcallshouldhavesamegascostassecondcall"><a class="header" href="#thirdcallshouldhavesamegascostassecondcall">ThirdCallShouldHaveSameGasCostAsSecondCall</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/SystemContractErrors.sol">Git Source</a></p>
<pre><code class="language-solidity">error ThirdCallShouldHaveSameGasCostAsSecondCall(
uint256 thirdCallCost, uint256 secondCallCost
);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="calltokeccakshouldhavesucceeded"><a class="header" href="#calltokeccakshouldhavesucceeded">CallToKeccakShouldHaveSucceeded</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/SystemContractErrors.sol">Git Source</a></p>
<pre><code class="language-solidity">error CallToKeccakShouldHaveSucceeded();
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="keccakreturndatasizeshouldbe32bytes"><a class="header" href="#keccakreturndatasizeshouldbe32bytes">KeccakReturnDataSizeShouldBe32Bytes</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/SystemContractErrors.sol">Git Source</a></p>
<pre><code class="language-solidity">error KeccakReturnDataSizeShouldBe32Bytes(uint256 returnDataSize);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="keccakresultisnotcorrect"><a class="header" href="#keccakresultisnotcorrect">KeccakResultIsNotCorrect</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/SystemContractErrors.sol">Git Source</a></p>
<pre><code class="language-solidity">error KeccakResultIsNotCorrect(bytes32 result);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="keccakshouldstartworkingagain"><a class="header" href="#keccakshouldstartworkingagain">KeccakShouldStartWorkingAgain</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/SystemContractErrors.sol">Git Source</a></p>
<pre><code class="language-solidity">error KeccakShouldStartWorkingAgain();
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="keccakmismatchbetweennumberofinputsandoutputs"><a class="header" href="#keccakmismatchbetweennumberofinputsandoutputs">KeccakMismatchBetweenNumberOfInputsAndOutputs</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/SystemContractErrors.sol">Git Source</a></p>
<pre><code class="language-solidity">error KeccakMismatchBetweenNumberOfInputsAndOutputs(
uint256 testInputsLength, uint256 expectedOutputsLength
);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="keccakhashwasnotcalculatedcorrectly"><a class="header" href="#keccakhashwasnotcalculatedcorrectly">KeccakHashWasNotCalculatedCorrectly</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/SystemContractErrors.sol">Git Source</a></p>
<pre><code class="language-solidity">error KeccakHashWasNotCalculatedCorrectly(
bytes32 result, bytes32 expectedOutputs
);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="transactionfailed"><a class="header" href="#transactionfailed">TransactionFailed</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/SystemContractErrors.sol">Git Source</a></p>
<pre><code class="language-solidity">error TransactionFailed();
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="notenoughgas"><a class="header" href="#notenoughgas">NotEnoughGas</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/SystemContractErrors.sol">Git Source</a></p>
<pre><code class="language-solidity">error NotEnoughGas();
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="toomuchgas"><a class="header" href="#toomuchgas">TooMuchGas</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/SystemContractErrors.sol">Git Source</a></p>
<pre><code class="language-solidity">error TooMuchGas();
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="invalidnewl2blocknumber"><a class="header" href="#invalidnewl2blocknumber">InvalidNewL2BlockNumber</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/SystemContractErrors.sol">Git Source</a></p>
<pre><code class="language-solidity">error InvalidNewL2BlockNumber(uint256 l2BlockNumber);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="codehashreason"><a class="header" href="#codehashreason">CodeHashReason</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/SystemContractErrors.sol">Git Source</a></p>
<pre><code class="language-solidity">enum CodeHashReason {
NotContractOnConstructor,
NotConstructedContract
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="sigfield"><a class="header" href="#sigfield">SigField</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/SystemContractErrors.sol">Git Source</a></p>
<pre><code class="language-solidity">enum SigField {
Length,
V,
S
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="pubdatafield"><a class="header" href="#pubdatafield">PubdataField</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/SystemContractErrors.sol">Git Source</a></p>
<pre><code class="language-solidity">enum PubdataField {
NumberOfLogs,
LogsHash,
MsgHash,
Bytecode,
InputDAFunctionSig,
InputLogsHash,
InputLogsRootHash,
InputMsgsHash,
InputBytecodeHash,
Offset,
Length
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="bytecodeerror"><a class="header" href="#bytecodeerror">BytecodeError</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/SystemContractErrors.sol">Git Source</a></p>
<pre><code class="language-solidity">enum BytecodeError {
Version,
NumberOfWords,
Length,
WordsMustBeOdd,
DictionaryLength,
EvmBytecodeLength,
EvmBytecodeLengthTooBig
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="constants-8"><a class="header" href="#constants-8">Constants</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/Constants.sol">Git Source</a></p>
<h3 id="system_contracts_offset"><a class="header" href="#system_contracts_offset">SYSTEM_CONTRACTS_OFFSET</a></h3>
<p>All the system contracts introduced by ZKsync have their addresses
started from 2^15 in order to avoid collision with Ethereum precompiles.</p>
<pre><code class="language-solidity">uint160 constant SYSTEM_CONTRACTS_OFFSET = 0x8000
</code></pre>
<h3 id="real_system_contracts_offset"><a class="header" href="#real_system_contracts_offset">REAL_SYSTEM_CONTRACTS_OFFSET</a></h3>
<p>Unlike the value above, it is not overridden for the purpose of testing and
is identical to the constant value actually used as the system contracts offset on
mainnet.</p>
<pre><code class="language-solidity">uint160 constant REAL_SYSTEM_CONTRACTS_OFFSET = 0x8000
</code></pre>
<h3 id="max_system_contract_address"><a class="header" href="#max_system_contract_address">MAX_SYSTEM_CONTRACT_ADDRESS</a></h3>
<p>All the system contracts must be located in the kernel space,
i.e. their addresses must be below 2^16.</p>
<pre><code class="language-solidity">uint160 constant MAX_SYSTEM_CONTRACT_ADDRESS = 0xffff
</code></pre>
<h3 id="user_contracts_offset"><a class="header" href="#user_contracts_offset">USER_CONTRACTS_OFFSET</a></h3>
<p>The offset from which the built-in, but user space contracts are located.</p>
<pre><code class="language-solidity">uint160 constant USER_CONTRACTS_OFFSET = MAX_SYSTEM_CONTRACT_ADDRESS + 1
</code></pre>
<h3 id="ecrecover_system_contract"><a class="header" href="#ecrecover_system_contract">ECRECOVER_SYSTEM_CONTRACT</a></h3>
<pre><code class="language-solidity">address constant ECRECOVER_SYSTEM_CONTRACT = address(0x01)
</code></pre>
<h3 id="sha256_system_contract"><a class="header" href="#sha256_system_contract">SHA256_SYSTEM_CONTRACT</a></h3>
<pre><code class="language-solidity">address constant SHA256_SYSTEM_CONTRACT = address(0x02)
</code></pre>
<h3 id="identity_system_contract"><a class="header" href="#identity_system_contract">IDENTITY_SYSTEM_CONTRACT</a></h3>
<pre><code class="language-solidity">address constant IDENTITY_SYSTEM_CONTRACT = address(0x04)
</code></pre>
<h3 id="modexp_system_contract"><a class="header" href="#modexp_system_contract">MODEXP_SYSTEM_CONTRACT</a></h3>
<pre><code class="language-solidity">address constant MODEXP_SYSTEM_CONTRACT = address(0x05)
</code></pre>
<h3 id="ecadd_system_contract"><a class="header" href="#ecadd_system_contract">ECADD_SYSTEM_CONTRACT</a></h3>
<pre><code class="language-solidity">address constant ECADD_SYSTEM_CONTRACT = address(0x06)
</code></pre>
<h3 id="ecmul_system_contract"><a class="header" href="#ecmul_system_contract">ECMUL_SYSTEM_CONTRACT</a></h3>
<pre><code class="language-solidity">address constant ECMUL_SYSTEM_CONTRACT = address(0x07)
</code></pre>
<h3 id="ecpairing_system_contract"><a class="header" href="#ecpairing_system_contract">ECPAIRING_SYSTEM_CONTRACT</a></h3>
<pre><code class="language-solidity">address constant ECPAIRING_SYSTEM_CONTRACT = address(0x08)
</code></pre>
<h3 id="computational_price_for_pubdata"><a class="header" href="#computational_price_for_pubdata">COMPUTATIONAL_PRICE_FOR_PUBDATA</a></h3>
<p>The number of gas that need to be spent for a single byte of pubdata regardless of the pubdata price.
This variable is used to ensure the following:</p>
<ul>
<li>That the long-term storage of the operator is compensated properly.</li>
<li>That it is not possible that the pubdata counter grows too high without spending proportional amount of computation.</li>
</ul>
<pre><code class="language-solidity">uint256 constant COMPUTATIONAL_PRICE_FOR_PUBDATA = 80
</code></pre>
<h3 id="current_max_precompile_address"><a class="header" href="#current_max_precompile_address">CURRENT_MAX_PRECOMPILE_ADDRESS</a></h3>
<p>The maximal possible address of an L1-like precompie. These precompiles maintain the following properties:</p>
<ul>
<li>Their extcodehash is EMPTY_STRING_KECCAK</li>
<li>Their extcodesize is 0 despite having a bytecode formally deployed there.</li>
</ul>
<pre><code class="language-solidity">uint256 constant CURRENT_MAX_PRECOMPILE_ADDRESS = 0xff
</code></pre>
<h3 id="bootloader_formal_address"><a class="header" href="#bootloader_formal_address">BOOTLOADER_FORMAL_ADDRESS</a></h3>
<pre><code class="language-solidity">address payable constant BOOTLOADER_FORMAL_ADDRESS =
payable(address(SYSTEM_CONTRACTS_OFFSET + 0x01))
</code></pre>
<h3 id="account_code_storage_system_contract"><a class="header" href="#account_code_storage_system_contract">ACCOUNT_CODE_STORAGE_SYSTEM_CONTRACT</a></h3>
<pre><code class="language-solidity">IAccountCodeStorage constant ACCOUNT_CODE_STORAGE_SYSTEM_CONTRACT =
IAccountCodeStorage(address(SYSTEM_CONTRACTS_OFFSET + 0x02))
</code></pre>
<h3 id="nonce_holder_system_contract"><a class="header" href="#nonce_holder_system_contract">NONCE_HOLDER_SYSTEM_CONTRACT</a></h3>
<pre><code class="language-solidity">INonceHolder constant NONCE_HOLDER_SYSTEM_CONTRACT =
INonceHolder(address(SYSTEM_CONTRACTS_OFFSET + 0x03))
</code></pre>
<h3 id="known_code_storage_contract"><a class="header" href="#known_code_storage_contract">KNOWN_CODE_STORAGE_CONTRACT</a></h3>
<pre><code class="language-solidity">IKnownCodesStorage constant KNOWN_CODE_STORAGE_CONTRACT =
IKnownCodesStorage(address(SYSTEM_CONTRACTS_OFFSET + 0x04))
</code></pre>
<h3 id="immutable_simulator_system_contract"><a class="header" href="#immutable_simulator_system_contract">IMMUTABLE_SIMULATOR_SYSTEM_CONTRACT</a></h3>
<pre><code class="language-solidity">IImmutableSimulator constant IMMUTABLE_SIMULATOR_SYSTEM_CONTRACT =
IImmutableSimulator(address(SYSTEM_CONTRACTS_OFFSET + 0x05))
</code></pre>
<h3 id="deployer_system_contract"><a class="header" href="#deployer_system_contract">DEPLOYER_SYSTEM_CONTRACT</a></h3>
<pre><code class="language-solidity">IContractDeployer constant DEPLOYER_SYSTEM_CONTRACT =
IContractDeployer(address(SYSTEM_CONTRACTS_OFFSET + 0x06))
</code></pre>
<h3 id="real_deployer_system_contract"><a class="header" href="#real_deployer_system_contract">REAL_DEPLOYER_SYSTEM_CONTRACT</a></h3>
<pre><code class="language-solidity">IContractDeployer constant REAL_DEPLOYER_SYSTEM_CONTRACT =
IContractDeployer(address(REAL_SYSTEM_CONTRACTS_OFFSET + 0x06))
</code></pre>
<h3 id="force_deployer"><a class="header" href="#force_deployer">FORCE_DEPLOYER</a></h3>
<pre><code class="language-solidity">address constant FORCE_DEPLOYER = address(SYSTEM_CONTRACTS_OFFSET + 0x07)
</code></pre>
<h3 id="l1_messenger_contract"><a class="header" href="#l1_messenger_contract">L1_MESSENGER_CONTRACT</a></h3>
<pre><code class="language-solidity">IL1Messenger constant L1_MESSENGER_CONTRACT =
IL1Messenger(address(SYSTEM_CONTRACTS_OFFSET + 0x08))
</code></pre>
<h3 id="msg_value_system_contract"><a class="header" href="#msg_value_system_contract">MSG_VALUE_SYSTEM_CONTRACT</a></h3>
<pre><code class="language-solidity">address constant MSG_VALUE_SYSTEM_CONTRACT =
address(SYSTEM_CONTRACTS_OFFSET + 0x09)
</code></pre>
<h3 id="base_token_system_contract"><a class="header" href="#base_token_system_contract">BASE_TOKEN_SYSTEM_CONTRACT</a></h3>
<pre><code class="language-solidity">IBaseToken constant BASE_TOKEN_SYSTEM_CONTRACT =
IBaseToken(address(SYSTEM_CONTRACTS_OFFSET + 0x0a))
</code></pre>
<h3 id="real_base_token_system_contract"><a class="header" href="#real_base_token_system_contract">REAL_BASE_TOKEN_SYSTEM_CONTRACT</a></h3>
<pre><code class="language-solidity">IBaseToken constant REAL_BASE_TOKEN_SYSTEM_CONTRACT =
IBaseToken(address(REAL_SYSTEM_CONTRACTS_OFFSET + 0x0a))
</code></pre>
<h3 id="system_context_contract"><a class="header" href="#system_context_contract">SYSTEM_CONTEXT_CONTRACT</a></h3>
<pre><code class="language-solidity">ISystemContext constant SYSTEM_CONTEXT_CONTRACT =
ISystemContext(payable(address(SYSTEM_CONTRACTS_OFFSET + 0x0b)))
</code></pre>
<h3 id="real_system_context_contract"><a class="header" href="#real_system_context_contract">REAL_SYSTEM_CONTEXT_CONTRACT</a></h3>
<pre><code class="language-solidity">ISystemContext constant REAL_SYSTEM_CONTEXT_CONTRACT =
ISystemContext(payable(address(REAL_SYSTEM_CONTRACTS_OFFSET + 0x0b)))
</code></pre>
<h3 id="bootloader_utilities"><a class="header" href="#bootloader_utilities">BOOTLOADER_UTILITIES</a></h3>
<pre><code class="language-solidity">IBootloaderUtilities constant BOOTLOADER_UTILITIES =
IBootloaderUtilities(address(SYSTEM_CONTRACTS_OFFSET + 0x0c))
</code></pre>
<h3 id="event_writer_contract"><a class="header" href="#event_writer_contract">EVENT_WRITER_CONTRACT</a></h3>
<pre><code class="language-solidity">address constant EVENT_WRITER_CONTRACT =
address(SYSTEM_CONTRACTS_OFFSET + 0x0d)
</code></pre>
<h3 id="compressor_contract"><a class="header" href="#compressor_contract">COMPRESSOR_CONTRACT</a></h3>
<pre><code class="language-solidity">ICompressor constant COMPRESSOR_CONTRACT =
ICompressor(address(SYSTEM_CONTRACTS_OFFSET + 0x0e))
</code></pre>
<h3 id="complex_upgrader_contract"><a class="header" href="#complex_upgrader_contract">COMPLEX_UPGRADER_CONTRACT</a></h3>
<pre><code class="language-solidity">IComplexUpgrader constant COMPLEX_UPGRADER_CONTRACT =
IComplexUpgrader(address(SYSTEM_CONTRACTS_OFFSET + 0x0f))
</code></pre>
<h3 id="keccak256_system_contract"><a class="header" href="#keccak256_system_contract">KECCAK256_SYSTEM_CONTRACT</a></h3>
<pre><code class="language-solidity">address constant KECCAK256_SYSTEM_CONTRACT = address(0x8010)
</code></pre>
<h3 id="pubdata_chunk_publisher"><a class="header" href="#pubdata_chunk_publisher">PUBDATA_CHUNK_PUBLISHER</a></h3>
<pre><code class="language-solidity">IPubdataChunkPublisher constant PUBDATA_CHUNK_PUBLISHER =
IPubdataChunkPublisher(address(SYSTEM_CONTRACTS_OFFSET + 0x11))
</code></pre>
<h3 id="code_oracle_system_contract"><a class="header" href="#code_oracle_system_contract">CODE_ORACLE_SYSTEM_CONTRACT</a></h3>
<pre><code class="language-solidity">address constant CODE_ORACLE_SYSTEM_CONTRACT =
address(SYSTEM_CONTRACTS_OFFSET + 0x12)
</code></pre>
<h3 id="evm_gas_manager"><a class="header" href="#evm_gas_manager">EVM_GAS_MANAGER</a></h3>
<pre><code class="language-solidity">address constant EVM_GAS_MANAGER = address(SYSTEM_CONTRACTS_OFFSET + 0x13)
</code></pre>
<h3 id="evm_predeploys_manager"><a class="header" href="#evm_predeploys_manager">EVM_PREDEPLOYS_MANAGER</a></h3>
<pre><code class="language-solidity">address constant EVM_PREDEPLOYS_MANAGER =
address(SYSTEM_CONTRACTS_OFFSET + 0x14)
</code></pre>
<h3 id="evm_hashes_storage"><a class="header" href="#evm_hashes_storage">EVM_HASHES_STORAGE</a></h3>
<pre><code class="language-solidity">IEvmHashesStorage constant EVM_HASHES_STORAGE =
IEvmHashesStorage(address(SYSTEM_CONTRACTS_OFFSET + 0x15))
</code></pre>
<h3 id="l2_create2_factory"><a class="header" href="#l2_create2_factory">L2_CREATE2_FACTORY</a></h3>
<pre><code class="language-solidity">ICreate2Factory constant L2_CREATE2_FACTORY =
ICreate2Factory(address(USER_CONTRACTS_OFFSET))
</code></pre>
<h3 id="l2_asset_router"><a class="header" href="#l2_asset_router">L2_ASSET_ROUTER</a></h3>
<pre><code class="language-solidity">IL2AssetRouter constant L2_ASSET_ROUTER =
IL2AssetRouter(address(USER_CONTRACTS_OFFSET + 0x03))
</code></pre>
<h3 id="l2_bridge_hub"><a class="header" href="#l2_bridge_hub">L2_BRIDGE_HUB</a></h3>
<pre><code class="language-solidity">IBridgehub constant L2_BRIDGE_HUB =
IBridgehub(address(USER_CONTRACTS_OFFSET + 0x02))
</code></pre>
<h3 id="l2_native_token_vault"><a class="header" href="#l2_native_token_vault">L2_NATIVE_TOKEN_VAULT</a></h3>
<pre><code class="language-solidity">IL2NativeTokenVault constant L2_NATIVE_TOKEN_VAULT =
IL2NativeTokenVault(address(USER_CONTRACTS_OFFSET + 0x04))
</code></pre>
<h3 id="l2_message_root"><a class="header" href="#l2_message_root">L2_MESSAGE_ROOT</a></h3>
<pre><code class="language-solidity">IMessageRoot constant L2_MESSAGE_ROOT =
IMessageRoot(address(USER_CONTRACTS_OFFSET + 0x05))
</code></pre>
<h3 id="sload_contract_address"><a class="header" href="#sload_contract_address">SLOAD_CONTRACT_ADDRESS</a></h3>
<pre><code class="language-solidity">address constant SLOAD_CONTRACT_ADDRESS = address(USER_CONTRACTS_OFFSET + 0x06)
</code></pre>
<h3 id="wrapped_base_token_impl_address"><a class="header" href="#wrapped_base_token_impl_address">WRAPPED_BASE_TOKEN_IMPL_ADDRESS</a></h3>
<pre><code class="language-solidity">address constant WRAPPED_BASE_TOKEN_IMPL_ADDRESS =
address(USER_CONTRACTS_OFFSET + 0x07)
</code></pre>
<h3 id="l2_chain_asset_handler"><a class="header" href="#l2_chain_asset_handler">L2_CHAIN_ASSET_HANDLER</a></h3>
<pre><code class="language-solidity">address constant L2_CHAIN_ASSET_HANDLER = address(USER_CONTRACTS_OFFSET + 0x0a)
</code></pre>
<h3 id="msg_value_simulator_is_system_bit"><a class="header" href="#msg_value_simulator_is_system_bit">MSG_VALUE_SIMULATOR_IS_SYSTEM_BIT</a></h3>
<p>If the bitwise AND of the extraAbi[2] param when calling the MSG_VALUE_SIMULATOR
is non-zero, the call will be assumed to be a system one.</p>
<pre><code class="language-solidity">uint256 constant MSG_VALUE_SIMULATOR_IS_SYSTEM_BIT = 1
</code></pre>
<h3 id="max_msg_value"><a class="header" href="#max_msg_value">MAX_MSG_VALUE</a></h3>
<p>The maximal msg.value that context can have</p>
<pre><code class="language-solidity">uint256 constant MAX_MSG_VALUE = type(uint128).max
</code></pre>
<h3 id="create2_prefix-1"><a class="header" href="#create2_prefix-1">CREATE2_PREFIX</a></h3>
<p>Prefix used during derivation of account addresses using CREATE2</p>
<p>keccak256("zksyncCreate2")</p>
<pre><code class="language-solidity">bytes32 constant CREATE2_PREFIX =
0x2020dba91b30cc0006188af794c2fb30dd8520db7e2c088b7fc7c103c00ca494
</code></pre>
<h3 id="create_prefix-1"><a class="header" href="#create_prefix-1">CREATE_PREFIX</a></h3>
<p>Prefix used during derivation of account addresses using CREATE</p>
<p>keccak256("zksyncCreate")</p>
<pre><code class="language-solidity">bytes32 constant CREATE_PREFIX =
0x63bae3a9951d38e8a3fbb7b70909afc1200610fc5bc55ade242f815974674f23
</code></pre>
<h3 id="create2_evm_prefix"><a class="header" href="#create2_evm_prefix">CREATE2_EVM_PREFIX</a></h3>
<p>Prefix used during derivation of account addresses using CREATE2 within the EVM</p>
<pre><code class="language-solidity">bytes1 constant CREATE2_EVM_PREFIX = 0xff
</code></pre>
<h3 id="state_diff_entry_size"><a class="header" href="#state_diff_entry_size">STATE_DIFF_ENTRY_SIZE</a></h3>
<p>Each state diff consists of 156 bytes of actual data and 116 bytes of unused padding, needed for circuit efficiency.</p>
<pre><code class="language-solidity">uint256 constant STATE_DIFF_ENTRY_SIZE = 272
</code></pre>
<h3 id="l2_to_l1_logs_merkle_tree_leaves"><a class="header" href="#l2_to_l1_logs_merkle_tree_leaves">L2_TO_L1_LOGS_MERKLE_TREE_LEAVES</a></h3>
<p>The number of leaves in the L2-&gt;L1 log Merkle tree.
While formally a tree of any length is acceptable, the node supports only a constant length of 16384 leaves.</p>
<pre><code class="language-solidity">uint256 constant L2_TO_L1_LOGS_MERKLE_TREE_LEAVES = 16_384
</code></pre>
<h3 id="derived_key_length"><a class="header" href="#derived_key_length">DERIVED_KEY_LENGTH</a></h3>
<p>The length of the derived key in bytes inside compressed state diffs.</p>
<pre><code class="language-solidity">uint256 constant DERIVED_KEY_LENGTH = 32
</code></pre>
<h3 id="enum_index_length"><a class="header" href="#enum_index_length">ENUM_INDEX_LENGTH</a></h3>
<p>The length of the enum index in bytes inside compressed state diffs.</p>
<pre><code class="language-solidity">uint256 constant ENUM_INDEX_LENGTH = 8
</code></pre>
<h3 id="value_length"><a class="header" href="#value_length">VALUE_LENGTH</a></h3>
<p>The length of value in bytes inside compressed state diffs.</p>
<pre><code class="language-solidity">uint256 constant VALUE_LENGTH = 32
</code></pre>
<h3 id="compressed_initial_write_size"><a class="header" href="#compressed_initial_write_size">COMPRESSED_INITIAL_WRITE_SIZE</a></h3>
<p>The length of the compressed initial storage write in bytes.</p>
<pre><code class="language-solidity">uint256 constant COMPRESSED_INITIAL_WRITE_SIZE =
DERIVED_KEY_LENGTH + VALUE_LENGTH
</code></pre>
<h3 id="compressed_repeated_write_size"><a class="header" href="#compressed_repeated_write_size">COMPRESSED_REPEATED_WRITE_SIZE</a></h3>
<p>The length of the compressed repeated storage write in bytes.</p>
<pre><code class="language-solidity">uint256 constant COMPRESSED_REPEATED_WRITE_SIZE =
ENUM_INDEX_LENGTH + VALUE_LENGTH
</code></pre>
<h3 id="initial_write_starting_position"><a class="header" href="#initial_write_starting_position">INITIAL_WRITE_STARTING_POSITION</a></h3>
<p>The position from which the initial writes start in the compressed state diffs.</p>
<pre><code class="language-solidity">uint256 constant INITIAL_WRITE_STARTING_POSITION = 4
</code></pre>
<h3 id="state_diff_derived_key_offset"><a class="header" href="#state_diff_derived_key_offset">STATE_DIFF_DERIVED_KEY_OFFSET</a></h3>
<p>Each storage diffs consists of the following elements:
[20bytes address][32bytes key][32bytes derived key][8bytes enum index][32bytes initial value][32bytes final value]</p>
<p>The offset of the derived key in a storage diff.</p>
<pre><code class="language-solidity">uint256 constant STATE_DIFF_DERIVED_KEY_OFFSET = 52
</code></pre>
<h3 id="state_diff_enum_index_offset"><a class="header" href="#state_diff_enum_index_offset">STATE_DIFF_ENUM_INDEX_OFFSET</a></h3>
<p>The offset of the enum index in a storage diff.</p>
<pre><code class="language-solidity">uint256 constant STATE_DIFF_ENUM_INDEX_OFFSET = 84
</code></pre>
<h3 id="state_diff_final_value_offset"><a class="header" href="#state_diff_final_value_offset">STATE_DIFF_FINAL_VALUE_OFFSET</a></h3>
<p>The offset of the final value in a storage diff.</p>
<pre><code class="language-solidity">uint256 constant STATE_DIFF_FINAL_VALUE_OFFSET = 124
</code></pre>
<h3 id="blob_size_bytes"><a class="header" href="#blob_size_bytes">BLOB_SIZE_BYTES</a></h3>
<p>Total number of bytes in a blob. Blob = 4096 field elements * 31 bytes per field element</p>
<p>EIP-4844 defines it as 131_072 but we use 4096 * 31 within our circuits to always fit within a field element</p>
<p>Our circuits will prove that a EIP-4844 blob and our internal blob are the same.</p>
<pre><code class="language-solidity">uint256 constant BLOB_SIZE_BYTES = 126_976
</code></pre>
<h3 id="max_number_of_blobs-1"><a class="header" href="#max_number_of_blobs-1">MAX_NUMBER_OF_BLOBS</a></h3>
<p>Max number of blobs currently supported</p>
<pre><code class="language-solidity">uint256 constant MAX_NUMBER_OF_BLOBS = 6
</code></pre>
<h3 id="era_vm_bytecode_flag"><a class="header" href="#era_vm_bytecode_flag">ERA_VM_BYTECODE_FLAG</a></h3>
<p>Marker of EraVM bytecode</p>
<pre><code class="language-solidity">uint8 constant ERA_VM_BYTECODE_FLAG = 1
</code></pre>
<h3 id="evm_bytecode_flag"><a class="header" href="#evm_bytecode_flag">EVM_BYTECODE_FLAG</a></h3>
<p>Marker of EVM bytecode</p>
<pre><code class="language-solidity">uint8 constant EVM_BYTECODE_FLAG = 2
</code></pre>
<h3 id="service_call_pseudo_caller"><a class="header" href="#service_call_pseudo_caller">SERVICE_CALL_PSEUDO_CALLER</a></h3>
<pre><code class="language-solidity">address constant SERVICE_CALL_PSEUDO_CALLER =
0xFFfFfFffFFfffFFfFFfFFFFFffFFFffffFfFFFfF
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="systemlogkey"><a class="header" href="#systemlogkey">SystemLogKey</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/Constants.sol">Git Source</a></p>
<pre><code class="language-solidity">enum SystemLogKey {
L2_TO_L1_LOGS_TREE_ROOT_KEY,
PACKED_BATCH_AND_L2_BLOCK_TIMESTAMP_KEY,
CHAINED_PRIORITY_TXN_HASH_KEY,
NUMBER_OF_LAYER_1_TXS_KEY,
// Note, that it is important that `PREV_BATCH_HASH_KEY` has position
// `4` since it is the same as it was in the previous protocol version and
// it is the only one that is emitted before the system contracts are upgraded.
PREV_BATCH_HASH_KEY,
L2_DA_VALIDATOR_OUTPUT_HASH_KEY,
USED_L2_DA_VALIDATOR_ADDRESS_KEY,
MESSAGE_ROOT_ROLLING_HASH_KEY,
L2_TXS_STATUS_ROLLING_HASH_KEY,
EXPECTED_SYSTEM_CONTRACT_UPGRADE_TX_HASH_KEY
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="contents-18"><a class="header" href="#contents-18">Contents</a></h1>
<ul>
<li><a href="contracts/l1-contracts/common/libraries/DynamicIncrementalMerkle.sol/library.DynamicIncrementalMerkle.html">DynamicIncrementalMerkle</a></li>
<li><a href="contracts/l1-contracts/common/libraries/Merkle.sol/library.Merkle.html">Merkle</a></li>
<li><a href="contracts/l1-contracts/common/libraries/UncheckedMath.sol/library.UncheckedMath.html">UncheckedMath</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="dynamicincrementalmerkle"><a class="header" href="#dynamicincrementalmerkle">DynamicIncrementalMerkle</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/l1-contracts/common/libraries/DynamicIncrementalMerkle.sol">Git Source</a></p>
<p>Library for managing https://wikipedia.org/wiki/Merkle_Tree[Merkle Tree] data structures.
Each tree is a complete binary tree with the ability to sequentially insert leaves, changing them from a zero to a
non-zero value and updating its root. This structure allows inserting commitments (or other entries) that are not
stored, but can be proven to be part of the tree at a later time if the root is kept. See {MerkleProof}.
A tree is defined by the following parameters:
Depth: The number of levels in the tree, it also defines the maximum number of leaves as 2**depth.
Zero value: The value that represents an empty leaf. Used to avoid regular zero values to be part of the tree.
Hashing function: A cryptographic hash function used to produce internal nodes.
This is a fork of OpenZeppelin's <a href="https://github.com/OpenZeppelin/openzeppelin-contracts/blob/9af280dc4b45ee5bda96ba47ff829b407eaab67e/contracts/utils/structs/MerkleTree.sol"><code>MerkleTree</code></a>
library, with the changes to support dynamic tree growth (doubling the size when full).</p>
<h2 id="functions-83"><a class="header" href="#functions-83">Functions</a></h2>
<h3 id="setup"><a class="header" href="#setup">setup</a></h3>
<p>Initialize a <a href="contracts/l1-contracts/common/libraries/DynamicIncrementalMerkle.sol//contracts/l1-contracts/common/libraries/DynamicIncrementalMerkle.sol/library.DynamicIncrementalMerkle.html#bytes32pushtree">Bytes32PushTree</a> using {Hashes-Keccak256} to hash internal nodes.
The capacity of the tree (i.e. number of leaves) is set to <code>2**levels</code>.
IMPORTANT: The zero value should be carefully chosen since it will be stored in the tree representing
empty leaves. It should be a value that is not expected to be part of the tree.</p>
<pre><code class="language-solidity">function setup(Bytes32PushTree storage self, bytes32 zero)
  internal
  returns (bytes32 initialRoot);
</code></pre>
<h3 id="reset"><a class="header" href="#reset">reset</a></h3>
<p>Resets the tree to a blank state.
Calling this function on MerkleTree that was already setup and used will reset it to a blank state.</p>
<pre><code class="language-solidity">function reset(Bytes32PushTree storage self, bytes32 zero)
  internal
  returns (bytes32 initialRoot);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>self</code></td><td><code>Bytes32PushTree</code></td><td></td></tr>
<tr><td><code>zero</code></td><td><code>bytes32</code></td><td>The value that represents an empty leaf.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>initialRoot</code></td><td><code>bytes32</code></td><td>The initial root of the tree.</td></tr>
</tbody></table>
</div>
<h3 id="push"><a class="header" href="#push">push</a></h3>
<p>Insert a new leaf in the tree, and compute the new root. Returns the position of the inserted leaf in the
tree, and the resulting root.
Hashing the leaf before calling this function is recommended as a protection against
second pre-image attacks.</p>
<pre><code class="language-solidity">function push(Bytes32PushTree storage self, bytes32 leaf)
  internal
  returns (uint256 index, bytes32 newRoot);
</code></pre>
<h3 id="root"><a class="header" href="#root">root</a></h3>
<p>Tree's root.</p>
<pre><code class="language-solidity">function root(Bytes32PushTree storage self) internal view returns (bytes32);
</code></pre>
<h3 id="height"><a class="header" href="#height">height</a></h3>
<p>Tree's height (does not include the root node).</p>
<pre><code class="language-solidity">function height(Bytes32PushTree storage self)
  internal
  view
  returns (uint256);
</code></pre>
<h2 id="structs-10"><a class="header" href="#structs-10">Structs</a></h2>
<h3 id="bytes32pushtree"><a class="header" href="#bytes32pushtree">Bytes32PushTree</a></h3>
<p>A complete <code>bytes32</code> Merkle tree.
The <code>sides</code> and <code>zero</code> arrays are set to have a length equal to the depth of the tree during setup.
Struct members have an underscore prefix indicating that they are "private" and should not be read or written to
directly. Use the functions provided below instead. Modifying the struct manually may violate assumptions and
lead to unexpected behavior.
NOTE: The <code>root</code> and the updates history is not stored within the tree. Consider using a secondary structure to
store a list of historical roots from the values returned from <a href="contracts/l1-contracts/common/libraries/DynamicIncrementalMerkle.sol//contracts/l1-contracts/common/libraries/DynamicIncrementalMerkle.sol/library.DynamicIncrementalMerkle.html#setup">setup</a> and <a href="contracts/l1-contracts/common/libraries/DynamicIncrementalMerkle.sol//contracts/l1-contracts/common/libraries/DynamicIncrementalMerkle.sol/library.DynamicIncrementalMerkle.html#push">push</a> (e.g. a mapping, {BitMaps} or
{Checkpoints}).
WARNING: Updating any of the tree's parameters after the first insertion will result in a corrupted tree.</p>
<pre><code class="language-solidity">struct Bytes32PushTree {
  uint256 _nextLeafIndex;
  bytes32[] _sides;
  bytes32[] _zeros;
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="merkle"><a class="header" href="#merkle">Merkle</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/l1-contracts/common/libraries/Merkle.sol">Git Source</a></p>
<p><strong>Author:</strong>
Matter Labs</p>
<p><strong>Note:</strong>
security-contact: security@matterlabs.dev</p>
<h2 id="functions-84"><a class="header" href="#functions-84">Functions</a></h2>
<h3 id="calculateroot"><a class="header" href="#calculateroot">calculateRoot</a></h3>
<p>Calculate Merkle root by the provided Merkle proof.
NOTE: When using this function, check that the _path length is equal to the tree height to prevent shorter/longer paths attack
however, for chains settling on GW the proof includes the GW proof, so the path increases. See Mailbox for more details.</p>
<pre><code class="language-solidity">function calculateRoot(
  bytes32[] calldata _path,
  uint256 _index,
  bytes32 _itemHash
) internal pure returns (bytes32);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_path</code></td><td><code>bytes32[]</code></td><td>Merkle path from the leaf to the root</td></tr>
<tr><td><code>_index</code></td><td><code>uint256</code></td><td>Leaf index in the tree</td></tr>
<tr><td><code>_itemHash</code></td><td><code>bytes32</code></td><td>Hash of leaf content</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>bytes32</code></td><td>The Merkle root</td></tr>
</tbody></table>
</div>
<h3 id="calculaterootmemory"><a class="header" href="#calculaterootmemory">calculateRootMemory</a></h3>
<p>Calculate Merkle root by the provided Merkle proof.</p>
<p>NOTE: When using this function, check that the _path length is appropriate to prevent shorter/longer paths attack</p>
<p>NOTE the tree can be joined. In this case the second tree's leaves indexes increase by the number of leaves in the first tree.</p>
<pre><code class="language-solidity">function calculateRootMemory(
  bytes32[] memory _path,
  uint256 _index,
  bytes32 _itemHash
) internal pure returns (bytes32);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_path</code></td><td><code>bytes32[]</code></td><td>Merkle path from the leaf to the root</td></tr>
<tr><td><code>_index</code></td><td><code>uint256</code></td><td>Leaf index in the tree.</td></tr>
<tr><td><code>_itemHash</code></td><td><code>bytes32</code></td><td>Hash of leaf content</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>bytes32</code></td><td>The Merkle root</td></tr>
</tbody></table>
</div>
<h3 id="calculaterootpaths"><a class="header" href="#calculaterootpaths">calculateRootPaths</a></h3>
<p>Calculate Merkle root by the provided Merkle proof for a range of elements
NOTE: When using this function, check that the _startPath and _endPath lengths are equal to the tree height to prevent shorter/longer paths attack</p>
<pre><code class="language-solidity">function calculateRootPaths(
  bytes32[] memory _startPath,
  bytes32[] memory _endPath,
  uint256 _startIndex,
  bytes32[] memory _itemHashes
) internal pure returns (bytes32);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_startPath</code></td><td><code>bytes32[]</code></td><td>Merkle path from the first element of the range to the root</td></tr>
<tr><td><code>_endPath</code></td><td><code>bytes32[]</code></td><td>Merkle path from the last element of the range to the root</td></tr>
<tr><td><code>_startIndex</code></td><td><code>uint256</code></td><td>Index of the first element of the range in the tree</td></tr>
<tr><td><code>_itemHashes</code></td><td><code>bytes32[]</code></td><td>Hashes of the elements in the range</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>bytes32</code></td><td>The Merkle root</td></tr>
</tbody></table>
</div>
<h3 id="efficienthash"><a class="header" href="#efficienthash">efficientHash</a></h3>
<p>Keccak hash of the concatenation of two 32-byte words</p>
<pre><code class="language-solidity">function efficientHash(bytes32 _lhs, bytes32 _rhs)
  internal
  pure
  returns (bytes32 result);
</code></pre>
<h3 id="_validatepathlengthforsingleproof"><a class="header" href="#_validatepathlengthforsingleproof">_validatePathLengthForSingleProof</a></h3>
<pre><code class="language-solidity">function _validatePathLengthForSingleProof(
  uint256 _index,
  uint256 _pathLength
) private pure;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="uncheckedmath"><a class="header" href="#uncheckedmath">UncheckedMath</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/l1-contracts/common/libraries/UncheckedMath.sol">Git Source</a></p>
<p><strong>Author:</strong>
Matter Labs</p>
<p>The library for unchecked math.</p>
<p><strong>Note:</strong>
security-contact: security@matterlabs.dev</p>
<h2 id="functions-85"><a class="header" href="#functions-85">Functions</a></h2>
<h3 id="uncheckedinc"><a class="header" href="#uncheckedinc">uncheckedInc</a></h3>
<pre><code class="language-solidity">function uncheckedInc(uint256 _number) internal pure returns (uint256);
</code></pre>
<h3 id="uncheckedadd"><a class="header" href="#uncheckedadd">uncheckedAdd</a></h3>
<pre><code class="language-solidity">function uncheckedAdd(uint256 _lhs, uint256 _rhs)
  internal
  pure
  returns (uint256);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="restrictionvalidator"><a class="header" href="#restrictionvalidator">RestrictionValidator</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/l1-contracts/governance/restriction/RestrictionValidator.sol">Git Source</a></p>
<p><strong>Title:</strong>
Restriction validator</p>
<p><strong>Author:</strong>
Matter Labs</p>
<p>The library which validates whether an address can be a valid restriction</p>
<p><strong>Note:</strong>
security-contact: security@matterlabs.dev</p>
<h2 id="functions-86"><a class="header" href="#functions-86">Functions</a></h2>
<h3 id="validaterestriction"><a class="header" href="#validaterestriction">validateRestriction</a></h3>
<p>Ensures that the provided address implements the restriction interface</p>
<p>Note that it <em>can not guarantee</em> that the corresponding address indeed implements
the interface completely or that it is implemented correctly. It is mainly used to
ensure that invalid restrictions can not be accidentally added.</p>
<pre><code class="language-solidity">function validateRestriction(address _restriction) internal view;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="diamond"><a class="header" href="#diamond">Diamond</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/l1-contracts/state-transition/libraries/Diamond.sol">Git Source</a></p>
<p><strong>Author:</strong>
Matter Labs</p>
<p>The helper library for managing the EIP-2535 diamond proxy.</p>
<p><strong>Note:</strong>
security-contact: security@matterlabs.dev</p>
<h2 id="state-variables-3"><a class="header" href="#state-variables-3">State Variables</a></h2>
<h3 id="diamond_init_success_return_value"><a class="header" href="#diamond_init_success_return_value">DIAMOND_INIT_SUCCESS_RETURN_VALUE</a></h3>
<p>Magic value that should be returned by diamond cut initialize contracts.</p>
<p>Used to distinguish calls to contracts that were supposed to be used as diamond initializer from other contracts.</p>
<pre><code class="language-solidity">bytes32 internal constant DIAMOND_INIT_SUCCESS_RETURN_VALUE =
  0x33774e659306e47509050e97cb651e731180a42d458212294d30751925c551a2
</code></pre>
<h3 id="diamond_storage_position"><a class="header" href="#diamond_storage_position">DIAMOND_STORAGE_POSITION</a></h3>
<p>Storage position of <code>DiamondStorage</code> structure.</p>
<pre><code class="language-solidity">bytes32 private constant DIAMOND_STORAGE_POSITION =
  0xc8fcad8db84d3cc18b4c41d551ea0ee66dd599cde068d998e57d5e09332c131b
</code></pre>
<h2 id="functions-87"><a class="header" href="#functions-87">Functions</a></h2>
<h3 id="getdiamondstorage"><a class="header" href="#getdiamondstorage">getDiamondStorage</a></h3>
<pre><code class="language-solidity">function getDiamondStorage()
  internal
  pure
  returns (DiamondStorage storage diamondStorage);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>diamondStorage</code></td><td><code>DiamondStorage</code></td><td>The pointer to the storage where all specific diamond proxy parameters stored</td></tr>
</tbody></table>
</div>
<h3 id="diamondcut"><a class="header" href="#diamondcut">diamondCut</a></h3>
<p>Add/replace/remove any number of selectors and optionally execute a function with delegatecall</p>
<pre><code class="language-solidity">function diamondCut(DiamondCutData memory _diamondCut) internal;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_diamondCut</code></td><td><code>DiamondCutData</code></td><td>Diamond's facet changes and the parameters to optional initialization delegatecall</td></tr>
</tbody></table>
</div>
<h3 id="_addfunctions"><a class="header" href="#_addfunctions">_addFunctions</a></h3>
<p>Add new functions to the diamond proxy
NOTE: expect but NOT enforce that <code>_selectors</code> is NON-EMPTY array</p>
<pre><code class="language-solidity">function _addFunctions(
  address _facet,
  bytes4[] memory _selectors,
  bool _isFacetFreezable
) private;
</code></pre>
<h3 id="_replacefunctions"><a class="header" href="#_replacefunctions">_replaceFunctions</a></h3>
<p>Change associated facets to already known function selectors
NOTE: expect but NOT enforce that <code>_selectors</code> is NON-EMPTY array</p>
<pre><code class="language-solidity">function _replaceFunctions(
  address _facet,
  bytes4[] memory _selectors,
  bool _isFacetFreezable
) private;
</code></pre>
<h3 id="_removefunctions"><a class="header" href="#_removefunctions">_removeFunctions</a></h3>
<p>Remove association with function and facet
NOTE: expect but NOT enforce that <code>_selectors</code> is NON-EMPTY array</p>
<pre><code class="language-solidity">function _removeFunctions(address _facet, bytes4[] memory _selectors)
  private;
</code></pre>
<h3 id="_savefacetifnew"><a class="header" href="#_savefacetifnew">_saveFacetIfNew</a></h3>
<p>Add address to the list of known facets if it is not on the list yet
NOTE: should be called ONLY before adding a new selector associated with the address</p>
<pre><code class="language-solidity">function _saveFacetIfNew(address _facet) private;
</code></pre>
<h3 id="_addonefunction"><a class="header" href="#_addonefunction">_addOneFunction</a></h3>
<p>Add one function to the already known facet
NOTE: It is expected but NOT enforced that:</p>
<ul>
<li><code>_facet</code> is NON-ZERO address</li>
<li><code>_facet</code> is already stored address in <code>DiamondStorage.facets</code></li>
<li><code>_selector</code> is NOT associated by another facet</li>
</ul>
<pre><code class="language-solidity">function _addOneFunction(
  address _facet,
  bytes4 _selector,
  bool _isSelectorFreezable
) private;
</code></pre>
<h3 id="_removeonefunction"><a class="header" href="#_removeonefunction">_removeOneFunction</a></h3>
<p>Remove one associated function with facet
NOTE: It is expected but NOT enforced that <code>_facet</code> is NON-ZERO address</p>
<pre><code class="language-solidity">function _removeOneFunction(address _facet, bytes4 _selector) private;
</code></pre>
<h3 id="_removefacet"><a class="header" href="#_removefacet">_removeFacet</a></h3>
<p>remove facet from the list of known facets
NOTE: It is expected but NOT enforced that there are no selectors associated with <code>_facet</code></p>
<pre><code class="language-solidity">function _removeFacet(address _facet) private;
</code></pre>
<h3 id="_initializediamondcut"><a class="header" href="#_initializediamondcut">_initializeDiamondCut</a></h3>
<p>Delegates call to the initialization address with provided calldata</p>
<p>Used as a final step of diamond cut to execute the logic of the initialization for changed facets</p>
<pre><code class="language-solidity">function _initializeDiamondCut(address _init, bytes memory _calldata)
  private;
</code></pre>
<h2 id="events-37"><a class="header" href="#events-37">Events</a></h2>
<h3 id="diamondcut-1"><a class="header" href="#diamondcut-1">DiamondCut</a></h3>
<pre><code class="language-solidity">event DiamondCut(
  FacetCut[] facetCuts, address initAddress, bytes initCalldata
);
</code></pre>
<h2 id="structs-11"><a class="header" href="#structs-11">Structs</a></h2>
<h3 id="selectortofacet"><a class="header" href="#selectortofacet">SelectorToFacet</a></h3>
<p>Utility struct that contains associated facet &amp; meta information of selector</p>
<pre><code class="language-solidity">struct SelectorToFacet {
  address facetAddress;
  uint16 selectorPosition;
  bool isFreezable;
}
</code></pre>
<p><strong>Properties</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>facetAddress</code></td><td><code>address</code></td><td>address of the facet which is connected with selector</td></tr>
<tr><td><code>selectorPosition</code></td><td><code>uint16</code></td><td>index in <code>FacetToSelectors.selectors</code> array, where is selector stored</td></tr>
<tr><td><code>isFreezable</code></td><td><code>bool</code></td><td>denotes whether the selector can be frozen.</td></tr>
</tbody></table>
</div>
<h3 id="facettoselectors"><a class="header" href="#facettoselectors">FacetToSelectors</a></h3>
<p>Utility struct that contains associated selectors &amp; meta information of facet</p>
<pre><code class="language-solidity">struct FacetToSelectors {
  bytes4[] selectors;
  uint16 facetPosition;
}
</code></pre>
<p><strong>Properties</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>selectors</code></td><td><code>bytes4[]</code></td><td>list of all selectors that belong to the facet</td></tr>
<tr><td><code>facetPosition</code></td><td><code>uint16</code></td><td>index in <code>DiamondStorage.facets</code> array, where is facet stored</td></tr>
</tbody></table>
</div>
<h3 id="diamondstorage"><a class="header" href="#diamondstorage">DiamondStorage</a></h3>
<p>The structure that holds all diamond proxy associated parameters</p>
<p>According to the EIP-2535 should be stored on a special storage key - <code>DIAMOND_STORAGE_POSITION</code></p>
<pre><code class="language-solidity">struct DiamondStorage {
  mapping(bytes4 selector =&gt; SelectorToFacet selectorInfo) selectorToFacet;
  mapping(address facetAddress =&gt; FacetToSelectors facetInfo)
    facetToSelectors;
  address[] facets;
  bool isFrozen;
}
</code></pre>
<p><strong>Properties</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>selectorToFacet</code></td><td><code>mapping(bytes4 selector =&gt; SelectorToFacet selectorInfo)</code></td><td>A mapping from the selector to the facet address and its meta information</td></tr>
<tr><td><code>facetToSelectors</code></td><td><code>mapping(address facetAddress =&gt; FacetToSelectors facetInfo)</code></td><td>A mapping from facet address to its selectors with meta information</td></tr>
<tr><td><code>facets</code></td><td><code>address[]</code></td><td>The array of all unique facet addresses that belong to the diamond proxy</td></tr>
<tr><td><code>isFrozen</code></td><td><code>bool</code></td><td>Denotes whether the diamond proxy is frozen and all freezable facets are not accessible</td></tr>
</tbody></table>
</div>
<h3 id="facetcut"><a class="header" href="#facetcut">FacetCut</a></h3>
<p>Parameters for diamond changes that touch one of the facets</p>
<pre><code class="language-solidity">struct FacetCut {
  address facet;
  Action action;
  bool isFreezable;
  bytes4[] selectors;
}
</code></pre>
<p><strong>Properties</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>facet</code></td><td><code>address</code></td><td>The address of facet that's affected by the cut</td></tr>
<tr><td><code>action</code></td><td><code>Action</code></td><td>The action that is made on the facet</td></tr>
<tr><td><code>isFreezable</code></td><td><code>bool</code></td><td>Denotes whether the facet &amp; all their selectors can be frozen</td></tr>
<tr><td><code>selectors</code></td><td><code>bytes4[]</code></td><td>An array of unique selectors that belongs to the facet address</td></tr>
</tbody></table>
</div>
<h3 id="diamondcutdata"><a class="header" href="#diamondcutdata">DiamondCutData</a></h3>
<p>Structure of the diamond proxy changes</p>
<pre><code class="language-solidity">struct DiamondCutData {
  FacetCut[] facetCuts;
  address initAddress;
  bytes initCalldata;
}
</code></pre>
<p><strong>Properties</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>facetCuts</code></td><td><code>FacetCut[]</code></td><td>The set of changes (adding/removing/replacement) of implementation contracts</td></tr>
<tr><td><code>initAddress</code></td><td><code>address</code></td><td>The address that's delegate called after setting up new facet changes</td></tr>
<tr><td><code>initCalldata</code></td><td><code>bytes</code></td><td>Calldata for the delegate call to <code>initAddress</code></td></tr>
</tbody></table>
</div>
<h2 id="enums-2"><a class="header" href="#enums-2">Enums</a></h2>
<h3 id="action"><a class="header" href="#action">Action</a></h3>
<p>Type of change over diamond: add/replace/remove facets</p>
<pre><code class="language-solidity">enum Action {
  Add,
  Replace,
  Remove
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="priorityqueue"><a class="header" href="#priorityqueue">PriorityQueue</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/l1-contracts/state-transition/libraries/PriorityQueue.sol">Git Source</a></p>
<p><strong>Author:</strong>
Matter Labs</p>
<p>The library provides the API to interact with the priority queue container</p>
<p>Order of processing operations from queue - FIFO (Fist in - first out)</p>
<p><strong>Note:</strong>
security-contact: security@matterlabs.dev</p>
<h2 id="functions-88"><a class="header" href="#functions-88">Functions</a></h2>
<h3 id="getfirstunprocessedprioritytx-1"><a class="header" href="#getfirstunprocessedprioritytx-1">getFirstUnprocessedPriorityTx</a></h3>
<p>Returns zero if and only if no operations were processed from the queue</p>
<pre><code class="language-solidity">function getFirstUnprocessedPriorityTx(Queue storage _queue)
  internal
  view
  returns (uint256);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint256</code></td><td>Index of the oldest priority operation that wasn't processed yet</td></tr>
</tbody></table>
</div>
<h3 id="gettotalprioritytxs-1"><a class="header" href="#gettotalprioritytxs-1">getTotalPriorityTxs</a></h3>
<pre><code class="language-solidity">function getTotalPriorityTxs(Queue storage _queue)
  internal
  view
  returns (uint256);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint256</code></td><td>The total number of priority operations that were added to the priority queue, including all processed ones</td></tr>
</tbody></table>
</div>
<h3 id="getsize"><a class="header" href="#getsize">getSize</a></h3>
<pre><code class="language-solidity">function getSize(Queue storage _queue) internal view returns (uint256);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint256</code></td><td>The total number of unprocessed priority operations in a priority queue</td></tr>
</tbody></table>
</div>
<h3 id="isempty"><a class="header" href="#isempty">isEmpty</a></h3>
<pre><code class="language-solidity">function isEmpty(Queue storage _queue) internal view returns (bool);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>bool</code></td><td>Whether the priority queue contains no operations</td></tr>
</tbody></table>
</div>
<h3 id="pushback"><a class="header" href="#pushback">pushBack</a></h3>
<p>Add the priority operation to the end of the priority queue</p>
<pre><code class="language-solidity">function pushBack(Queue storage _queue, PriorityOperation memory _operation)
  internal;
</code></pre>
<h3 id="front"><a class="header" href="#front">front</a></h3>
<pre><code class="language-solidity">function front(Queue storage _queue)
  internal
  view
  returns (PriorityOperation memory);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>PriorityOperation</code></td><td>The first unprocessed priority operation from the queue</td></tr>
</tbody></table>
</div>
<h3 id="popfront"><a class="header" href="#popfront">popFront</a></h3>
<p>Remove the first unprocessed priority operation from the queue</p>
<pre><code class="language-solidity">function popFront(Queue storage _queue)
  internal
  returns (PriorityOperation memory priorityOperation);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>priorityOperation</code></td><td><code>PriorityOperation</code></td><td>that was popped from the priority queue</td></tr>
</tbody></table>
</div>
<h2 id="structs-12"><a class="header" href="#structs-12">Structs</a></h2>
<h3 id="queue"><a class="header" href="#queue">Queue</a></h3>
<p>Container that stores priority operations</p>
<pre><code class="language-solidity">struct Queue {
  mapping(uint256 priorityOpId =&gt; PriorityOperation priorityOp) data;
  uint256 tail;
  uint256 head;
}
</code></pre>
<p><strong>Properties</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>data</code></td><td><code>mapping(uint256 priorityOpId =&gt; PriorityOperation priorityOp)</code></td><td>The inner mapping that saves priority operation by its index</td></tr>
<tr><td><code>tail</code></td><td><code>uint256</code></td><td>The pointer to the free slot</td></tr>
<tr><td><code>head</code></td><td><code>uint256</code></td><td>The pointer to the first unprocessed priority operation, equal to the tail if the queue is empty</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="prioritytree"><a class="header" href="#prioritytree">PriorityTree</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/l1-contracts/state-transition/libraries/PriorityTree.sol">Git Source</a></p>
<h2 id="functions-89"><a class="header" href="#functions-89">Functions</a></h2>
<h3 id="getfirstunprocessedprioritytx-2"><a class="header" href="#getfirstunprocessedprioritytx-2">getFirstUnprocessedPriorityTx</a></h3>
<p>Returns zero if and only if no operations were processed from the tree</p>
<pre><code class="language-solidity">function getFirstUnprocessedPriorityTx(Tree storage _tree)
  internal
  view
  returns (uint256);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint256</code></td><td>Index of the oldest priority operation that wasn't processed yet</td></tr>
</tbody></table>
</div>
<h3 id="gettotalprioritytxs-2"><a class="header" href="#gettotalprioritytxs-2">getTotalPriorityTxs</a></h3>
<pre><code class="language-solidity">function getTotalPriorityTxs(Tree storage _tree)
  internal
  view
  returns (uint256);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint256</code></td><td>The total number of priority operations that were added to the priority queue, including all processed ones</td></tr>
</tbody></table>
</div>
<h3 id="getsize-1"><a class="header" href="#getsize-1">getSize</a></h3>
<pre><code class="language-solidity">function getSize(Tree storage _tree) internal view returns (uint256);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint256</code></td><td>The total number of unprocessed priority operations in a priority queue</td></tr>
</tbody></table>
</div>
<h3 id="push-1"><a class="header" href="#push-1">push</a></h3>
<p>Add the priority operation to the end of the priority queue</p>
<pre><code class="language-solidity">function push(Tree storage _tree, bytes32 _hash) internal;
</code></pre>
<h3 id="setup-1"><a class="header" href="#setup-1">setup</a></h3>
<p>Set up the tree</p>
<pre><code class="language-solidity">function setup(Tree storage _tree, uint256 _startIndex) internal;
</code></pre>
<h3 id="getroot"><a class="header" href="#getroot">getRoot</a></h3>
<pre><code class="language-solidity">function getRoot(Tree storage _tree) internal view returns (bytes32);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>bytes32</code></td><td>Returns the tree root.</td></tr>
</tbody></table>
</div>
<h3 id="ishistoricalroot"><a class="header" href="#ishistoricalroot">isHistoricalRoot</a></h3>
<pre><code class="language-solidity">function isHistoricalRoot(Tree storage _tree, bytes32 _root)
  internal
  view
  returns (bool);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_tree</code></td><td><code>Tree</code></td><td></td></tr>
<tr><td><code>_root</code></td><td><code>bytes32</code></td><td>The root to check.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>bool</code></td><td>Returns true if the root is a historical root.</td></tr>
</tbody></table>
</div>
<h3 id="processbatch"><a class="header" href="#processbatch">processBatch</a></h3>
<p>Process the priority operations of a batch.</p>
<p>Note, that the function below only checks that a certain segment of items is present in the tree.
It does not check that e.g. there are no zero items inside the provided <code>itemHashes</code>, so in theory proofs
that include non-existing priority operations could be created. This function relies on the fact
that the <code>itemHashes</code> of <code>_priorityOpsData</code> are hashes of valid priority transactions.
This fact is ensured by the fact the rolling hash of those is sent to the Executor by the bootloader
and so assuming that zero knowledge proofs are correct, so is the structure of the <code>itemHashes</code>.</p>
<pre><code class="language-solidity">function processBatch(
  Tree storage _tree,
  PriorityOpsBatchInfo memory _priorityOpsData
) internal;
</code></pre>
<h3 id="skipuntil"><a class="header" href="#skipuntil">skipUntil</a></h3>
<p>Allows to skip a certain number of operations.</p>
<p>It is used when the corresponding transactions have been processed by priority queue.</p>
<pre><code class="language-solidity">function skipUntil(Tree storage _tree, uint256 _lastUnprocessed) internal;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_tree</code></td><td><code>Tree</code></td><td></td></tr>
<tr><td><code>_lastUnprocessed</code></td><td><code>uint256</code></td><td>The new expected id of the unprocessed transaction.</td></tr>
</tbody></table>
</div>
<h3 id="initfromcommitment"><a class="header" href="#initfromcommitment">initFromCommitment</a></h3>
<p>Initialize a chain from a commitment.</p>
<pre><code class="language-solidity">function initFromCommitment(
  Tree storage _tree,
  PriorityTreeCommitment memory _commitment
) internal;
</code></pre>
<h3 id="l1reinit"><a class="header" href="#l1reinit">l1Reinit</a></h3>
<p>Reinitialize the tree from a commitment on L1.</p>
<pre><code class="language-solidity">function l1Reinit(
  Tree storage _tree,
  PriorityTreeCommitment memory _commitment
) internal;
</code></pre>
<h3 id="checkgwreinit"><a class="header" href="#checkgwreinit">checkGWReinit</a></h3>
<p>Reinitialize the tree from a commitment on GW.</p>
<pre><code class="language-solidity">function checkGWReinit(
  Tree storage _tree,
  PriorityTreeCommitment memory _commitment
) internal view;
</code></pre>
<h3 id="getcommitment"><a class="header" href="#getcommitment">getCommitment</a></h3>
<p>Returns the commitment to the priority tree.</p>
<pre><code class="language-solidity">function getCommitment(Tree storage _tree)
  internal
  view
  returns (PriorityTreeCommitment memory commitment);
</code></pre>
<h2 id="structs-13"><a class="header" href="#structs-13">Structs</a></h2>
<h3 id="tree"><a class="header" href="#tree">Tree</a></h3>
<pre><code class="language-solidity">struct Tree {
  uint256 startIndex; // priority tree started accepting priority ops from this index
  uint256 unprocessedIndex; // relative to `startIndex`
  mapping(bytes32 =&gt; bool) historicalRoots;
  DynamicIncrementalMerkle.Bytes32PushTree tree;
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="batchdecoder"><a class="header" href="#batchdecoder">BatchDecoder</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/l1-contracts/state-transition/libraries/BatchDecoder.sol">Git Source</a></p>
<p><strong>Author:</strong>
Matter Labs</p>
<p>Utility library for decoding and validating batch data.</p>
<p>This library decodes commit, proof, and execution batch data and verifies batch number bounds.
It reverts with custom errors when the data is invalid or unsupported encoding is used.</p>
<p><strong>Note:</strong>
security-contact: security@matterlabs.dev</p>
<h2 id="state-variables-4"><a class="header" href="#state-variables-4">State Variables</a></h2>
<h3 id="supported_encoding_version"><a class="header" href="#supported_encoding_version">SUPPORTED_ENCODING_VERSION</a></h3>
<p>The currently supported encoding version.</p>
<pre><code class="language-solidity">uint8 internal constant SUPPORTED_ENCODING_VERSION = 1
</code></pre>
<h2 id="functions-90"><a class="header" href="#functions-90">Functions</a></h2>
<h3 id="_decodecommitdata"><a class="header" href="#_decodecommitdata">_decodeCommitData</a></h3>
<p>Decodes commit data from a calldata bytes into the last committed batch data and an array of new batch data.</p>
<pre><code class="language-solidity">function _decodeCommitData(bytes calldata _commitData)
  private
  pure
  returns (
    IExecutor.StoredBatchInfo memory lastCommittedBatchData,
    IExecutor.CommitBatchInfo[] memory newBatchesData
  );
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_commitData</code></td><td><code>bytes</code></td><td>The calldata byte array containing the data for committing batches.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>lastCommittedBatchData</code></td><td><code>IExecutor.StoredBatchInfo</code></td><td>The data for the batch before newly committed batches.</td></tr>
<tr><td><code>newBatchesData</code></td><td><code>IExecutor.CommitBatchInfo[]</code></td><td>An array containing the newly committed batches.</td></tr>
</tbody></table>
</div>
<h3 id="decodeandcheckprecommitdata"><a class="header" href="#decodeandcheckprecommitdata">decodeAndCheckPrecommitData</a></h3>
<p>Decodes and validates precommit data for a batch, ensuring the encoding version is supported.</p>
<p>The first byte of <code>_precommitData</code> is interpreted as the encoding version and must equal <code>SUPPORTED_ENCODING_VERSION</code>.
If it does, the remainder of the data is decoded into an <code>IExecutor.PrecommitInfo</code> struct. Otherwise, this call reverts.</p>
<pre><code class="language-solidity">function decodeAndCheckPrecommitData(bytes calldata _precommitData)
  internal
  pure
  returns (IExecutor.PrecommitInfo memory precommitInfo);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_precommitData</code></td><td><code>bytes</code></td><td>ABI-encoded bytes where the first byte is the encoding version, followed by the encoded <code>PrecommitInfo</code>.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>precommitInfo</code></td><td><code>IExecutor.PrecommitInfo</code></td><td>The decoded <code>PrecommitInfo</code> containing transaction status commitments.</td></tr>
</tbody></table>
</div>
<h3 id="decodeandcheckcommitdata"><a class="header" href="#decodeandcheckcommitdata">decodeAndCheckCommitData</a></h3>
<p>Decodes the commit data and checks that the provided batch bounds are correct.</p>
<p>Note that it only checks that the last and the first batches in the array correspond to the provided bounds.
The fact that the batches inside the array are provided in the correct order should be checked by the caller.</p>
<pre><code class="language-solidity">function decodeAndCheckCommitData(
  bytes calldata _commitData,
  uint256 _processBatchFrom,
  uint256 _processBatchTo
)
  internal
  pure
  returns (
    IExecutor.StoredBatchInfo memory lastCommittedBatchData,
    IExecutor.CommitBatchInfo[] memory newBatchesData
  );
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_commitData</code></td><td><code>bytes</code></td><td>The calldata byte array containing the data for committing batches.</td></tr>
<tr><td><code>_processBatchFrom</code></td><td><code>uint256</code></td><td>The expected batch number of the first commit batch in the array.</td></tr>
<tr><td><code>_processBatchTo</code></td><td><code>uint256</code></td><td>The expected batch number of the last commit batch in the array.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>lastCommittedBatchData</code></td><td><code>IExecutor.StoredBatchInfo</code></td><td>The data for the batch before newly committed batches.</td></tr>
<tr><td><code>newBatchesData</code></td><td><code>IExecutor.CommitBatchInfo[]</code></td><td>An array containing the newly committed batches.</td></tr>
</tbody></table>
</div>
<h3 id="_decodeproofdata"><a class="header" href="#_decodeproofdata">_decodeProofData</a></h3>
<p>Decodes proof data from a calldata byte array into the previous batch, an array of proved batches, and a proof array.</p>
<pre><code class="language-solidity">function _decodeProofData(bytes calldata _proofData)
  private
  pure
  returns (
    IExecutor.StoredBatchInfo memory prevBatch,
    IExecutor.StoredBatchInfo[] memory provedBatches,
    uint256[] memory proof
  );
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_proofData</code></td><td><code>bytes</code></td><td>The calldata byte array containing the data for proving batches.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>prevBatch</code></td><td><code>IExecutor.StoredBatchInfo</code></td><td>The batch information before the batches to be verified.</td></tr>
<tr><td><code>provedBatches</code></td><td><code>IExecutor.StoredBatchInfo[]</code></td><td>An array containing the the batches to be verified.</td></tr>
<tr><td><code>proof</code></td><td><code>uint256[]</code></td><td>An array containing the proof for the verifier.</td></tr>
</tbody></table>
</div>
<h3 id="decodeandcheckproofdata"><a class="header" href="#decodeandcheckproofdata">decodeAndCheckProofData</a></h3>
<p>Decodes the commit data and checks that the provided batch bounds are correct.</p>
<p>Note that it only checks that the last and the first batches in the array correspond to the provided bounds.
The fact that the batches inside the array are provided in the correct order should be checked by the caller.</p>
<pre><code class="language-solidity">function decodeAndCheckProofData(
  bytes calldata _proofData,
  uint256 _processBatchFrom,
  uint256 _processBatchTo
)
  internal
  pure
  returns (
    IExecutor.StoredBatchInfo memory prevBatch,
    IExecutor.StoredBatchInfo[] memory provedBatches,
    uint256[] memory proof
  );
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_proofData</code></td><td><code>bytes</code></td><td>The commit data to decode.</td></tr>
<tr><td><code>_processBatchFrom</code></td><td><code>uint256</code></td><td>The expected batch number of the first batch in the array.</td></tr>
<tr><td><code>_processBatchTo</code></td><td><code>uint256</code></td><td>The expected batch number of the last batch in the array.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>prevBatch</code></td><td><code>IExecutor.StoredBatchInfo</code></td><td>The batch information before the batches to be verified.</td></tr>
<tr><td><code>provedBatches</code></td><td><code>IExecutor.StoredBatchInfo[]</code></td><td>An array containing the the batches to be verified.</td></tr>
<tr><td><code>proof</code></td><td><code>uint256[]</code></td><td>An array containing the proof for the verifier.</td></tr>
</tbody></table>
</div>
<h3 id="_decodeexecutedata"><a class="header" href="#_decodeexecutedata">_decodeExecuteData</a></h3>
<p>Decodes execution data from a calldata byte array into an array of stored batch information.</p>
<pre><code class="language-solidity">function _decodeExecuteData(bytes calldata _executeData)
  private
  pure
  returns (
    IExecutor.StoredBatchInfo[] memory executeData,
    PriorityOpsBatchInfo[] memory priorityOpsData,
    InteropRoot[][] memory dependencyRoots
  );
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_executeData</code></td><td><code>bytes</code></td><td>The calldata byte array containing the execution data to decode.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>executeData</code></td><td><code>IExecutor.StoredBatchInfo[]</code></td><td>An array containing the stored batch information for execution.</td></tr>
<tr><td><code>priorityOpsData</code></td><td><code>PriorityOpsBatchInfo[]</code></td><td>Merkle proofs of the priority operations for each batch.</td></tr>
<tr><td><code>dependencyRoots</code></td><td><code>InteropRoot[][]</code></td><td></td></tr>
</tbody></table>
</div>
<h3 id="decodeandcheckexecutedata"><a class="header" href="#decodeandcheckexecutedata">decodeAndCheckExecuteData</a></h3>
<p>Decodes the execute data and checks that the provided batch bounds are correct.</p>
<p>Note that it only checks that the last and the first batches in the array correspond to the provided bounds.
The fact that the batches inside the array are provided in the correct order should be checked by the caller.</p>
<pre><code class="language-solidity">function decodeAndCheckExecuteData(
  bytes calldata _executeData,
  uint256 _processBatchFrom,
  uint256 _processBatchTo
)
  internal
  pure
  returns (
    IExecutor.StoredBatchInfo[] memory executeData,
    PriorityOpsBatchInfo[] memory priorityOpsData,
    InteropRoot[][] memory dependencyRoots
  );
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_executeData</code></td><td><code>bytes</code></td><td>The calldata byte array containing the execution data to decode.</td></tr>
<tr><td><code>_processBatchFrom</code></td><td><code>uint256</code></td><td>The expected batch number of the first batch in the array.</td></tr>
<tr><td><code>_processBatchTo</code></td><td><code>uint256</code></td><td>The expected batch number of the last batch in the array.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>executeData</code></td><td><code>IExecutor.StoredBatchInfo[]</code></td><td>An array containing the stored batch information for execution.</td></tr>
<tr><td><code>priorityOpsData</code></td><td><code>PriorityOpsBatchInfo[]</code></td><td>Merkle proofs of the priority operations for each batch.</td></tr>
<tr><td><code>dependencyRoots</code></td><td><code>InteropRoot[][]</code></td><td></td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="transactionvalidator"><a class="header" href="#transactionvalidator">TransactionValidator</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/l1-contracts/state-transition/libraries/TransactionValidator.sol">Git Source</a></p>
<p><strong>Title:</strong>
ZKsync Library for validating L1 -&gt; L2 transactions</p>
<p><strong>Author:</strong>
Matter Labs</p>
<p><strong>Note:</strong>
security-contact: security@matterlabs.dev</p>
<h2 id="functions-91"><a class="header" href="#functions-91">Functions</a></h2>
<h3 id="validatel1tol2transaction"><a class="header" href="#validatel1tol2transaction">validateL1ToL2Transaction</a></h3>
<p>Used to validate key properties of an L1-&gt;L2 transaction</p>
<pre><code class="language-solidity">function validateL1ToL2Transaction(
  L2CanonicalTransaction memory _transaction,
  bytes memory _encoded,
  uint256 _priorityTxMaxGasLimit,
  uint256 _priorityTxMaxPubdata
) internal pure;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_transaction</code></td><td><code>L2CanonicalTransaction</code></td><td>The transaction to validate</td></tr>
<tr><td><code>_encoded</code></td><td><code>bytes</code></td><td>The abi encoded bytes of the transaction</td></tr>
<tr><td><code>_priorityTxMaxGasLimit</code></td><td><code>uint256</code></td><td>The max gas limit, generally provided from Storage.sol</td></tr>
<tr><td><code>_priorityTxMaxPubdata</code></td><td><code>uint256</code></td><td>The maximal amount of pubdata that a single L1-&gt;L2 transaction can emit</td></tr>
</tbody></table>
</div>
<h3 id="validateupgradetransaction"><a class="header" href="#validateupgradetransaction">validateUpgradeTransaction</a></h3>
<p>Used to validate upgrade transactions</p>
<pre><code class="language-solidity">function validateUpgradeTransaction(L2CanonicalTransaction memory _transaction)
  internal
  pure;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_transaction</code></td><td><code>L2CanonicalTransaction</code></td><td>The transaction to validate</td></tr>
</tbody></table>
</div>
<h3 id="getminimalprioritytransactiongaslimit"><a class="header" href="#getminimalprioritytransactiongaslimit">getMinimalPriorityTransactionGasLimit</a></h3>
<p>Calculates the approximate minimum gas limit required for executing a priority transaction.</p>
<pre><code class="language-solidity">function getMinimalPriorityTransactionGasLimit(
  uint256 _encodingLength,
  uint256 _numberOfFactoryDependencies,
  uint256 _l2GasPricePerPubdata
) internal pure returns (uint256);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_encodingLength</code></td><td><code>uint256</code></td><td>The length of the priority transaction encoding in bytes.</td></tr>
<tr><td><code>_numberOfFactoryDependencies</code></td><td><code>uint256</code></td><td>The number of new factory dependencies that will be added.</td></tr>
<tr><td><code>_l2GasPricePerPubdata</code></td><td><code>uint256</code></td><td>The L2 gas price for publishing the priority transaction on L2.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint256</code></td><td>The minimum gas limit required to execute the priority transaction. Note: The calculation includes the main cost of the priority transaction, however, in reality, the operator can spend a little more gas on overheads.</td></tr>
</tbody></table>
</div>
<h3 id="gettransactionbodygaslimit"><a class="header" href="#gettransactionbodygaslimit">getTransactionBodyGasLimit</a></h3>
<p>Based on the full L2 gas limit (that includes the batch overhead) and other
properties of the transaction, returns the l2GasLimit for the body of the transaction (the actual execution).</p>
<pre><code class="language-solidity">function getTransactionBodyGasLimit(
  uint256 _totalGasLimit,
  uint256 _encodingLength
) internal pure returns (uint256 txBodyGasLimit);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_totalGasLimit</code></td><td><code>uint256</code></td><td>The L2 gas limit that includes both the overhead for processing the batch and the L2 gas needed to process the transaction itself (i.e. the actual l2GasLimit that will be used for the transaction).</td></tr>
<tr><td><code>_encodingLength</code></td><td><code>uint256</code></td><td>The length of the ABI-encoding of the transaction.</td></tr>
</tbody></table>
</div>
<h3 id="getoverheadfortransaction"><a class="header" href="#getoverheadfortransaction">getOverheadForTransaction</a></h3>
<p>Based on the total L2 gas limit and several other parameters of the transaction
returns the part of the L2 gas that will be spent on the batch's overhead.</p>
<p>The details of how this function works can be checked in the documentation
of the fee model of ZKsync. The appropriate comments are also present
in the Rust implementation description of function <code>get_maximal_allowed_overhead</code>.</p>
<pre><code class="language-solidity">function getOverheadForTransaction(uint256 _encodingLength)
  internal
  pure
  returns (uint256 batchOverheadForTransaction);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_encodingLength</code></td><td><code>uint256</code></td><td>The length of the binary encoding of the transaction in bytes</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="systemcontractscaller"><a class="header" href="#systemcontractscaller">SystemContractsCaller</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/l2-contracts/SystemContractsCaller.sol">Git Source</a></p>
<p>The library contains the functions to make system calls.</p>
<p>A more detailed description of the library and its methods can be found in the <code>system-contracts</code> repo.</p>
<h2 id="functions-92"><a class="header" href="#functions-92">Functions</a></h2>
<h3 id="systemcall"><a class="header" href="#systemcall">systemCall</a></h3>
<pre><code class="language-solidity">function systemCall(
  uint32 gasLimit,
  address to,
  uint256 value,
  bytes memory data
) internal returns (bool success);
</code></pre>
<h3 id="systemcallwithreturndata"><a class="header" href="#systemcallwithreturndata">systemCallWithReturndata</a></h3>
<pre><code class="language-solidity">function systemCallWithReturndata(
  uint32 gasLimit,
  address to,
  uint128 value,
  bytes memory data
) internal returns (bool success, bytes memory returnData);
</code></pre>
<h3 id="getfarcallabi"><a class="header" href="#getfarcallabi">getFarCallABI</a></h3>
<pre><code class="language-solidity">function getFarCallABI(
  uint32 dataOffset,
  uint32 memoryPage,
  uint32 dataStart,
  uint32 dataLength,
  uint32 gasPassed,
  uint8 shardId,
  CalldataForwardingMode forwardingMode,
  bool isConstructorCall,
  bool isSystemCall
) internal pure returns (uint256 farCallAbi);
</code></pre>
<h3 id="getfarcallabiwithemptyfatpointer"><a class="header" href="#getfarcallabiwithemptyfatpointer">getFarCallABIWithEmptyFatPointer</a></h3>
<pre><code class="language-solidity">function getFarCallABIWithEmptyFatPointer(
  uint32 gasPassed,
  uint8 shardId,
  CalldataForwardingMode forwardingMode,
  bool isConstructorCall,
  bool isSystemCall
) internal pure returns (uint256 farCallAbiWithEmptyFatPtr);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="utils"><a class="header" href="#utils">Utils</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/l2-contracts/SystemContractsCaller.sol">Git Source</a></p>
<h2 id="functions-93"><a class="header" href="#functions-93">Functions</a></h2>
<h3 id="safecasttou32"><a class="header" href="#safecasttou32">safeCastToU32</a></h3>
<pre><code class="language-solidity">function safeCastToU32(uint256 _x) internal pure returns (uint32);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="contents-19"><a class="header" href="#contents-19">Contents</a></h1>
<ul>
<li><a href="contracts/system-contracts/libraries/EfficientCall.sol/library.EfficientCall.html">EfficientCall</a></li>
<li><a href="contracts/system-contracts/libraries/RLPEncoder.sol/library.RLPEncoder.html">RLPEncoder</a></li>
<li><a href="contracts/system-contracts/libraries/SystemContractHelper.sol/struct.ZkSyncMeta.html">ZkSyncMeta</a></li>
<li><a href="contracts/system-contracts/libraries/SystemContractHelper.sol/enum.Global.html">Global</a></li>
<li><a href="contracts/system-contracts/libraries/SystemContractHelper.sol/library.SystemContractHelper.html">SystemContractHelper</a></li>
<li><a href="contracts/system-contracts/libraries/SystemContractHelper.sol/constants.SystemContractHelper.html">SystemContractHelper constants</a></li>
<li><a href="contracts/system-contracts/libraries/SystemContractsCaller.sol/enum.CalldataForwardingMode.html">CalldataForwardingMode</a></li>
<li><a href="contracts/system-contracts/libraries/SystemContractsCaller.sol/library.SystemContractsCaller.html">SystemContractsCaller</a></li>
<li><a href="contracts/system-contracts/libraries/SystemContractsCaller.sol/constants.SystemContractsCaller.html">SystemContractsCaller constants</a></li>
<li><a href="contracts/system-contracts/libraries/TransactionHelper.sol/struct.Transaction.html">Transaction</a></li>
<li><a href="contracts/system-contracts/libraries/TransactionHelper.sol/library.TransactionHelper.html">TransactionHelper</a></li>
<li><a href="contracts/system-contracts/libraries/TransactionHelper.sol/constants.TransactionHelper.html">TransactionHelper constants</a></li>
<li><a href="contracts/system-contracts/libraries/Utils.sol/library.Utils.html">Utils</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="constants-9"><a class="header" href="#constants-9">Constants</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/libraries/TransactionHelper.sol">Git Source</a></p>
<h3 id="eip_712_tx_type"><a class="header" href="#eip_712_tx_type">EIP_712_TX_TYPE</a></h3>
<p>The type id of ZKsync's EIP-712-signed transaction.</p>
<pre><code class="language-solidity">uint8 constant EIP_712_TX_TYPE = 0x71
</code></pre>
<h3 id="legacy_tx_type"><a class="header" href="#legacy_tx_type">LEGACY_TX_TYPE</a></h3>
<p>The type id of legacy transactions.</p>
<pre><code class="language-solidity">uint8 constant LEGACY_TX_TYPE = 0x0
</code></pre>
<h3 id="eip_2930_tx_type"><a class="header" href="#eip_2930_tx_type">EIP_2930_TX_TYPE</a></h3>
<p>The type id of legacy transactions.</p>
<pre><code class="language-solidity">uint8 constant EIP_2930_TX_TYPE = 0x01
</code></pre>
<h3 id="eip_1559_tx_type"><a class="header" href="#eip_1559_tx_type">EIP_1559_TX_TYPE</a></h3>
<p>The type id of EIP1559 transactions.</p>
<pre><code class="language-solidity">uint8 constant EIP_1559_TX_TYPE = 0x02
</code></pre>
<h3 id="l1_to_l2_tx_type"><a class="header" href="#l1_to_l2_tx_type">L1_TO_L2_TX_TYPE</a></h3>
<p>The type id of L1 to L2 transactions.</p>
<pre><code class="language-solidity">uint8 constant L1_TO_L2_TX_TYPE = 0xFF
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="efficientcall"><a class="header" href="#efficientcall">EfficientCall</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/libraries/EfficientCall.sol">Git Source</a></p>
<p><strong>Author:</strong>
Matter Labs</p>
<p>This library is used to perform ultra-efficient calls using zkEVM-specific features.</p>
<p>EVM calls always accept a memory slice as input and return a memory slice as output.
Therefore, even if the user has a ready-made calldata slice, they still need to copy it to memory
before calling. This is especially inefficient for large inputs (proxies, multi-calls, etc.).
In turn, zkEVM operates over a fat pointer, which is a set of (memory page, offset, start, length) in the memory/calldata/returndata.
This allows forwarding the calldata slice as is, without copying it to memory.</p>
<p>Fat pointer is not just an integer, it is an extended data type supported on the VM level.
zkEVM creates the wellformed fat pointers for all the calldata/returndata regions, later
the contract may manipulate the already created fat pointers to forward a slice of the data, but not
to create new fat pointers!</p>
<p>The allowed operation on fat pointers are:</p>
<ol>
<li><code>ptr.add</code> - Transforms <code>ptr.offset</code> into <code>ptr.offset + u32(_value)</code>. If overflow happens then it panics.</li>
<li><code>ptr.sub</code> - Transforms <code>ptr.offset</code> into <code>ptr.offset - u32(_value)</code>. If underflow happens then it panics.</li>
<li><code>ptr.pack</code> - Do the concatenation between the lowest 128 bits of the pointer itself and the highest 128 bits of <code>_value</code>. It is typically used to prepare the ABI for external calls.</li>
<li><code>ptr.shrink</code> - Transforms <code>ptr.length</code> into <code>ptr.length - u32(_shrink)</code>. If underflow happens then it panics.</li>
</ol>
<p>The call opcodes accept the fat pointer and change it to its canonical form before passing it to the child call</p>
<ol>
<li><code>ptr.start</code> is transformed into <code>ptr.offset + ptr.start</code></li>
<li><code>ptr.length</code> is transformed into <code>ptr.length - ptr.offset</code></li>
<li><code>ptr.offset</code> is transformed into <code>0</code></li>
</ol>
<p><strong>Note:</strong>
security-contact: security@matterlabs.dev</p>
<h2 id="functions-94"><a class="header" href="#functions-94">Functions</a></h2>
<h3 id="keccak"><a class="header" href="#keccak">keccak</a></h3>
<p>Call the <code>keccak256</code> without copying calldata to memory.</p>
<pre><code class="language-solidity">function keccak(bytes calldata _data) internal view returns (bytes32);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_data</code></td><td><code>bytes</code></td><td>The preimage data.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>bytes32</code></td><td>The <code>keccak256</code> hash.</td></tr>
</tbody></table>
</div>
<h3 id="sha"><a class="header" href="#sha">sha</a></h3>
<p>Call the <code>sha256</code> precompile without copying calldata to memory.</p>
<pre><code class="language-solidity">function sha(bytes calldata _data) internal view returns (bytes32);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_data</code></td><td><code>bytes</code></td><td>The preimage data.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>bytes32</code></td><td>The <code>sha256</code> hash.</td></tr>
</tbody></table>
</div>
<h3 id="call-1"><a class="header" href="#call-1">call</a></h3>
<p>Perform a <code>call</code> without copying calldata to memory.</p>
<pre><code class="language-solidity">function call(
  uint256 _gas,
  address _address,
  uint256 _value,
  bytes calldata _data,
  bool _isSystem
) internal returns (bytes memory returnData);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_gas</code></td><td><code>uint256</code></td><td>The gas to use for the call.</td></tr>
<tr><td><code>_address</code></td><td><code>address</code></td><td>The address to call.</td></tr>
<tr><td><code>_value</code></td><td><code>uint256</code></td><td>The <code>msg.value</code> to send.</td></tr>
<tr><td><code>_data</code></td><td><code>bytes</code></td><td>The calldata to use for the call.</td></tr>
<tr><td><code>_isSystem</code></td><td><code>bool</code></td><td>Whether the call should contain the <code>isSystem</code> flag.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>returnData</code></td><td><code>bytes</code></td><td>The copied to memory return data.</td></tr>
</tbody></table>
</div>
<h3 id="staticcall"><a class="header" href="#staticcall">staticCall</a></h3>
<p>Perform a <code>staticCall</code> without copying calldata to memory.</p>
<pre><code class="language-solidity">function staticCall(uint256 _gas, address _address, bytes calldata _data)
  internal
  view
  returns (bytes memory returnData);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_gas</code></td><td><code>uint256</code></td><td>The gas to use for the call.</td></tr>
<tr><td><code>_address</code></td><td><code>address</code></td><td>The address to call.</td></tr>
<tr><td><code>_data</code></td><td><code>bytes</code></td><td>The calldata to use for the call.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>returnData</code></td><td><code>bytes</code></td><td>The copied to memory return data.</td></tr>
</tbody></table>
</div>
<h3 id="delegatecall"><a class="header" href="#delegatecall">delegateCall</a></h3>
<p>Perform a <code>delegateCall</code> without copying calldata to memory.</p>
<pre><code class="language-solidity">function delegateCall(uint256 _gas, address _address, bytes calldata _data)
  internal
  returns (bytes memory returnData);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_gas</code></td><td><code>uint256</code></td><td>The gas to use for the call.</td></tr>
<tr><td><code>_address</code></td><td><code>address</code></td><td>The address to call.</td></tr>
<tr><td><code>_data</code></td><td><code>bytes</code></td><td>The calldata to use for the call.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>returnData</code></td><td><code>bytes</code></td><td>The copied to memory return data.</td></tr>
</tbody></table>
</div>
<h3 id="mimiccall"><a class="header" href="#mimiccall">mimicCall</a></h3>
<p>Perform a <code>mimicCall</code> (a call with custom msg.sender) without copying calldata to memory.</p>
<pre><code class="language-solidity">function mimicCall(
  uint256 _gas,
  address _address,
  bytes calldata _data,
  address _whoToMimic,
  bool _isConstructor,
  bool _isSystem
) internal returns (bytes memory returnData);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_gas</code></td><td><code>uint256</code></td><td>The gas to use for the call.</td></tr>
<tr><td><code>_address</code></td><td><code>address</code></td><td>The address to call.</td></tr>
<tr><td><code>_data</code></td><td><code>bytes</code></td><td>The calldata to use for the call.</td></tr>
<tr><td><code>_whoToMimic</code></td><td><code>address</code></td><td>The <code>msg.sender</code> for the next call.</td></tr>
<tr><td><code>_isConstructor</code></td><td><code>bool</code></td><td>Whether the call should contain the <code>isConstructor</code> flag.</td></tr>
<tr><td><code>_isSystem</code></td><td><code>bool</code></td><td>Whether the call should contain the <code>isSystem</code> flag.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>returnData</code></td><td><code>bytes</code></td><td>The copied to memory return data.</td></tr>
</tbody></table>
</div>
<h3 id="rawcall"><a class="header" href="#rawcall">rawCall</a></h3>
<p>Perform a <code>call</code> without copying calldata to memory.</p>
<pre><code class="language-solidity">function rawCall(
  uint256 _gas,
  address _address,
  uint256 _value,
  bytes calldata _data,
  bool _isSystem
) internal returns (bool success);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_gas</code></td><td><code>uint256</code></td><td>The gas to use for the call.</td></tr>
<tr><td><code>_address</code></td><td><code>address</code></td><td>The address to call.</td></tr>
<tr><td><code>_value</code></td><td><code>uint256</code></td><td>The <code>msg.value</code> to send.</td></tr>
<tr><td><code>_data</code></td><td><code>bytes</code></td><td>The calldata to use for the call.</td></tr>
<tr><td><code>_isSystem</code></td><td><code>bool</code></td><td>Whether the call should contain the <code>isSystem</code> flag.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>success</code></td><td><code>bool</code></td><td>whether the call was successful.</td></tr>
</tbody></table>
</div>
<h3 id="rawstaticcall"><a class="header" href="#rawstaticcall">rawStaticCall</a></h3>
<p>Perform a <code>staticCall</code> without copying calldata to memory.</p>
<pre><code class="language-solidity">function rawStaticCall(uint256 _gas, address _address, bytes calldata _data)
  internal
  view
  returns (bool success);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_gas</code></td><td><code>uint256</code></td><td>The gas to use for the call.</td></tr>
<tr><td><code>_address</code></td><td><code>address</code></td><td>The address to call.</td></tr>
<tr><td><code>_data</code></td><td><code>bytes</code></td><td>The calldata to use for the call.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>success</code></td><td><code>bool</code></td><td>whether the call was successful.</td></tr>
</tbody></table>
</div>
<h3 id="rawdelegatecall"><a class="header" href="#rawdelegatecall">rawDelegateCall</a></h3>
<p>Perform a <code>delegatecall</code> without copying calldata to memory.</p>
<pre><code class="language-solidity">function rawDelegateCall(uint256 _gas, address _address, bytes calldata _data)
  internal
  returns (bool success);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_gas</code></td><td><code>uint256</code></td><td>The gas to use for the call.</td></tr>
<tr><td><code>_address</code></td><td><code>address</code></td><td>The address to call.</td></tr>
<tr><td><code>_data</code></td><td><code>bytes</code></td><td>The calldata to use for the call.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>success</code></td><td><code>bool</code></td><td>whether the call was successful.</td></tr>
</tbody></table>
</div>
<h3 id="rawmimiccall"><a class="header" href="#rawmimiccall">rawMimicCall</a></h3>
<p>Perform a <code>mimicCall</code> (call with custom msg.sender) without copying calldata to memory.</p>
<p>If called not in kernel mode, it will result in a revert (enforced by the VM)</p>
<pre><code class="language-solidity">function rawMimicCall(
  uint256 _gas,
  address _address,
  bytes calldata _data,
  address _whoToMimic,
  bool _isConstructor,
  bool _isSystem
) internal returns (bool success);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_gas</code></td><td><code>uint256</code></td><td>The gas to use for the call.</td></tr>
<tr><td><code>_address</code></td><td><code>address</code></td><td>The address to call.</td></tr>
<tr><td><code>_data</code></td><td><code>bytes</code></td><td>The calldata to use for the call.</td></tr>
<tr><td><code>_whoToMimic</code></td><td><code>address</code></td><td>The <code>msg.sender</code> for the next call.</td></tr>
<tr><td><code>_isConstructor</code></td><td><code>bool</code></td><td>Whether the call should contain the <code>isConstructor</code> flag.</td></tr>
<tr><td><code>_isSystem</code></td><td><code>bool</code></td><td>Whether the call should contain the <code>isSystem</code> flag.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>success</code></td><td><code>bool</code></td><td>whether the call was successful.</td></tr>
</tbody></table>
</div>
<h3 id="_verifycallresult"><a class="header" href="#_verifycallresult">_verifyCallResult</a></h3>
<p>Verify that a low-level call was successful, and revert if it wasn't, by bubbling the revert reason.</p>
<pre><code class="language-solidity">function _verifyCallResult(bool _success)
  private
  pure
  returns (bytes memory returnData);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_success</code></td><td><code>bool</code></td><td>Whether the call was successful.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>returnData</code></td><td><code>bytes</code></td><td>The copied to memory return data.</td></tr>
</tbody></table>
</div>
<h3 id="propagaterevert"><a class="header" href="#propagaterevert">propagateRevert</a></h3>
<p>Propagate the revert reason from the current call to the caller.</p>
<pre><code class="language-solidity">function propagateRevert() internal pure;
</code></pre>
<h3 id="_loadfarcallabiintoactiveptr"><a class="header" href="#_loadfarcallabiintoactiveptr">_loadFarCallABIIntoActivePtr</a></h3>
<p>Load the far call ABI into active ptr, that will be used for the next call by reference.</p>
<pre><code class="language-solidity">function _loadFarCallABIIntoActivePtr(
  uint256 _gas,
  bytes calldata _data,
  bool _isConstructor,
  bool _isSystem
) private view;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_gas</code></td><td><code>uint256</code></td><td>The gas to be passed to the call.</td></tr>
<tr><td><code>_data</code></td><td><code>bytes</code></td><td>The calldata to be passed to the call.</td></tr>
<tr><td><code>_isConstructor</code></td><td><code>bool</code></td><td>Whether the call is a constructor call.</td></tr>
<tr><td><code>_isSystem</code></td><td><code>bool</code></td><td>Whether the call is a system call.</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="rlpencoder"><a class="header" href="#rlpencoder">RLPEncoder</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/libraries/RLPEncoder.sol">Git Source</a></p>
<p><strong>Author:</strong>
Matter Labs</p>
<p>This library provides RLP encoding functionality.</p>
<p><strong>Note:</strong>
security-contact: security@matterlabs.dev</p>
<h2 id="functions-95"><a class="header" href="#functions-95">Functions</a></h2>
<h3 id="encodeaddress"><a class="header" href="#encodeaddress">encodeAddress</a></h3>
<pre><code class="language-solidity">function encodeAddress(address _val)
  internal
  pure
  returns (bytes memory encoded);
</code></pre>
<h3 id="encodeuint256"><a class="header" href="#encodeuint256">encodeUint256</a></h3>
<pre><code class="language-solidity">function encodeUint256(uint256 _val)
  internal
  pure
  returns (bytes memory encoded);
</code></pre>
<h3 id="encodenonsinglebyteslen"><a class="header" href="#encodenonsinglebyteslen">encodeNonSingleBytesLen</a></h3>
<p>Encodes the size of bytes in RLP format.</p>
<pre><code class="language-solidity">function encodeNonSingleBytesLen(uint64 _len)
  internal
  pure
  returns (bytes memory);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_len</code></td><td><code>uint64</code></td><td>The length of the bytes to encode. It has a <code>uint64</code> type since as larger values are not supported. NOTE: panics if the length is 1 since the length encoding is ambiguous in this case.</td></tr>
</tbody></table>
</div>
<h3 id="encodelistlen"><a class="header" href="#encodelistlen">encodeListLen</a></h3>
<p>Encodes the size of list items in RLP format.</p>
<pre><code class="language-solidity">function encodeListLen(uint64 _len) internal pure returns (bytes memory);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_len</code></td><td><code>uint64</code></td><td>The length of the bytes to encode. It has a <code>uint64</code> type since as larger values are not supported.</td></tr>
</tbody></table>
</div>
<h3 id="_encodelength"><a class="header" href="#_encodelength">_encodeLength</a></h3>
<pre><code class="language-solidity">function _encodeLength(uint64 _len, uint256 _offset)
  private
  pure
  returns (bytes memory encoded);
</code></pre>
<h3 id="_highestbyteset"><a class="header" href="#_highestbyteset">_highestByteSet</a></h3>
<p>Computes the index of the highest byte set in number.</p>
<p>Uses little endian ordering (The least significant byte has index <code>0</code>).
NOTE: returns <code>0</code> for <code>0</code></p>
<pre><code class="language-solidity">function _highestByteSet(uint256 _number) private pure returns (uint256 hbs);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="systemcontracthelper"><a class="header" href="#systemcontracthelper">SystemContractHelper</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/libraries/SystemContractHelper.sol">Git Source</a></p>
<p><strong>Author:</strong>
Matter Labs</p>
<p>Library used for accessing zkEVM-specific opcodes, needed for the development
of system contracts.</p>
<p>While this library will be eventually available to public, some of the provided
methods won't work for non-system contracts and also breaking changes at short notice are possible.
We do not recommend this library for external use.</p>
<p><strong>Note:</strong>
security-contact: security@matterlabs.dev</p>
<h2 id="functions-96"><a class="header" href="#functions-96">Functions</a></h2>
<h3 id="tol1"><a class="header" href="#tol1">toL1</a></h3>
<p>Send an L2Log to L1.</p>
<p>The meaning of all these parameters is context-dependent, but they
have no intrinsic meaning per se.</p>
<pre><code class="language-solidity">function toL1(bool _isService, bytes32 _key, bytes32 _value) internal;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_isService</code></td><td><code>bool</code></td><td>The <code>isService</code> flag.</td></tr>
<tr><td><code>_key</code></td><td><code>bytes32</code></td><td>The <code>key</code> part of the L2Log.</td></tr>
<tr><td><code>_value</code></td><td><code>bytes32</code></td><td>The <code>value</code> part of the L2Log.</td></tr>
</tbody></table>
</div>
<h3 id="getcodeaddress"><a class="header" href="#getcodeaddress">getCodeAddress</a></h3>
<p>Get address of the currently executed code.</p>
<p>This allows differentiating between <code>call</code> and <code>delegatecall</code>.
During the former <code>this</code> and <code>codeAddress</code> are the same, while
during the latter they are not.</p>
<pre><code class="language-solidity">function getCodeAddress() internal view returns (address addr);
</code></pre>
<h3 id="loadcalldataintoactiveptr"><a class="header" href="#loadcalldataintoactiveptr">loadCalldataIntoActivePtr</a></h3>
<p>Provide a compiler hint, by placing calldata fat pointer into virtual <code>ACTIVE_PTR</code>,
that can be manipulated by <code>ptr.add</code>/<code>ptr.sub</code>/<code>ptr.pack</code>/<code>ptr.shrink</code> later.</p>
<p>This allows making a call by forwarding calldata pointer to the child call.
It is a much more efficient way to forward calldata, than standard EVM bytes copying.</p>
<pre><code class="language-solidity">function loadCalldataIntoActivePtr() internal view;
</code></pre>
<h3 id="ptrpackintoactiveptr"><a class="header" href="#ptrpackintoactiveptr">ptrPackIntoActivePtr</a></h3>
<p>Compiler simulation of the <code>ptr.pack</code> opcode for the virtual <code>ACTIVE_PTR</code> pointer.</p>
<p>Do the concatenation between lowest part of <code>ACTIVE_PTR</code> and highest part of <code>_farCallAbi</code>
forming packed fat pointer for a far call or ret ABI when necessary.
Note: Panics if the lowest 128 bits of <code>_farCallAbi</code> are not zeroes.</p>
<pre><code class="language-solidity">function ptrPackIntoActivePtr(uint256 _farCallAbi) internal view;
</code></pre>
<h3 id="ptraddintoactive"><a class="header" href="#ptraddintoactive">ptrAddIntoActive</a></h3>
<p>Compiler simulation of the <code>ptr.add</code> opcode for the virtual <code>ACTIVE_PTR</code> pointer.</p>
<p>Transforms <code>ACTIVE_PTR.offset</code> into <code>ACTIVE_PTR.offset + u32(_value)</code>. If overflow happens then it panics.</p>
<pre><code class="language-solidity">function ptrAddIntoActive(uint32 _value) internal view;
</code></pre>
<h3 id="ptrshrinkintoactive"><a class="header" href="#ptrshrinkintoactive">ptrShrinkIntoActive</a></h3>
<p>Compiler simulation of the <code>ptr.shrink</code> opcode for the virtual <code>ACTIVE_PTR</code> pointer.</p>
<p>Transforms <code>ACTIVE_PTR.length</code> into <code>ACTIVE_PTR.length - u32(_shrink)</code>. If underflow happens then it panics.</p>
<pre><code class="language-solidity">function ptrShrinkIntoActive(uint32 _shrink) internal view;
</code></pre>
<h3 id="packprecompileparams"><a class="header" href="#packprecompileparams">packPrecompileParams</a></h3>
<p>packs precompile parameters into one word</p>
<pre><code class="language-solidity">function packPrecompileParams(
  uint32 _inputMemoryOffset,
  uint32 _inputMemoryLength,
  uint32 _outputMemoryOffset,
  uint32 _outputMemoryLength,
  uint64 _perPrecompileInterpreted
) internal pure returns (uint256 rawParams);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_inputMemoryOffset</code></td><td><code>uint32</code></td><td>The memory offset in 32-byte words for the input data for calling the precompile.</td></tr>
<tr><td><code>_inputMemoryLength</code></td><td><code>uint32</code></td><td>The length of the input data in words.</td></tr>
<tr><td><code>_outputMemoryOffset</code></td><td><code>uint32</code></td><td>The memory offset in 32-byte words for the output data.</td></tr>
<tr><td><code>_outputMemoryLength</code></td><td><code>uint32</code></td><td>The length of the output data in words.</td></tr>
<tr><td><code>_perPrecompileInterpreted</code></td><td><code>uint64</code></td><td>The constant, the meaning of which is defined separately for each precompile. For information, please read the documentation of the precompilecall log in the VM.</td></tr>
</tbody></table>
</div>
<h3 id="unsafeprecompilecall"><a class="header" href="#unsafeprecompilecall">unsafePrecompileCall</a></h3>
<p>Call precompile with given parameters.</p>
<p>The list of currently available precompiles sha256, keccak256, ecrecover.
NOTE: The precompile type depends on <code>this</code> which calls precompile, which means that only
system contracts corresponding to the list of precompiles above can do <code>precompileCall</code>.</p>
<p>If used not in the <code>sha256</code>, <code>keccak256</code> or <code>ecrecover</code> contracts, it will just burn the gas provided.</p>
<p>This method is <code>unsafe</code> because it does not check whether there is enough gas to burn.</p>
<pre><code class="language-solidity">function unsafePrecompileCall(
  uint256 _rawParams,
  uint32 _gasToBurn,
  uint32 _pubdataToSpend
) internal view returns (bool success);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_rawParams</code></td><td><code>uint256</code></td><td>The packed precompile params. They can be retrieved by the <code>packPrecompileParams</code> method.</td></tr>
<tr><td><code>_gasToBurn</code></td><td><code>uint32</code></td><td>The number of gas to burn during this call.</td></tr>
<tr><td><code>_pubdataToSpend</code></td><td><code>uint32</code></td><td>The number of pubdata bytes to burn during the call.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>success</code></td><td><code>bool</code></td><td>Whether the call was successful.</td></tr>
</tbody></table>
</div>
<h3 id="setvaluefornextfarcall"><a class="header" href="#setvaluefornextfarcall">setValueForNextFarCall</a></h3>
<p>Set <code>msg.value</code> to next far call.</p>
<p>If called not in kernel mode, it will result in a revert (enforced by the VM)</p>
<pre><code class="language-solidity">function setValueForNextFarCall(uint128 _value)
  internal
  returns (bool success);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_value</code></td><td><code>uint128</code></td><td>The msg.value that will be used for the <em>next</em> call.</td></tr>
</tbody></table>
</div>
<h3 id="eventinitialize"><a class="header" href="#eventinitialize">eventInitialize</a></h3>
<p>Initialize a new event.</p>
<pre><code class="language-solidity">function eventInitialize(uint256 initializer, uint256 value1) internal;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>initializer</code></td><td><code>uint256</code></td><td>The event initializing value.</td></tr>
<tr><td><code>value1</code></td><td><code>uint256</code></td><td>The first topic or data chunk.</td></tr>
</tbody></table>
</div>
<h3 id="eventwrite"><a class="header" href="#eventwrite">eventWrite</a></h3>
<p>Continue writing the previously initialized event.</p>
<pre><code class="language-solidity">function eventWrite(uint256 value1, uint256 value2) internal;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>value1</code></td><td><code>uint256</code></td><td>The first topic or data chunk.</td></tr>
<tr><td><code>value2</code></td><td><code>uint256</code></td><td>The second topic or data chunk.</td></tr>
</tbody></table>
</div>
<h3 id="getzksyncmetabytes"><a class="header" href="#getzksyncmetabytes">getZkSyncMetaBytes</a></h3>
<p>Get the packed representation of the <code>ZkSyncMeta</code> from the current context.</p>
<p>NOTE: The behavior of this function will experience a breaking change in 2024.</p>
<p>The fields in ZkSyncMeta are NOT tightly packed, i.e. there is a special rule on how
they are packed. For more information, please read the documentation on ZkSyncMeta.</p>
<pre><code class="language-solidity">function getZkSyncMetaBytes() internal view returns (uint256 meta);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>meta</code></td><td><code>uint256</code></td><td>The packed representation of the ZkSyncMeta.</td></tr>
</tbody></table>
</div>
<h3 id="extractnumberfrommeta"><a class="header" href="#extractnumberfrommeta">extractNumberFromMeta</a></h3>
<p>Returns the bits [offset..offset+size-1] of the meta.</p>
<pre><code class="language-solidity">function extractNumberFromMeta(uint256 meta, uint256 offset, uint256 size)
  internal
  pure
  returns (uint256 result);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>meta</code></td><td><code>uint256</code></td><td>Packed representation of the ZkSyncMeta.</td></tr>
<tr><td><code>offset</code></td><td><code>uint256</code></td><td>The offset of the bits.</td></tr>
<tr><td><code>size</code></td><td><code>uint256</code></td><td>The size of the extracted number in bits.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>result</code></td><td><code>uint256</code></td><td>The extracted number.</td></tr>
</tbody></table>
</div>
<h3 id="getpubdatapublishedfrommeta"><a class="header" href="#getpubdatapublishedfrommeta">getPubdataPublishedFromMeta</a></h3>
<p>Given the packed representation of <code>ZkSyncMeta</code>, retrieves the number of pubdata
bytes published in the batch so far.</p>
<p>NOTE: The behavior of this function will experience a breaking change in 2024.</p>
<pre><code class="language-solidity">function getPubdataPublishedFromMeta(uint256 meta)
  internal
  pure
  returns (uint32 pubdataPublished);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>meta</code></td><td><code>uint256</code></td><td>Packed representation of the ZkSyncMeta.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>pubdataPublished</code></td><td><code>uint32</code></td><td>The amount of pubdata published in the system so far.</td></tr>
</tbody></table>
</div>
<h3 id="getheapsizefrommeta"><a class="header" href="#getheapsizefrommeta">getHeapSizeFromMeta</a></h3>
<p>Given the packed representation of <code>ZkSyncMeta</code>, retrieves the number of the current size
of the heap in bytes.</p>
<p>The following expression: getHeapSizeFromMeta(getZkSyncMetaBytes()) is
equivalent to the MSIZE in Solidity.</p>
<pre><code class="language-solidity">function getHeapSizeFromMeta(uint256 meta)
  internal
  pure
  returns (uint32 heapSize);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>meta</code></td><td><code>uint256</code></td><td>Packed representation of the ZkSyncMeta.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>heapSize</code></td><td><code>uint32</code></td><td>The size of the memory in bytes byte.</td></tr>
</tbody></table>
</div>
<h3 id="getauxheapsizefrommeta"><a class="header" href="#getauxheapsizefrommeta">getAuxHeapSizeFromMeta</a></h3>
<p>Given the packed representation of <code>ZkSyncMeta</code>, retrieves the number of the current size
of the auxiliary heap in bytes.</p>
<p>You can read more on auxiliary memory in the VM1.2 documentation.</p>
<pre><code class="language-solidity">function getAuxHeapSizeFromMeta(uint256 meta)
  internal
  pure
  returns (uint32 auxHeapSize);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>meta</code></td><td><code>uint256</code></td><td>Packed representation of the ZkSyncMeta.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>auxHeapSize</code></td><td><code>uint32</code></td><td>The size of the auxiliary memory in bytes byte.</td></tr>
</tbody></table>
</div>
<h3 id="getshardidfrommeta"><a class="header" href="#getshardidfrommeta">getShardIdFromMeta</a></h3>
<p>Given the packed representation of <code>ZkSyncMeta</code>, retrieves the shardId of <code>this</code>.</p>
<p>Currently only shard 0 (zkRollup) is supported.</p>
<pre><code class="language-solidity">function getShardIdFromMeta(uint256 meta)
  internal
  pure
  returns (uint8 shardId);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>meta</code></td><td><code>uint256</code></td><td>Packed representation of the ZkSyncMeta.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>shardId</code></td><td><code>uint8</code></td><td>The shardId of <code>this</code>.</td></tr>
</tbody></table>
</div>
<h3 id="getcallershardidfrommeta"><a class="header" href="#getcallershardidfrommeta">getCallerShardIdFromMeta</a></h3>
<p>Given the packed representation of <code>ZkSyncMeta</code>, retrieves the shardId of
the msg.sender.</p>
<p>Currently only shard 0 (zkRollup) is supported.</p>
<pre><code class="language-solidity">function getCallerShardIdFromMeta(uint256 meta)
  internal
  pure
  returns (uint8 callerShardId);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>meta</code></td><td><code>uint256</code></td><td>Packed representation of the ZkSyncMeta.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>callerShardId</code></td><td><code>uint8</code></td><td>The shardId of the msg.sender.</td></tr>
</tbody></table>
</div>
<h3 id="getcodeshardidfrommeta"><a class="header" href="#getcodeshardidfrommeta">getCodeShardIdFromMeta</a></h3>
<p>Given the packed representation of <code>ZkSyncMeta</code>, retrieves the shardId of
the currently executed code.</p>
<p>Currently only shard 0 (zkRollup) is supported.</p>
<pre><code class="language-solidity">function getCodeShardIdFromMeta(uint256 meta)
  internal
  pure
  returns (uint8 codeShardId);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>meta</code></td><td><code>uint256</code></td><td>Packed representation of the ZkSyncMeta.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>codeShardId</code></td><td><code>uint8</code></td><td>The shardId of the currently executed code.</td></tr>
</tbody></table>
</div>
<h3 id="getzksyncmeta"><a class="header" href="#getzksyncmeta">getZkSyncMeta</a></h3>
<p>Retrieves the ZkSyncMeta structure.</p>
<p>NOTE: The behavior of this function will experience a breaking change in 2024.</p>
<pre><code class="language-solidity">function getZkSyncMeta() internal view returns (ZkSyncMeta memory meta);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>meta</code></td><td><code>ZkSyncMeta</code></td><td>The ZkSyncMeta execution context parameters.</td></tr>
</tbody></table>
</div>
<h3 id="getcallflags"><a class="header" href="#getcallflags">getCallFlags</a></h3>
<p>Returns the call flags for the current call.</p>
<p>Call flags is the value of the first register
at the start of the call.</p>
<p>The zero bit of the callFlags indicates whether the call is
a constructor call. The first bit of the callFlags indicates whether
the call is a system one.</p>
<pre><code class="language-solidity">function getCallFlags() internal view returns (uint256 callFlags);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>callFlags</code></td><td><code>uint256</code></td><td>The bitmask of the callflags.</td></tr>
</tbody></table>
</div>
<h3 id="getcalldataptr"><a class="header" href="#getcalldataptr">getCalldataPtr</a></h3>
<p>Returns the current calldata pointer.</p>
<p>NOTE: This file is just an integer and it cannot be used
to forward the calldata to the next calls in any way.</p>
<pre><code class="language-solidity">function getCalldataPtr() internal view returns (uint256 ptr);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>ptr</code></td><td><code>uint256</code></td><td>The current calldata pointer.</td></tr>
</tbody></table>
</div>
<h3 id="getextraabidata"><a class="header" href="#getextraabidata">getExtraAbiData</a></h3>
<p>Returns the N-th extraAbiParam for the current call.</p>
<p>It is equal to the value of the (N+2)-th register
at the start of the call.</p>
<pre><code class="language-solidity">function getExtraAbiData(uint256 index)
  internal
  view
  returns (uint256 extraAbiData);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>extraAbiData</code></td><td><code>uint256</code></td><td>The value of the N-th extraAbiParam for this call.</td></tr>
</tbody></table>
</div>
<h3 id="issystemcall"><a class="header" href="#issystemcall">isSystemCall</a></h3>
<p>Returns whether the current call is a system call.</p>
<pre><code class="language-solidity">function isSystemCall() internal view returns (bool);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>bool</code></td><td><code>true</code> or <code>false</code> based on whether the current call is a system call.</td></tr>
</tbody></table>
</div>
<h3 id="issystemcontract"><a class="header" href="#issystemcontract">isSystemContract</a></h3>
<p>Returns whether the address is a system contract.</p>
<pre><code class="language-solidity">function isSystemContract(address _address) internal pure returns (bool);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_address</code></td><td><code>address</code></td><td>The address to test</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>bool</code></td><td><code>true</code> or <code>false</code> based on whether the <code>_address</code> is a system contract.</td></tr>
</tbody></table>
</div>
<h3 id="issystemcallfromevmemulator"><a class="header" href="#issystemcallfromevmemulator">isSystemCallFromEvmEmulator</a></h3>
<p>Returns whether the current call is a system call from EVM emulator.</p>
<pre><code class="language-solidity">function isSystemCallFromEvmEmulator() internal view returns (bool);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>bool</code></td><td><code>true</code> or <code>false</code> based on whether the current call is a system call from EVM emulator.</td></tr>
</tbody></table>
</div>
<h3 id="burngas"><a class="header" href="#burngas">burnGas</a></h3>
<p>Method used for burning a certain amount of gas.</p>
<pre><code class="language-solidity">function burnGas(uint32 _gasToPay, uint32 _pubdataToSpend) internal view;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_gasToPay</code></td><td><code>uint32</code></td><td>The number of gas to burn.</td></tr>
<tr><td><code>_pubdataToSpend</code></td><td><code>uint32</code></td><td>The number of pubdata bytes to burn during the call.</td></tr>
</tbody></table>
</div>
<h3 id="mimiccall-1"><a class="header" href="#mimiccall-1">mimicCall</a></h3>
<p>Performs a <code>mimicCall</code> to an address.</p>
<pre><code class="language-solidity">function mimicCall(address _to, address _whoToMimic, bytes memory _data)
  internal
  returns (bool success, bytes memory returndata);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_to</code></td><td><code>address</code></td><td>The address to call.</td></tr>
<tr><td><code>_whoToMimic</code></td><td><code>address</code></td><td>The address to mimic.</td></tr>
<tr><td><code>_data</code></td><td><code>bytes</code></td><td>The data to pass to the call.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>success</code></td><td><code>bool</code></td><td>Whether the call was successful.</td></tr>
<tr><td><code>returndata</code></td><td><code>bytes</code></td><td>The return data of the call.</td></tr>
</tbody></table>
</div>
<h3 id="forcedeploynoconstructor"><a class="header" href="#forcedeploynoconstructor">forceDeployNoConstructor</a></h3>
<p>Force deploys some bytecode hash to an address
without invoking the constructor.</p>
<pre><code class="language-solidity">function forceDeployNoConstructor(address _addr, bytes32 _bytecodeHash)
  internal;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_addr</code></td><td><code>address</code></td><td>The address to force-deploy the bytecodehash to.</td></tr>
<tr><td><code>_bytecodeHash</code></td><td><code>bytes32</code></td><td>The bytecode hash to force-deploy.</td></tr>
</tbody></table>
</div>
<h3 id="mimiccallwithpropagatedrevert"><a class="header" href="#mimiccallwithpropagatedrevert">mimicCallWithPropagatedRevert</a></h3>
<p>Performs a <code>mimicCall</code> to an address, while ensuring that the call
was successful</p>
<pre><code class="language-solidity">function mimicCallWithPropagatedRevert(
  address _to,
  address _whoToMimic,
  bytes memory _data
) internal;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_to</code></td><td><code>address</code></td><td>The address to call.</td></tr>
<tr><td><code>_whoToMimic</code></td><td><code>address</code></td><td>The address to mimic.</td></tr>
<tr><td><code>_data</code></td><td><code>bytes</code></td><td>The data to pass to the call.</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="constants-10"><a class="header" href="#constants-10">Constants</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/libraries/SystemContractHelper.sol">Git Source</a></p>
<h3 id="uint32_mask"><a class="header" href="#uint32_mask">UINT32_MASK</a></h3>
<pre><code class="language-solidity">uint256 constant UINT32_MASK = type(uint32).max
</code></pre>
<h3 id="uint64_mask"><a class="header" href="#uint64_mask">UINT64_MASK</a></h3>
<pre><code class="language-solidity">uint256 constant UINT64_MASK = type(uint64).max
</code></pre>
<h3 id="uint128_mask"><a class="header" href="#uint128_mask">UINT128_MASK</a></h3>
<pre><code class="language-solidity">uint256 constant UINT128_MASK = type(uint128).max
</code></pre>
<h3 id="address_mask"><a class="header" href="#address_mask">ADDRESS_MASK</a></h3>
<pre><code class="language-solidity">uint256 constant ADDRESS_MASK = type(uint160).max
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="zksyncmeta"><a class="header" href="#zksyncmeta">ZkSyncMeta</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/libraries/SystemContractHelper.sol">Git Source</a></p>
<p>NOTE: The <code>getZkSyncMeta</code> that is used to obtain this struct will experience a breaking change in 2024.</p>
<pre><code class="language-solidity">struct ZkSyncMeta {
uint32 pubdataPublished;
uint32 heapSize;
uint32 auxHeapSize;
uint8 shardId;
uint8 callerShardId;
uint8 codeShardId;
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="global"><a class="header" href="#global">Global</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/libraries/SystemContractHelper.sol">Git Source</a></p>
<pre><code class="language-solidity">enum Global {
CalldataPtr,
CallFlags,
ExtraABIData1,
ExtraABIData2,
ReturndataPtr
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="systemcontractscaller-1"><a class="header" href="#systemcontractscaller-1">SystemContractsCaller</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/libraries/SystemContractsCaller.sol">Git Source</a></p>
<p><strong>Author:</strong>
Matter Labs</p>
<p>A library that allows calling contracts with the <code>isSystem</code> flag.</p>
<p>It is needed to call ContractDeployer and NonceHolder.</p>
<p><strong>Note:</strong>
security-contact: security@matterlabs.dev</p>
<h2 id="functions-97"><a class="header" href="#functions-97">Functions</a></h2>
<h3 id="systemcall-1"><a class="header" href="#systemcall-1">systemCall</a></h3>
<p>Makes a call with the <code>isSystem</code> flag.</p>
<p>Note, that the <code>isSystem</code> flag can only be set when calling system contracts.</p>
<pre><code class="language-solidity">function systemCall(
  uint32 gasLimit,
  address to,
  uint256 value,
  bytes memory data
) internal returns (bool success);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>gasLimit</code></td><td><code>uint32</code></td><td>The gas limit for the call.</td></tr>
<tr><td><code>to</code></td><td><code>address</code></td><td>The address to call.</td></tr>
<tr><td><code>value</code></td><td><code>uint256</code></td><td>The value to pass with the transaction.</td></tr>
<tr><td><code>data</code></td><td><code>bytes</code></td><td>The calldata.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>success</code></td><td><code>bool</code></td><td>Whether the transaction has been successful.</td></tr>
</tbody></table>
</div>
<h3 id="systemcallwithreturndata-1"><a class="header" href="#systemcallwithreturndata-1">systemCallWithReturndata</a></h3>
<p>Makes a call with the <code>isSystem</code> flag.</p>
<p>Note, that the <code>isSystem</code> flag can only be set when calling system contracts.</p>
<pre><code class="language-solidity">function systemCallWithReturndata(
  uint32 gasLimit,
  address to,
  uint128 value,
  bytes memory data
) internal returns (bool success, bytes memory returnData);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>gasLimit</code></td><td><code>uint32</code></td><td>The gas limit for the call.</td></tr>
<tr><td><code>to</code></td><td><code>address</code></td><td>The address to call.</td></tr>
<tr><td><code>value</code></td><td><code>uint128</code></td><td>The value to pass with the transaction.</td></tr>
<tr><td><code>data</code></td><td><code>bytes</code></td><td>The calldata.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>success</code></td><td><code>bool</code></td><td>Whether the transaction has been successful.</td></tr>
<tr><td><code>returnData</code></td><td><code>bytes</code></td><td>The returndata of the transaction (revert reason in case the transaction has failed).</td></tr>
</tbody></table>
</div>
<h3 id="systemcallwithpropagatedrevert"><a class="header" href="#systemcallwithpropagatedrevert">systemCallWithPropagatedRevert</a></h3>
<p>Makes a call with the <code>isSystem</code> flag.</p>
<p>Note, that the <code>isSystem</code> flag can only be set when calling system contracts.</p>
<pre><code class="language-solidity">function systemCallWithPropagatedRevert(
  uint32 gasLimit,
  address to,
  uint128 value,
  bytes memory data
) internal returns (bytes memory returnData);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>gasLimit</code></td><td><code>uint32</code></td><td>The gas limit for the call.</td></tr>
<tr><td><code>to</code></td><td><code>address</code></td><td>The address to call.</td></tr>
<tr><td><code>value</code></td><td><code>uint128</code></td><td>The value to pass with the transaction.</td></tr>
<tr><td><code>data</code></td><td><code>bytes</code></td><td>The calldata.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>returnData</code></td><td><code>bytes</code></td><td>The returndata of the transaction. In case the transaction reverts, the error bubbles up to the parent frame.</td></tr>
</tbody></table>
</div>
<h3 id="getfarcallabi-1"><a class="header" href="#getfarcallabi-1">getFarCallABI</a></h3>
<p>Calculates the packed representation of the FarCallABI.</p>
<p>The <code>FarCallABI</code> has the following structure:
pub struct FarCallABI {
pub memory_quasi_fat_pointer: FatPointer,
pub gas_passed: u32,
pub shard_id: u8,
pub forwarding_mode: FarCallForwardPageType,
pub constructor_call: bool,
pub to_system: bool,
}
The FatPointer struct:
pub struct FatPointer {
pub offset: u32, // offset relative to <code>start</code>
pub memory_page: u32, // memory page where slice is located
pub start: u32, // absolute start of the slice
pub length: u32, // length of the slice
}</p>
<p>Note, that the actual layout is the following:
[0..32) bits -- the calldata offset
[32..64) bits -- the memory page to use. Can be left blank in most of the cases.
[64..96) bits -- the absolute start of the slice
[96..128) bits -- the length of the slice.
[128..192) bits -- empty bits.
[192..224) bits -- gasPassed.
[224..232) bits -- forwarding_mode
[232..240) bits -- shard id.
[240..248) bits -- constructor call flag
[248..256] bits -- system call flag</p>
<pre><code class="language-solidity">function getFarCallABI(
  uint32 dataOffset,
  uint32 memoryPage,
  uint32 dataStart,
  uint32 dataLength,
  uint32 gasPassed,
  uint8 shardId,
  CalldataForwardingMode forwardingMode,
  bool isConstructorCall,
  bool isSystemCall
) internal pure returns (uint256 farCallAbi);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>dataOffset</code></td><td><code>uint32</code></td><td>Calldata offset in memory. Provide 0 unless using custom pointer.</td></tr>
<tr><td><code>memoryPage</code></td><td><code>uint32</code></td><td>Memory page to use. Provide 0 unless using custom pointer.</td></tr>
<tr><td><code>dataStart</code></td><td><code>uint32</code></td><td>The start of the calldata slice. Provide the offset in memory if not using custom pointer.</td></tr>
<tr><td><code>dataLength</code></td><td><code>uint32</code></td><td>The calldata length. Provide the length of the calldata in bytes unless using custom pointer.</td></tr>
<tr><td><code>gasPassed</code></td><td><code>uint32</code></td><td>The gas to pass with the call.</td></tr>
<tr><td><code>shardId</code></td><td><code>uint8</code></td><td>Of the account to call. Currently only 0 is supported.</td></tr>
<tr><td><code>forwardingMode</code></td><td><code>CalldataForwardingMode</code></td><td>The forwarding mode to use: - provide CalldataForwardingMode.UseHeap when using your current memory - provide CalldataForwardingMode.ForwardFatPointer when using custom pointer.</td></tr>
<tr><td><code>isConstructorCall</code></td><td><code>bool</code></td><td>Whether the call will be a call to the constructor (ignored when the caller is not a system contract).</td></tr>
<tr><td><code>isSystemCall</code></td><td><code>bool</code></td><td>Whether the call will have the <code>isSystem</code> flag.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>farCallAbi</code></td><td><code>uint256</code></td><td>The far call ABI.</td></tr>
</tbody></table>
</div>
<h3 id="getfarcallabiwithemptyfatpointer-1"><a class="header" href="#getfarcallabiwithemptyfatpointer-1">getFarCallABIWithEmptyFatPointer</a></h3>
<p>Calculates the packed representation of the FarCallABI with zero fat pointer fields.</p>
<pre><code class="language-solidity">function getFarCallABIWithEmptyFatPointer(
  uint32 gasPassed,
  uint8 shardId,
  CalldataForwardingMode forwardingMode,
  bool isConstructorCall,
  bool isSystemCall
) internal pure returns (uint256 farCallAbiWithEmptyFatPtr);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>gasPassed</code></td><td><code>uint32</code></td><td>The gas to pass with the call.</td></tr>
<tr><td><code>shardId</code></td><td><code>uint8</code></td><td>Of the account to call. Currently only 0 is supported.</td></tr>
<tr><td><code>forwardingMode</code></td><td><code>CalldataForwardingMode</code></td><td>The forwarding mode to use: - provide CalldataForwardingMode.UseHeap when using your current memory - provide CalldataForwardingMode.ForwardFatPointer when using custom pointer.</td></tr>
<tr><td><code>isConstructorCall</code></td><td><code>bool</code></td><td>Whether the call will be a call to the constructor (ignored when the caller is not a system contract).</td></tr>
<tr><td><code>isSystemCall</code></td><td><code>bool</code></td><td>Whether the call will have the <code>isSystem</code> flag.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>farCallAbiWithEmptyFatPtr</code></td><td><code>uint256</code></td><td>The far call ABI with zero fat pointer fields.</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="constants-11"><a class="header" href="#constants-11">Constants</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/libraries/SystemContractsCaller.sol">Git Source</a></p>
<h3 id="to_l1_call_address"><a class="header" href="#to_l1_call_address">TO_L1_CALL_ADDRESS</a></h3>
<pre><code class="language-solidity">address constant TO_L1_CALL_ADDRESS = address((1 &lt;&lt; 16) - 1)
</code></pre>
<h3 id="code_address_call_address"><a class="header" href="#code_address_call_address">CODE_ADDRESS_CALL_ADDRESS</a></h3>
<pre><code class="language-solidity">address constant CODE_ADDRESS_CALL_ADDRESS = address((1 &lt;&lt; 16) - 2)
</code></pre>
<h3 id="precompile_call_address"><a class="header" href="#precompile_call_address">PRECOMPILE_CALL_ADDRESS</a></h3>
<pre><code class="language-solidity">address constant PRECOMPILE_CALL_ADDRESS = address((1 &lt;&lt; 16) - 3)
</code></pre>
<h3 id="meta_call_address"><a class="header" href="#meta_call_address">META_CALL_ADDRESS</a></h3>
<pre><code class="language-solidity">address constant META_CALL_ADDRESS = address((1 &lt;&lt; 16) - 4)
</code></pre>
<h3 id="mimic_call_call_address"><a class="header" href="#mimic_call_call_address">MIMIC_CALL_CALL_ADDRESS</a></h3>
<pre><code class="language-solidity">address constant MIMIC_CALL_CALL_ADDRESS = address((1 &lt;&lt; 16) - 5)
</code></pre>
<h3 id="system_mimic_call_call_address"><a class="header" href="#system_mimic_call_call_address">SYSTEM_MIMIC_CALL_CALL_ADDRESS</a></h3>
<pre><code class="language-solidity">address constant SYSTEM_MIMIC_CALL_CALL_ADDRESS = address((1 &lt;&lt; 16) - 6)
</code></pre>
<h3 id="mimic_call_by_ref_call_address"><a class="header" href="#mimic_call_by_ref_call_address">MIMIC_CALL_BY_REF_CALL_ADDRESS</a></h3>
<pre><code class="language-solidity">address constant MIMIC_CALL_BY_REF_CALL_ADDRESS = address((1 &lt;&lt; 16) - 7)
</code></pre>
<h3 id="system_mimic_call_by_ref_call_address"><a class="header" href="#system_mimic_call_by_ref_call_address">SYSTEM_MIMIC_CALL_BY_REF_CALL_ADDRESS</a></h3>
<pre><code class="language-solidity">address constant SYSTEM_MIMIC_CALL_BY_REF_CALL_ADDRESS = address((1 &lt;&lt; 16) - 8)
</code></pre>
<h3 id="raw_far_call_call_address"><a class="header" href="#raw_far_call_call_address">RAW_FAR_CALL_CALL_ADDRESS</a></h3>
<pre><code class="language-solidity">address constant RAW_FAR_CALL_CALL_ADDRESS = address((1 &lt;&lt; 16) - 9)
</code></pre>
<h3 id="raw_far_call_by_ref_call_address"><a class="header" href="#raw_far_call_by_ref_call_address">RAW_FAR_CALL_BY_REF_CALL_ADDRESS</a></h3>
<pre><code class="language-solidity">address constant RAW_FAR_CALL_BY_REF_CALL_ADDRESS = address((1 &lt;&lt; 16) - 10)
</code></pre>
<h3 id="system_call_call_address"><a class="header" href="#system_call_call_address">SYSTEM_CALL_CALL_ADDRESS</a></h3>
<pre><code class="language-solidity">address constant SYSTEM_CALL_CALL_ADDRESS = address((1 &lt;&lt; 16) - 11)
</code></pre>
<h3 id="system_call_by_ref_call_address"><a class="header" href="#system_call_by_ref_call_address">SYSTEM_CALL_BY_REF_CALL_ADDRESS</a></h3>
<pre><code class="language-solidity">address constant SYSTEM_CALL_BY_REF_CALL_ADDRESS = address((1 &lt;&lt; 16) - 12)
</code></pre>
<h3 id="set_context_value_call_address"><a class="header" href="#set_context_value_call_address">SET_CONTEXT_VALUE_CALL_ADDRESS</a></h3>
<pre><code class="language-solidity">address constant SET_CONTEXT_VALUE_CALL_ADDRESS = address((1 &lt;&lt; 16) - 13)
</code></pre>
<h3 id="set_pubdata_price_call_address"><a class="header" href="#set_pubdata_price_call_address">SET_PUBDATA_PRICE_CALL_ADDRESS</a></h3>
<pre><code class="language-solidity">address constant SET_PUBDATA_PRICE_CALL_ADDRESS = address((1 &lt;&lt; 16) - 14)
</code></pre>
<h3 id="increment_tx_counter_call_address"><a class="header" href="#increment_tx_counter_call_address">INCREMENT_TX_COUNTER_CALL_ADDRESS</a></h3>
<pre><code class="language-solidity">address constant INCREMENT_TX_COUNTER_CALL_ADDRESS = address((1 &lt;&lt; 16) - 15)
</code></pre>
<h3 id="ptr_calldata_call_address"><a class="header" href="#ptr_calldata_call_address">PTR_CALLDATA_CALL_ADDRESS</a></h3>
<pre><code class="language-solidity">address constant PTR_CALLDATA_CALL_ADDRESS = address((1 &lt;&lt; 16) - 16)
</code></pre>
<h3 id="callflags_call_address"><a class="header" href="#callflags_call_address">CALLFLAGS_CALL_ADDRESS</a></h3>
<pre><code class="language-solidity">address constant CALLFLAGS_CALL_ADDRESS = address((1 &lt;&lt; 16) - 17)
</code></pre>
<h3 id="ptr_returndata_call_address"><a class="header" href="#ptr_returndata_call_address">PTR_RETURNDATA_CALL_ADDRESS</a></h3>
<pre><code class="language-solidity">address constant PTR_RETURNDATA_CALL_ADDRESS = address((1 &lt;&lt; 16) - 18)
</code></pre>
<h3 id="event_initialize_address"><a class="header" href="#event_initialize_address">EVENT_INITIALIZE_ADDRESS</a></h3>
<pre><code class="language-solidity">address constant EVENT_INITIALIZE_ADDRESS = address((1 &lt;&lt; 16) - 19)
</code></pre>
<h3 id="event_write_address"><a class="header" href="#event_write_address">EVENT_WRITE_ADDRESS</a></h3>
<pre><code class="language-solidity">address constant EVENT_WRITE_ADDRESS = address((1 &lt;&lt; 16) - 20)
</code></pre>
<h3 id="load_calldata_into_active_ptr_call_address"><a class="header" href="#load_calldata_into_active_ptr_call_address">LOAD_CALLDATA_INTO_ACTIVE_PTR_CALL_ADDRESS</a></h3>
<pre><code class="language-solidity">address constant LOAD_CALLDATA_INTO_ACTIVE_PTR_CALL_ADDRESS =
address((1 &lt;&lt; 16) - 21)
</code></pre>
<h3 id="load_latest_returndata_into_active_ptr_call_address"><a class="header" href="#load_latest_returndata_into_active_ptr_call_address">LOAD_LATEST_RETURNDATA_INTO_ACTIVE_PTR_CALL_ADDRESS</a></h3>
<pre><code class="language-solidity">address constant LOAD_LATEST_RETURNDATA_INTO_ACTIVE_PTR_CALL_ADDRESS =
address((1 &lt;&lt; 16) - 22)
</code></pre>
<h3 id="ptr_add_into_active_call_address"><a class="header" href="#ptr_add_into_active_call_address">PTR_ADD_INTO_ACTIVE_CALL_ADDRESS</a></h3>
<pre><code class="language-solidity">address constant PTR_ADD_INTO_ACTIVE_CALL_ADDRESS = address((1 &lt;&lt; 16) - 23)
</code></pre>
<h3 id="ptr_shrink_into_active_call_address"><a class="header" href="#ptr_shrink_into_active_call_address">PTR_SHRINK_INTO_ACTIVE_CALL_ADDRESS</a></h3>
<pre><code class="language-solidity">address constant PTR_SHRINK_INTO_ACTIVE_CALL_ADDRESS = address((1 &lt;&lt; 16) - 24)
</code></pre>
<h3 id="ptr_pack_into_active_call_address"><a class="header" href="#ptr_pack_into_active_call_address">PTR_PACK_INTO_ACTIVE_CALL_ADDRESS</a></h3>
<pre><code class="language-solidity">address constant PTR_PACK_INTO_ACTIVE_CALL_ADDRESS = address((1 &lt;&lt; 16) - 25)
</code></pre>
<h3 id="multiplication_high_address"><a class="header" href="#multiplication_high_address">MULTIPLICATION_HIGH_ADDRESS</a></h3>
<pre><code class="language-solidity">address constant MULTIPLICATION_HIGH_ADDRESS = address((1 &lt;&lt; 16) - 26)
</code></pre>
<h3 id="get_extra_abi_data_address"><a class="header" href="#get_extra_abi_data_address">GET_EXTRA_ABI_DATA_ADDRESS</a></h3>
<pre><code class="language-solidity">address constant GET_EXTRA_ABI_DATA_ADDRESS = address((1 &lt;&lt; 16) - 27)
</code></pre>
<h3 id="meta_pubdata_published_offset"><a class="header" href="#meta_pubdata_published_offset">META_PUBDATA_PUBLISHED_OFFSET</a></h3>
<pre><code class="language-solidity">uint256 constant META_PUBDATA_PUBLISHED_OFFSET = 0 * 8
</code></pre>
<h3 id="meta_heap_size_offset"><a class="header" href="#meta_heap_size_offset">META_HEAP_SIZE_OFFSET</a></h3>
<pre><code class="language-solidity">uint256 constant META_HEAP_SIZE_OFFSET = 8 * 8
</code></pre>
<h3 id="meta_aux_heap_size_offset"><a class="header" href="#meta_aux_heap_size_offset">META_AUX_HEAP_SIZE_OFFSET</a></h3>
<pre><code class="language-solidity">uint256 constant META_AUX_HEAP_SIZE_OFFSET = 12 * 8
</code></pre>
<h3 id="meta_shard_id_offset"><a class="header" href="#meta_shard_id_offset">META_SHARD_ID_OFFSET</a></h3>
<pre><code class="language-solidity">uint256 constant META_SHARD_ID_OFFSET = 28 * 8
</code></pre>
<h3 id="meta_caller_shard_id_offset"><a class="header" href="#meta_caller_shard_id_offset">META_CALLER_SHARD_ID_OFFSET</a></h3>
<pre><code class="language-solidity">uint256 constant META_CALLER_SHARD_ID_OFFSET = 29 * 8
</code></pre>
<h3 id="meta_code_shard_id_offset"><a class="header" href="#meta_code_shard_id_offset">META_CODE_SHARD_ID_OFFSET</a></h3>
<pre><code class="language-solidity">uint256 constant META_CODE_SHARD_ID_OFFSET = 30 * 8
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="calldataforwardingmode"><a class="header" href="#calldataforwardingmode">CalldataForwardingMode</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/libraries/SystemContractsCaller.sol">Git Source</a></p>
<p>The way to forward the calldata:</p>
<ul>
<li>Use the current heap (i.e. the same as on EVM).</li>
<li>Use the auxiliary heap.</li>
<li>Forward via a pointer</li>
</ul>
<p>Note, that currently, users do not have access to the auxiliary
heap and so the only type of forwarding that will be used by the users
are UseHeap and ForwardFatPointer for forwarding a slice of the current calldata
to the next call.</p>
<pre><code class="language-solidity">enum CalldataForwardingMode {
UseHeap,
ForwardFatPointer,
UseAuxHeap
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="utils-1"><a class="header" href="#utils-1">Utils</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/b5917be5e3e10da8710466f2c120aebadc92ff69/contracts/system-contracts/libraries/Utils.sol">Git Source</a></p>
<p><strong>Author:</strong>
Matter Labs</p>
<p>Common utilities used in ZKsync system contracts</p>
<p><strong>Note:</strong>
security-contact: security@matterlabs.dev</p>
<h2 id="state-variables-5"><a class="header" href="#state-variables-5">State Variables</a></h2>
<h3 id="is_constructor_bytecode_hash_bit_mask"><a class="header" href="#is_constructor_bytecode_hash_bit_mask">IS_CONSTRUCTOR_BYTECODE_HASH_BIT_MASK</a></h3>
<p>Bit mask of bytecode hash "isConstructor" marker</p>
<pre><code class="language-solidity">bytes32 internal constant IS_CONSTRUCTOR_BYTECODE_HASH_BIT_MASK =
  0x00ff000000000000000000000000000000000000000000000000000000000000
</code></pre>
<h3 id="set_is_constructor_marker_bit_mask"><a class="header" href="#set_is_constructor_marker_bit_mask">SET_IS_CONSTRUCTOR_MARKER_BIT_MASK</a></h3>
<p>Bit mask to set the "isConstructor" marker in the bytecode hash</p>
<pre><code class="language-solidity">bytes32 internal constant SET_IS_CONSTRUCTOR_MARKER_BIT_MASK =
  0x0001000000000000000000000000000000000000000000000000000000000000
</code></pre>
<h3 id="max_bytecode_length"><a class="header" href="#max_bytecode_length">MAX_BYTECODE_LENGTH</a></h3>
<pre><code class="language-solidity">uint256 internal constant MAX_BYTECODE_LENGTH = (2 ** 16) - 1
</code></pre>
<h2 id="functions-98"><a class="header" href="#functions-98">Functions</a></h2>
<h3 id="safecasttou128"><a class="header" href="#safecasttou128">safeCastToU128</a></h3>
<pre><code class="language-solidity">function safeCastToU128(uint256 _x) internal pure returns (uint128);
</code></pre>
<h3 id="safecasttou32-1"><a class="header" href="#safecasttou32-1">safeCastToU32</a></h3>
<pre><code class="language-solidity">function safeCastToU32(uint256 _x) internal pure returns (uint32);
</code></pre>
<h3 id="safecasttou24"><a class="header" href="#safecasttou24">safeCastToU24</a></h3>
<pre><code class="language-solidity">function safeCastToU24(uint256 _x) internal pure returns (uint24);
</code></pre>
<h3 id="iscodehashevm"><a class="header" href="#iscodehashevm">isCodeHashEVM</a></h3>
<pre><code class="language-solidity">function isCodeHashEVM(bytes32 _bytecodeHash) internal pure returns (bool);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>bool</code></td><td>If this bytecode hash for EVM contract or not</td></tr>
</tbody></table>
</div>
<h3 id="bytecodeleninbytes"><a class="header" href="#bytecodeleninbytes">bytecodeLenInBytes</a></h3>
<pre><code class="language-solidity">function bytecodeLenInBytes(bytes32 _bytecodeHash)
  internal
  pure
  returns (uint256 codeLengthInBytes);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>codeLengthInBytes</code></td><td><code>uint256</code></td><td>The bytecode length in bytes</td></tr>
</tbody></table>
</div>
<h3 id="bytecodeleninwords"><a class="header" href="#bytecodeleninwords">bytecodeLenInWords</a></h3>
<pre><code class="language-solidity">function bytecodeLenInWords(bytes32 _bytecodeHash)
  internal
  pure
  returns (uint256 codeLengthInWords);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>codeLengthInWords</code></td><td><code>uint256</code></td><td>The bytecode length in machine words</td></tr>
</tbody></table>
</div>
<h3 id="iscontractconstructed"><a class="header" href="#iscontractconstructed">isContractConstructed</a></h3>
<p>Denotes whether bytecode hash corresponds to a contract that already constructed</p>
<pre><code class="language-solidity">function isContractConstructed(bytes32 _bytecodeHash)
  internal
  pure
  returns (bool);
</code></pre>
<h3 id="iscontractconstructing"><a class="header" href="#iscontractconstructing">isContractConstructing</a></h3>
<p>Denotes whether bytecode hash corresponds to a contract that is on constructor or has already been constructed</p>
<pre><code class="language-solidity">function isContractConstructing(bytes32 _bytecodeHash)
  internal
  pure
  returns (bool);
</code></pre>
<h3 id="constructingbytecodehash"><a class="header" href="#constructingbytecodehash">constructingBytecodeHash</a></h3>
<p>Sets "isConstructor" flag to TRUE for the bytecode hash</p>
<pre><code class="language-solidity">function constructingBytecodeHash(bytes32 _bytecodeHash)
  internal
  pure
  returns (bytes32);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_bytecodeHash</code></td><td><code>bytes32</code></td><td>The bytecode hash for which it is needed to set the constructing flag</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>bytes32</code></td><td>The bytecode hash with "isConstructor" flag set to TRUE</td></tr>
</tbody></table>
</div>
<h3 id="constructedbytecodehash"><a class="header" href="#constructedbytecodehash">constructedBytecodeHash</a></h3>
<p>Sets "isConstructor" flag to FALSE for the bytecode hash</p>
<pre><code class="language-solidity">function constructedBytecodeHash(bytes32 _bytecodeHash)
  internal
  pure
  returns (bytes32);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_bytecodeHash</code></td><td><code>bytes32</code></td><td>The bytecode hash for which it is needed to set the constructing flag</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>bytes32</code></td><td>The bytecode hash with "isConstructor" flag set to FALSE</td></tr>
</tbody></table>
</div>
<h3 id="hashl2bytecode-1"><a class="header" href="#hashl2bytecode-1">hashL2Bytecode</a></h3>
<p>Validate the bytecode format and calculate its hash.</p>
<pre><code class="language-solidity">function hashL2Bytecode(bytes calldata _bytecode)
  internal
  view
  returns (bytes32 hashedBytecode);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_bytecode</code></td><td><code>bytes</code></td><td>The bytecode to hash.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>hashedBytecode</code></td><td><code>bytes32</code></td><td>The 32-byte hash of the bytecode. Note: The function reverts the execution if the bytecode has non expected format: - Bytecode bytes length is not a multiple of 32 - Bytecode bytes length is not less than 2^21 bytes (2^16 words) - Bytecode words length is not odd</td></tr>
</tbody></table>
</div>
<h3 id="hashevmbytecode"><a class="header" href="#hashevmbytecode">hashEVMBytecode</a></h3>
<p>Validate the bytecode format and calculate its hash.</p>
<pre><code class="language-solidity">function hashEVMBytecode(
  uint256 _evmBytecodeLen,
  bytes calldata _paddedBytecode
) internal view returns (bytes32 hashedEVMBytecode);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_evmBytecodeLen</code></td><td><code>uint256</code></td><td>The length of original EVM bytecode in bytes</td></tr>
<tr><td><code>_paddedBytecode</code></td><td><code>bytes</code></td><td>The padded EVM bytecode to hash.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>hashedEVMBytecode</code></td><td><code>bytes32</code></td><td>The 32-byte hash of the EVM bytecode. Note: The function reverts the execution if the bytecode has non expected format: - Bytecode bytes length is not a multiple of 32 - Bytecode bytes length is greater than 2^16 - 1 bytes - Bytecode words length is not odd</td></tr>
</tbody></table>
</div>
<h3 id="getnewaddresscreate2evm"><a class="header" href="#getnewaddresscreate2evm">getNewAddressCreate2EVM</a></h3>
<p>Calculates the address of a deployed contract via create2 on the EVM</p>
<pre><code class="language-solidity">function getNewAddressCreate2EVM(
  address _sender,
  bytes32 _salt,
  bytes32 _bytecodeHash
) internal pure returns (address newAddress);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_sender</code></td><td><code>address</code></td><td>The account that deploys the contract.</td></tr>
<tr><td><code>_salt</code></td><td><code>bytes32</code></td><td>The create2 salt.</td></tr>
<tr><td><code>_bytecodeHash</code></td><td><code>bytes32</code></td><td>The hash of the init code of the new contract.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>newAddress</code></td><td><code>address</code></td><td>The derived address of the account.</td></tr>
</tbody></table>
</div>
<h3 id="getnewaddresscreateevm"><a class="header" href="#getnewaddresscreateevm">getNewAddressCreateEVM</a></h3>
<p>Calculates the address of a deployed contract via create</p>
<pre><code class="language-solidity">function getNewAddressCreateEVM(address _sender, uint256 _senderNonce)
  internal
  pure
  returns (address newAddress);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_sender</code></td><td><code>address</code></td><td>The account that deploys the contract.</td></tr>
<tr><td><code>_senderNonce</code></td><td><code>uint256</code></td><td>The deploy nonce of the sender's account.</td></tr>
</tbody></table>
</div>
                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">

            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->
        <script src="solidity.min.js"></script>

        <script>
        window.addEventListener('load', function() {
            MathJax.Hub.Register.StartupHook('End', function() {
                window.setTimeout(window.print, 100);
            });
        });
        </script>

    </div>
    </body>
</html>
