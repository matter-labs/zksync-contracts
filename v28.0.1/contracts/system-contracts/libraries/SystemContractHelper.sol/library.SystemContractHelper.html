<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>SystemContractHelper - ZKSync Contracts</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../../../../favicon.svg">
        <link rel="shortcut icon" href="../../../../favicon.png">
        <link rel="stylesheet" href="../../../../css/variables.css">
        <link rel="stylesheet" href="../../../../css/general.css">
        <link rel="stylesheet" href="../../../../css/chrome.css">
        <link rel="stylesheet" href="../../../../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../../../../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../../../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="../../../../highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="../../../../tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="../../../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="../../../../book.css">

        <!-- MathJax -->
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../../../../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../../../../toc.js"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../../../../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">ZKSync Contracts</h1>

                    <div class="right-buttons">
                        <a href="../../../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/matter-labs/zksync-contracts" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="systemcontracthelper"><a class="header" href="#systemcontracthelper">SystemContractHelper</a></h1>
<p><a href="https://github.com/matter-labs/zksync-contracts/blob/df3e167e528433a1b7073cb33b1253ee4f052445/contracts/system-contracts/libraries/SystemContractHelper.sol">Git Source</a></p>
<p><strong>Author:</strong>
Matter Labs</p>
<p>Library used for accessing zkEVM-specific opcodes, needed for the development
of system contracts.</p>
<p><em>While this library will be eventually available to public, some of the provided
methods won't work for non-system contracts and also breaking changes at short notice are possible.
We do not recommend this library for external use.</em></p>
<p><strong>Note:</strong>
security-contact: security@matterlabs.dev</p>
<h2 id="functions"><a class="header" href="#functions">Functions</a></h2>
<h3 id="tol1"><a class="header" href="#tol1">toL1</a></h3>
<p>Send an L2Log to L1.</p>
<p><em>The meaning of all these parameters is context-dependent, but they
have no intrinsic meaning per se.</em></p>
<pre><code class="language-solidity">function toL1(bool _isService, bytes32 _key, bytes32 _value) internal;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_isService</code></td><td><code>bool</code></td><td>The <code>isService</code> flag.</td></tr>
<tr><td><code>_key</code></td><td><code>bytes32</code></td><td>The <code>key</code> part of the L2Log.</td></tr>
<tr><td><code>_value</code></td><td><code>bytes32</code></td><td>The <code>value</code> part of the L2Log.</td></tr>
</tbody></table>
</div>
<h3 id="getcodeaddress"><a class="header" href="#getcodeaddress">getCodeAddress</a></h3>
<p>Get address of the currently executed code.</p>
<p><em>This allows differentiating between <code>call</code> and <code>delegatecall</code>.
During the former <code>this</code> and <code>codeAddress</code> are the same, while
during the latter they are not.</em></p>
<pre><code class="language-solidity">function getCodeAddress() internal view returns (address addr);
</code></pre>
<h3 id="loadcalldataintoactiveptr"><a class="header" href="#loadcalldataintoactiveptr">loadCalldataIntoActivePtr</a></h3>
<p>Provide a compiler hint, by placing calldata fat pointer into virtual <code>ACTIVE_PTR</code>,
that can be manipulated by <code>ptr.add</code>/<code>ptr.sub</code>/<code>ptr.pack</code>/<code>ptr.shrink</code> later.</p>
<p><em>This allows making a call by forwarding calldata pointer to the child call.
It is a much more efficient way to forward calldata, than standard EVM bytes copying.</em></p>
<pre><code class="language-solidity">function loadCalldataIntoActivePtr() internal view;
</code></pre>
<h3 id="ptrpackintoactiveptr"><a class="header" href="#ptrpackintoactiveptr">ptrPackIntoActivePtr</a></h3>
<p>Compiler simulation of the <code>ptr.pack</code> opcode for the virtual <code>ACTIVE_PTR</code> pointer.</p>
<p><em>Do the concatenation between lowest part of <code>ACTIVE_PTR</code> and highest part of <code>_farCallAbi</code>
forming packed fat pointer for a far call or ret ABI when necessary.
Note: Panics if the lowest 128 bits of <code>_farCallAbi</code> are not zeroes.</em></p>
<pre><code class="language-solidity">function ptrPackIntoActivePtr(uint256 _farCallAbi) internal view;
</code></pre>
<h3 id="ptraddintoactive"><a class="header" href="#ptraddintoactive">ptrAddIntoActive</a></h3>
<p>Compiler simulation of the <code>ptr.add</code> opcode for the virtual <code>ACTIVE_PTR</code> pointer.</p>
<p><em>Transforms <code>ACTIVE_PTR.offset</code> into <code>ACTIVE_PTR.offset + u32(_value)</code>. If overflow happens then it panics.</em></p>
<pre><code class="language-solidity">function ptrAddIntoActive(uint32 _value) internal view;
</code></pre>
<h3 id="ptrshrinkintoactive"><a class="header" href="#ptrshrinkintoactive">ptrShrinkIntoActive</a></h3>
<p>Compiler simulation of the <code>ptr.shrink</code> opcode for the virtual <code>ACTIVE_PTR</code> pointer.</p>
<p><em>Transforms <code>ACTIVE_PTR.length</code> into <code>ACTIVE_PTR.length - u32(_shrink)</code>. If underflow happens then it panics.</em></p>
<pre><code class="language-solidity">function ptrShrinkIntoActive(uint32 _shrink) internal view;
</code></pre>
<h3 id="packprecompileparams"><a class="header" href="#packprecompileparams">packPrecompileParams</a></h3>
<p>packs precompile parameters into one word</p>
<pre><code class="language-solidity">function packPrecompileParams(
  uint32 _inputMemoryOffset,
  uint32 _inputMemoryLength,
  uint32 _outputMemoryOffset,
  uint32 _outputMemoryLength,
  uint64 _perPrecompileInterpreted
) internal pure returns (uint256 rawParams);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_inputMemoryOffset</code></td><td><code>uint32</code></td><td>The memory offset in 32-byte words for the input data for calling the precompile.</td></tr>
<tr><td><code>_inputMemoryLength</code></td><td><code>uint32</code></td><td>The length of the input data in words.</td></tr>
<tr><td><code>_outputMemoryOffset</code></td><td><code>uint32</code></td><td>The memory offset in 32-byte words for the output data.</td></tr>
<tr><td><code>_outputMemoryLength</code></td><td><code>uint32</code></td><td>The length of the output data in words.</td></tr>
<tr><td><code>_perPrecompileInterpreted</code></td><td><code>uint64</code></td><td>The constant, the meaning of which is defined separately for each precompile. For information, please read the documentation of the precompilecall log in the VM.</td></tr>
</tbody></table>
</div>
<h3 id="unsafeprecompilecall"><a class="header" href="#unsafeprecompilecall">unsafePrecompileCall</a></h3>
<p>Call precompile with given parameters.</p>
<p><em>The list of currently available precompiles sha256, keccak256, ecrecover.
NOTE: The precompile type depends on <code>this</code> which calls precompile, which means that only
system contracts corresponding to the list of precompiles above can do <code>precompileCall</code>.</em></p>
<p><em>If used not in the <code>sha256</code>, <code>keccak256</code> or <code>ecrecover</code> contracts, it will just burn the gas provided.</em></p>
<p><em>This method is <code>unsafe</code> because it does not check whether there is enough gas to burn.</em></p>
<pre><code class="language-solidity">function unsafePrecompileCall(
  uint256 _rawParams,
  uint32 _gasToBurn,
  uint32 _pubdataToSpend
) internal view returns (bool success);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_rawParams</code></td><td><code>uint256</code></td><td>The packed precompile params. They can be retrieved by the <code>packPrecompileParams</code> method.</td></tr>
<tr><td><code>_gasToBurn</code></td><td><code>uint32</code></td><td>The number of gas to burn during this call.</td></tr>
<tr><td><code>_pubdataToSpend</code></td><td><code>uint32</code></td><td>The number of pubdata bytes to burn during the call.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>success</code></td><td><code>bool</code></td><td>Whether the call was successful.</td></tr>
</tbody></table>
</div>
<h3 id="setvaluefornextfarcall"><a class="header" href="#setvaluefornextfarcall">setValueForNextFarCall</a></h3>
<p>Set <code>msg.value</code> to next far call.</p>
<p><em>If called not in kernel mode, it will result in a revert (enforced by the VM)</em></p>
<pre><code class="language-solidity">function setValueForNextFarCall(uint128 _value) internal returns (bool success);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_value</code></td><td><code>uint128</code></td><td>The msg.value that will be used for the <em>next</em> call.</td></tr>
</tbody></table>
</div>
<h3 id="eventinitialize"><a class="header" href="#eventinitialize">eventInitialize</a></h3>
<p>Initialize a new event.</p>
<pre><code class="language-solidity">function eventInitialize(uint256 initializer, uint256 value1) internal;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>initializer</code></td><td><code>uint256</code></td><td>The event initializing value.</td></tr>
<tr><td><code>value1</code></td><td><code>uint256</code></td><td>The first topic or data chunk.</td></tr>
</tbody></table>
</div>
<h3 id="eventwrite"><a class="header" href="#eventwrite">eventWrite</a></h3>
<p>Continue writing the previously initialized event.</p>
<pre><code class="language-solidity">function eventWrite(uint256 value1, uint256 value2) internal;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>value1</code></td><td><code>uint256</code></td><td>The first topic or data chunk.</td></tr>
<tr><td><code>value2</code></td><td><code>uint256</code></td><td>The second topic or data chunk.</td></tr>
</tbody></table>
</div>
<h3 id="getzksyncmetabytes"><a class="header" href="#getzksyncmetabytes">getZkSyncMetaBytes</a></h3>
<p>Get the packed representation of the <code>ZkSyncMeta</code> from the current context.</p>
<p>NOTE: The behavior of this function will experience a breaking change in 2024.</p>
<p><em>The fields in ZkSyncMeta are NOT tightly packed, i.e. there is a special rule on how
they are packed. For more information, please read the documentation on ZkSyncMeta.</em></p>
<pre><code class="language-solidity">function getZkSyncMetaBytes() internal view returns (uint256 meta);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>meta</code></td><td><code>uint256</code></td><td>The packed representation of the ZkSyncMeta.</td></tr>
</tbody></table>
</div>
<h3 id="extractnumberfrommeta"><a class="header" href="#extractnumberfrommeta">extractNumberFromMeta</a></h3>
<p>Returns the bits [offset..offset+size-1] of the meta.</p>
<pre><code class="language-solidity">function extractNumberFromMeta(uint256 meta, uint256 offset, uint256 size)
  internal
  pure
  returns (uint256 result);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>meta</code></td><td><code>uint256</code></td><td>Packed representation of the ZkSyncMeta.</td></tr>
<tr><td><code>offset</code></td><td><code>uint256</code></td><td>The offset of the bits.</td></tr>
<tr><td><code>size</code></td><td><code>uint256</code></td><td>The size of the extracted number in bits.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>result</code></td><td><code>uint256</code></td><td>The extracted number.</td></tr>
</tbody></table>
</div>
<h3 id="getpubdatapublishedfrommeta"><a class="header" href="#getpubdatapublishedfrommeta">getPubdataPublishedFromMeta</a></h3>
<p>Given the packed representation of <code>ZkSyncMeta</code>, retrieves the number of pubdata
bytes published in the batch so far.</p>
<p>NOTE: The behavior of this function will experience a breaking change in 2024.</p>
<pre><code class="language-solidity">function getPubdataPublishedFromMeta(uint256 meta)
  internal
  pure
  returns (uint32 pubdataPublished);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>meta</code></td><td><code>uint256</code></td><td>Packed representation of the ZkSyncMeta.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>pubdataPublished</code></td><td><code>uint32</code></td><td>The amount of pubdata published in the system so far.</td></tr>
</tbody></table>
</div>
<h3 id="getheapsizefrommeta"><a class="header" href="#getheapsizefrommeta">getHeapSizeFromMeta</a></h3>
<p>Given the packed representation of <code>ZkSyncMeta</code>, retrieves the number of the current size
of the heap in bytes.</p>
<p><em>The following expression: getHeapSizeFromMeta(getZkSyncMetaBytes()) is
equivalent to the MSIZE in Solidity.</em></p>
<pre><code class="language-solidity">function getHeapSizeFromMeta(uint256 meta)
  internal
  pure
  returns (uint32 heapSize);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>meta</code></td><td><code>uint256</code></td><td>Packed representation of the ZkSyncMeta.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>heapSize</code></td><td><code>uint32</code></td><td>The size of the memory in bytes byte.</td></tr>
</tbody></table>
</div>
<h3 id="getauxheapsizefrommeta"><a class="header" href="#getauxheapsizefrommeta">getAuxHeapSizeFromMeta</a></h3>
<p>Given the packed representation of <code>ZkSyncMeta</code>, retrieves the number of the current size
of the auxiliary heap in bytes.</p>
<p><em>You can read more on auxiliary memory in the VM1.2 documentation.</em></p>
<pre><code class="language-solidity">function getAuxHeapSizeFromMeta(uint256 meta)
  internal
  pure
  returns (uint32 auxHeapSize);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>meta</code></td><td><code>uint256</code></td><td>Packed representation of the ZkSyncMeta.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>auxHeapSize</code></td><td><code>uint32</code></td><td>The size of the auxiliary memory in bytes byte.</td></tr>
</tbody></table>
</div>
<h3 id="getshardidfrommeta"><a class="header" href="#getshardidfrommeta">getShardIdFromMeta</a></h3>
<p>Given the packed representation of <code>ZkSyncMeta</code>, retrieves the shardId of <code>this</code>.</p>
<p><em>Currently only shard 0 (zkRollup) is supported.</em></p>
<pre><code class="language-solidity">function getShardIdFromMeta(uint256 meta) internal pure returns (uint8 shardId);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>meta</code></td><td><code>uint256</code></td><td>Packed representation of the ZkSyncMeta.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>shardId</code></td><td><code>uint8</code></td><td>The shardId of <code>this</code>.</td></tr>
</tbody></table>
</div>
<h3 id="getcallershardidfrommeta"><a class="header" href="#getcallershardidfrommeta">getCallerShardIdFromMeta</a></h3>
<p>Given the packed representation of <code>ZkSyncMeta</code>, retrieves the shardId of
the msg.sender.</p>
<p><em>Currently only shard 0 (zkRollup) is supported.</em></p>
<pre><code class="language-solidity">function getCallerShardIdFromMeta(uint256 meta)
  internal
  pure
  returns (uint8 callerShardId);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>meta</code></td><td><code>uint256</code></td><td>Packed representation of the ZkSyncMeta.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>callerShardId</code></td><td><code>uint8</code></td><td>The shardId of the msg.sender.</td></tr>
</tbody></table>
</div>
<h3 id="getcodeshardidfrommeta"><a class="header" href="#getcodeshardidfrommeta">getCodeShardIdFromMeta</a></h3>
<p>Given the packed representation of <code>ZkSyncMeta</code>, retrieves the shardId of
the currently executed code.</p>
<p><em>Currently only shard 0 (zkRollup) is supported.</em></p>
<pre><code class="language-solidity">function getCodeShardIdFromMeta(uint256 meta)
  internal
  pure
  returns (uint8 codeShardId);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>meta</code></td><td><code>uint256</code></td><td>Packed representation of the ZkSyncMeta.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>codeShardId</code></td><td><code>uint8</code></td><td>The shardId of the currently executed code.</td></tr>
</tbody></table>
</div>
<h3 id="getzksyncmeta"><a class="header" href="#getzksyncmeta">getZkSyncMeta</a></h3>
<p>Retrieves the ZkSyncMeta structure.</p>
<p>NOTE: The behavior of this function will experience a breaking change in 2024.</p>
<pre><code class="language-solidity">function getZkSyncMeta() internal view returns (ZkSyncMeta memory meta);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>meta</code></td><td><code>ZkSyncMeta</code></td><td>The ZkSyncMeta execution context parameters.</td></tr>
</tbody></table>
</div>
<h3 id="getcallflags"><a class="header" href="#getcallflags">getCallFlags</a></h3>
<p>Returns the call flags for the current call.</p>
<p><em>Call flags is the value of the first register
at the start of the call.</em></p>
<p><em>The zero bit of the callFlags indicates whether the call is
a constructor call. The first bit of the callFlags indicates whether
the call is a system one.</em></p>
<pre><code class="language-solidity">function getCallFlags() internal view returns (uint256 callFlags);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>callFlags</code></td><td><code>uint256</code></td><td>The bitmask of the callflags.</td></tr>
</tbody></table>
</div>
<h3 id="getcalldataptr"><a class="header" href="#getcalldataptr">getCalldataPtr</a></h3>
<p>Returns the current calldata pointer.</p>
<p><em>NOTE: This file is just an integer and it cannot be used
to forward the calldata to the next calls in any way.</em></p>
<pre><code class="language-solidity">function getCalldataPtr() internal view returns (uint256 ptr);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>ptr</code></td><td><code>uint256</code></td><td>The current calldata pointer.</td></tr>
</tbody></table>
</div>
<h3 id="getextraabidata"><a class="header" href="#getextraabidata">getExtraAbiData</a></h3>
<p>Returns the N-th extraAbiParam for the current call.</p>
<p><em>It is equal to the value of the (N+2)-th register
at the start of the call.</em></p>
<pre><code class="language-solidity">function getExtraAbiData(uint256 index)
  internal
  view
  returns (uint256 extraAbiData);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>extraAbiData</code></td><td><code>uint256</code></td><td>The value of the N-th extraAbiParam for this call.</td></tr>
</tbody></table>
</div>
<h3 id="issystemcall"><a class="header" href="#issystemcall">isSystemCall</a></h3>
<p>Returns whether the current call is a system call.</p>
<pre><code class="language-solidity">function isSystemCall() internal view returns (bool);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>bool</code></td><td><code>true</code> or <code>false</code> based on whether the current call is a system call.</td></tr>
</tbody></table>
</div>
<h3 id="issystemcontract"><a class="header" href="#issystemcontract">isSystemContract</a></h3>
<p>Returns whether the address is a system contract.</p>
<pre><code class="language-solidity">function isSystemContract(address _address) internal pure returns (bool);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_address</code></td><td><code>address</code></td><td>The address to test</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>bool</code></td><td><code>true</code> or <code>false</code> based on whether the <code>_address</code> is a system contract.</td></tr>
</tbody></table>
</div>
<h3 id="issystemcallfromevmemulator"><a class="header" href="#issystemcallfromevmemulator">isSystemCallFromEvmEmulator</a></h3>
<p>Returns whether the current call is a system call from EVM emulator.</p>
<pre><code class="language-solidity">function isSystemCallFromEvmEmulator() internal view returns (bool);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>bool</code></td><td><code>true</code> or <code>false</code> based on whether the current call is a system call from EVM emulator.</td></tr>
</tbody></table>
</div>
<h3 id="burngas"><a class="header" href="#burngas">burnGas</a></h3>
<p>Method used for burning a certain amount of gas.</p>
<pre><code class="language-solidity">function burnGas(uint32 _gasToPay, uint32 _pubdataToSpend) internal view;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_gasToPay</code></td><td><code>uint32</code></td><td>The number of gas to burn.</td></tr>
<tr><td><code>_pubdataToSpend</code></td><td><code>uint32</code></td><td>The number of pubdata bytes to burn during the call.</td></tr>
</tbody></table>
</div>
<h3 id="mimiccall"><a class="header" href="#mimiccall">mimicCall</a></h3>
<p>Performs a <code>mimicCall</code> to an address.</p>
<pre><code class="language-solidity">function mimicCall(address _to, address _whoToMimic, bytes memory _data)
  internal
  returns (bool success, bytes memory returndata);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_to</code></td><td><code>address</code></td><td>The address to call.</td></tr>
<tr><td><code>_whoToMimic</code></td><td><code>address</code></td><td>The address to mimic.</td></tr>
<tr><td><code>_data</code></td><td><code>bytes</code></td><td>The data to pass to the call.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>success</code></td><td><code>bool</code></td><td>Whether the call was successful.</td></tr>
<tr><td><code>returndata</code></td><td><code>bytes</code></td><td>The return data of the call.</td></tr>
</tbody></table>
</div>
<h3 id="forcedeploynoconstructor"><a class="header" href="#forcedeploynoconstructor">forceDeployNoConstructor</a></h3>
<p>Force deploys some bytecode hash to an address
without invoking the constructor.</p>
<pre><code class="language-solidity">function forceDeployNoConstructor(address _addr, bytes32 _bytecodeHash)
  internal;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_addr</code></td><td><code>address</code></td><td>The address to force-deploy the bytecodehash to.</td></tr>
<tr><td><code>_bytecodeHash</code></td><td><code>bytes32</code></td><td>The bytecode hash to force-deploy.</td></tr>
</tbody></table>
</div>
<h3 id="mimiccallwithpropagatedrevert"><a class="header" href="#mimiccallwithpropagatedrevert">mimicCallWithPropagatedRevert</a></h3>
<p>Performs a <code>mimicCall</code> to an address, while ensuring that the call
was successful</p>
<pre><code class="language-solidity">function mimicCallWithPropagatedRevert(
  address _to,
  address _whoToMimic,
  bytes memory _data
) internal;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_to</code></td><td><code>address</code></td><td>The address to call.</td></tr>
<tr><td><code>_whoToMimic</code></td><td><code>address</code></td><td>The address to mimic.</td></tr>
<tr><td><code>_data</code></td><td><code>bytes</code></td><td>The data to pass to the call.</td></tr>
</tbody></table>
</div>
                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../../../../contracts/system-contracts/libraries/RLPEncoder.sol/library.RLPEncoder.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../../../../contracts/system-contracts/libraries/SystemContractHelper.sol/constants.SystemContractHelper.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../../../../contracts/system-contracts/libraries/RLPEncoder.sol/library.RLPEncoder.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../../../../contracts/system-contracts/libraries/SystemContractHelper.sol/constants.SystemContractHelper.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../../../../elasticlunr.min.js"></script>
        <script src="../../../../mark.min.js"></script>
        <script src="../../../../searcher.js"></script>

        <script src="../../../../clipboard.min.js"></script>
        <script src="../../../../highlight.js"></script>
        <script src="../../../../book.js"></script>

        <!-- Custom JS scripts -->
        <script src="../../../../solidity.min.js"></script>


    </div>
    </body>
</html>
